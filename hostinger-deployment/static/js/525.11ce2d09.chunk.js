"use strict";(self.webpackChunkaltus_loan_application_portal=self.webpackChunkaltus_loan_application_portal||[]).push([[525],{5525:(e,r,t)=>{t.d(r,{DocumentsStep:()=>ae});var a=t(9379),i=t(5043),n=t(3969),o=t(5895),s=t(298),l=t(45),c=t(7528),p=t(8387),d=t(1807),u=t(2432),f=t(3290),m=t(8128),y=t(1612),v=t(4412),b=t(8301),g=t(7194),h=t(9857),x=t(6061);function A(e){return(0,x.Ay)("MuiLinearProgress",e)}(0,h.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var w=t(579);const j=["className","color","value","valueBuffer","variant"];var C,k,R,S,z,P;const I=(0,f.i7)(C||(C=(0,c.A)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"]))),B="string"!==typeof I?(0,f.AH)(k||(k=(0,c.A)(["\n        animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n      "])),I):null,F=(0,f.i7)(R||(R=(0,c.A)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"]))),N="string"!==typeof F?(0,f.AH)(S||(S=(0,c.A)(["\n        animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n      "])),F):null,E=(0,f.i7)(z||(z=(0,c.A)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"]))),M="string"!==typeof E?(0,f.AH)(P||(P=(0,c.A)(["\n        animation: "," 3s infinite linear;\n      "])),E):null,L=(e,r)=>e.vars?e.vars.palette.LinearProgress["".concat(r,"Bg")]:"light"===e.palette.mode?e.lighten(e.palette[r].main,.62):e.darken(e.palette[r].main,.5),D=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r["color".concat((0,g.A)(t.color))],r[t.variant]]}})((0,y.A)(e=>{let{theme:r}=e;return{position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(r.palette).filter((0,v.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{backgroundColor:L(r,t)}}}),{props:e=>{let{ownerState:r}=e;return"inherit"===r.color&&"buffer"!==r.variant},style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}})),O=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.dashed,r["dashedColor".concat((0,g.A)(t.color))]]}})((0,y.A)(e=>{let{theme:r}=e;return{position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(r.palette).filter((0,v.A)()).map(e=>{let[t]=e;const a=L(r,t);return{props:{color:t},style:{backgroundImage:"radial-gradient(".concat(a," 0%, ").concat(a," 16%, transparent 42%)")}}})]}}),M||{animation:"".concat(E," 3s infinite linear")}),U=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.bar,r.bar1,r["barColor".concat((0,g.A)(t.color))],("indeterminate"===t.variant||"query"===t.variant)&&r.bar1Indeterminate,"determinate"===t.variant&&r.bar1Determinate,"buffer"===t.variant&&r.bar1Buffer]}})((0,y.A)(e=>{let{theme:r}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(r.palette).filter((0,v.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{backgroundColor:(r.vars||r).palette[t].main}}}),{props:{variant:"determinate"},style:{transition:"transform .".concat(4,"s linear")}},{props:{variant:"buffer"},style:{zIndex:1,transition:"transform .".concat(4,"s linear")}},{props:e=>{let{ownerState:r}=e;return"indeterminate"===r.variant||"query"===r.variant},style:{width:"auto"}},{props:e=>{let{ownerState:r}=e;return"indeterminate"===r.variant||"query"===r.variant},style:B||{animation:"".concat(I," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite")}}]}})),_=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.bar,r.bar2,r["barColor".concat((0,g.A)(t.color))],("indeterminate"===t.variant||"query"===t.variant)&&r.bar2Indeterminate,"buffer"===t.variant&&r.bar2Buffer]}})((0,y.A)(e=>{let{theme:r}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(r.palette).filter((0,v.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{"--LinearProgressBar2-barColor":(r.vars||r).palette[t].main}}}),{props:e=>{let{ownerState:r}=e;return"buffer"!==r.variant&&"inherit"!==r.color},style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:e=>{let{ownerState:r}=e;return"buffer"!==r.variant&&"inherit"===r.color},style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(r.palette).filter((0,v.A)()).map(e=>{let[t]=e;return{props:{color:t,variant:"buffer"},style:{backgroundColor:L(r,t),transition:"transform .".concat(4,"s linear")}}}),{props:e=>{let{ownerState:r}=e;return"indeterminate"===r.variant||"query"===r.variant},style:{width:"auto"}},{props:e=>{let{ownerState:r}=e;return"indeterminate"===r.variant||"query"===r.variant},style:N||{animation:"".concat(F," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite")}}]}})),T=i.forwardRef(function(e,r){const t=(0,b.b)({props:e,name:"MuiLinearProgress"}),{className:i,color:n="primary",value:o,valueBuffer:s,variant:c="indeterminate"}=t,f=(0,l.A)(t,j),m=(0,a.A)((0,a.A)({},t),{},{color:n,variant:c}),y=(e=>{const{classes:r,variant:t,color:a}=e,i={root:["root","color".concat((0,g.A)(a)),t],dashed:["dashed","dashedColor".concat((0,g.A)(a))],bar1:["bar","bar1","barColor".concat((0,g.A)(a)),("indeterminate"===t||"query"===t)&&"bar1Indeterminate","determinate"===t&&"bar1Determinate","buffer"===t&&"bar1Buffer"],bar2:["bar","bar2","buffer"!==t&&"barColor".concat((0,g.A)(a)),"buffer"===t&&"color".concat((0,g.A)(a)),("indeterminate"===t||"query"===t)&&"bar2Indeterminate","buffer"===t&&"bar2Buffer"]};return(0,d.A)(i,A,r)})(m),v=(0,u.I)(),h={},x={bar1:{},bar2:{}};if("determinate"===c||"buffer"===c)if(void 0!==o){h["aria-valuenow"]=Math.round(o),h["aria-valuemin"]=0,h["aria-valuemax"]=100;let e=o-100;v&&(e=-e),x.bar1.transform="translateX(".concat(e,"%)")}else 0;if("buffer"===c)if(void 0!==s){let e=(s||0)-100;v&&(e=-e),x.bar2.transform="translateX(".concat(e,"%)")}else 0;return(0,w.jsxs)(D,(0,a.A)((0,a.A)((0,a.A)({className:(0,p.A)(y.root,i),ownerState:m,role:"progressbar"},h),{},{ref:r},f),{},{children:["buffer"===c?(0,w.jsx)(O,{className:y.dashed,ownerState:m}):null,(0,w.jsx)(U,{className:y.bar1,ownerState:m,style:x.bar1}),"determinate"===c?null:(0,w.jsx)(_,{className:y.bar2,ownerState:m,style:x.bar2})]}))});var W=t(3759),q=t(8065),K=t(2097),H=t(2579),V=t(4527);const Y=(0,t(4057).A)((0,w.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile");var G=t(5362),X=t(3267),J=t(4332),Z=t(3482);const Q=["application/pdf","image/png","image/jpeg"];async function $(e){if(!Q.includes(e.type))return{ok:!1,error:"Unsupported file type"};if(e.size>5242880)return{ok:!1,error:"File exceeds 5MB size limit"};const r=await async function(e){const r=await e.arrayBuffer(),t=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e);return{ok:!0,meta:{mimeType:e.type,sizeBytes:e.size,checksum:r}}}const ee=/[A-Z0-9/]{6,12}/i;var re=t(1389);const te=[{label:"NRC",type:"nrc-front",accept:".jpg,.jpeg,.png,.pdf"},{label:"Payslip (1 of 3)",type:"payslip-1",accept:".jpg,.jpeg,.png,.pdf",helper:"Oldest of the last 3 payslips"},{label:"Payslip (2 of 3)",type:"payslip-2",accept:".jpg,.jpeg,.png,.pdf",helper:"Middle month payslip"},{label:"Payslip (3 of 3)",type:"payslip-3",accept:".jpg,.jpeg,.png,.pdf",helper:"Most recent payslip"},{label:"Application Form/ Pre-Approval Form",type:"reference-letter",accept:".jpg,.jpeg,.png,.pdf",optional:!0,helper:"Pre-approval form from employer or institution"},{label:"Work ID",type:"work-id",accept:".jpg,.jpeg,.png,.pdf",optional:!0},{label:"Selfie / Applicant Photo",type:"selfie",accept:".jpg,.jpeg,.png",optional:!0,helper:"Clear, well-lit photo of the applicant"},{label:"Recent Bank Statement",type:"bank-statement",accept:".pdf",optional:!0}],ae=()=>{const{documents:e,addOrReplaceDocument:r,removeDocument:l,customer:c}=(0,X.l)(),{uploadLoanDocument:p,state:d}=(0,Z.Dy)();const{push:u}=(0,J.d)(),f=(0,i.useRef)({}),m=(0,i.useRef)(e),y=(0,i.useRef)([]);(0,i.useEffect)(()=>{m.current=e},[e]),(0,i.useEffect)(()=>()=>{y.current.forEach(e=>clearInterval(e)),y.current=[]},[]);const v=(0,i.useCallback)(async e=>{if(e.file)try{var t;r((0,a.A)((0,a.A)({},e),{},{status:"uploading",progress:0}));const i=null===(t=d.currentCustomer)||void 0===t?void 0:t.customerId;if(!i)throw new Error("Customer must be created first before uploading documents");const n={"nrc-front":"NRC","nrc-back":"NRC_BACK",payslip:"PAYSLIP","payslip-1":"PAYSLIP_1","payslip-2":"PAYSLIP_2","payslip-3":"PAYSLIP_3","reference-letter":"REFERENCE_LETTER","work-id":"WORK_ID",selfie:"SELFIE","bank-statement":"BANK_STATEMENT","combined-payslips":"COMBINED_PAYSLIPS"}[e.type]||e.type.toUpperCase(),o=new FormData;o.append("customerId",i),o.append("documentType",n),o.append("file",e.file);const s=await p(o);r((0,a.A)((0,a.A)({},e),{},{id:null===s||void 0===s?void 0:s.documentId,status:"uploaded",progress:100})),u("".concat(e.type.replace("-"," ")," uploaded successfully!"),"success")}catch(i){console.error("Error uploading document:",i),r((0,a.A)((0,a.A)({},e),{},{status:"error",errorMessage:i instanceof Error?i.message:"Upload failed"})),u("Failed to upload ".concat(e.type.replace("-"," "),". Please try again."),"error")}},[r,p,d.currentCustomer,u]),b=(0,i.useCallback)(async(i,n)=>{var o,s,l,p;const d=null===(o=i.target.files)||void 0===o?void 0:o[0];if(!d)return;const f=(null===c||void 0===c?void 0:c.nrc)||"Unknown_NRC",b="string"===typeof f?f.replace(/[^\w]/g,""):String(f).replace(/[^\w]/g,""),g=(e=>{const r=te.find(r=>r.type===e);return(null===r||void 0===r?void 0:r.label.replace(/[^\w\s-]/g,"").replace(/\s+/g,"_"))||e})(n),h=(e=>{const r=e.lastIndexOf(".");return-1!==r?e.substring(r):""})(d.name),x="".concat(g,"_").concat(b).concat(h),A=new File([d],x,{type:d.type}),w=await $(A);if(!w.ok)return u(w.error||"File rejected","error"),void r({file:A,type:n,status:"error",errorMessage:w.error});var j;if(e.find(e=>{var r;return e.checksumSha256&&e.checksumSha256===(null===(r=w.meta)||void 0===r?void 0:r.checksum)&&e.type!==n}))return u("This file appears already uploaded under a different document type.","warning"),void r({file:A,type:n,status:"error",errorMessage:"Duplicate of another document",checksumSha256:null===(j=w.meta)||void 0===j?void 0:j.checksum});const C=A.type.startsWith("image/")?URL.createObjectURL(A):void 0;r({file:A,type:n,status:"verifying",previewUrl:C,mimeType:null===(s=w.meta)||void 0===s?void 0:s.mimeType,sizeBytes:null===(l=w.meta)||void 0===l?void 0:l.sizeBytes,checksumSha256:null===(p=w.meta)||void 0===p?void 0:p.checksum,progress:0});const k=Date.now(),R=Math.min(1.8,Math.max(1,w.meta.sizeBytes/1048576)),S=window.setInterval(async()=>{const e=m.current.find(e=>e.type===n);if(!e)return;const o=Date.now()-k,s=Math.min(95,Math.round(o/(1200*R)*100));if(r((0,a.A)((0,a.A)({},e),{},{progress:s})),s>=95){var l,p,d,f,b;clearInterval(S),y.current=y.current.filter(e=>e!==S);let e=null;try{e=await async function(e){if(!e.type.startsWith("image/")&&"application/pdf"!==e.type)return console.warn("File type not supported for OCR:",e.type),null;if(e.size>10485760)return console.warn("File too large for OCR processing:",e.size),null;if(!e.size||0===e.size)return console.warn("File is empty or unreadable"),null;let r=null;try{const{createWorker:a}=await t.e(938).then(t.t.bind(t,9938,23));r=await a("eng");const i=URL.createObjectURL(e),n=new Image;await new Promise((e,r)=>{n.onload=e,n.onerror=()=>r(new Error("Invalid image file")),n.src=i}),URL.revokeObjectURL(i);const{data:o}=await Promise.race([r.recognize(e),new Promise((e,r)=>setTimeout(()=>r(new Error("OCR timeout")),3e4))]),s=o.text||"",l=s.trim().slice(0,160),c=s.match(ee);return{snippet:l,fullText:s,detectedNrc:c?c[0]:null}}catch(i){return console.warn("OCR failed:",i instanceof Error?i.message:"Unknown error"),null}finally{if(r)try{await r.terminate()}catch(a){console.warn("Failed to terminate OCR worker:",a)}}}(A)}catch(g){console.warn("OCR processing failed for file:",A.name,g)}let a="Basic checks passed";null!==(l=e)&&void 0!==l&&l.detectedNrc&&null!==c&&void 0!==c&&c.nrc&&"nrc-front"===n&&(a+=e.detectedNrc.toLowerCase()===String(c.nrc).toLowerCase()?" | NRC match confirmed":" | NRC mismatch");const o={file:A,type:n,status:"verified",previewUrl:C,mimeType:null===(p=w.meta)||void 0===p?void 0:p.mimeType,sizeBytes:null===(d=w.meta)||void 0===d?void 0:d.sizeBytes,checksumSha256:null===(f=w.meta)||void 0===f?void 0:f.checksum,extractedTextSnippet:null===(b=e)||void 0===b?void 0:b.snippet,verificationNotes:a,progress:100};r(o),u("Document verified","success"),setTimeout(()=>v(o),500)}},150);y.current.push(S)},[r,e,u,c,v]),g=(0,i.useCallback)(async()=>{const t=e.find(e=>"payslip-1"===e.type&&"verified"===e.status),a=e.find(e=>"payslip-2"===e.type&&"verified"===e.status),i=e.find(e=>"payslip-3"===e.type&&"verified"===e.status);if(t&&a&&i&&t.file&&a.file&&i.file&&!e.find(e=>"combined-payslips"===e.type))try{u("Merging payslips into single document...","info");const e=(null===c||void 0===c?void 0:c.nrc)||"Unknown_NRC",n=await(async(e,r,t,a)=>{const i=new re.uE;let n=!1;const o=async(e,r)=>new Promise((t,a)=>{const o=new FileReader;o.onload=async o=>{try{var s;const l=null===(s=o.target)||void 0===s?void 0:s.result;if("application/pdf"===e.type)n&&i.addPage(),i.setFontSize(16),i.text("Payslip ".concat(r),20,30),i.setFontSize(10),i.text("Original file: ".concat(e.name),20,50),i.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,60),i.text("Note: PDF content preserved in original file",20,70),n=!0,t();else if(e.type.startsWith("image/")){n&&i.addPage();const o=new Image;o.onload=()=>{try{const a=document.createElement("canvas"),s=a.getContext("2d");if(!s)throw new Error("Canvas context not available");const l=190,c=270,p=o.width/o.height;let d,u;p>l/c?(d=l,u=l/p):(u=c,d=c*p),a.width=o.width,a.height=o.height,s.drawImage(o,0,0);const f=a.toDataURL("image/jpeg",.8);i.addImage(f,"JPEG",10,10,d,u),i.setFontSize(8),i.text("Payslip ".concat(r,": ").concat(e.name),10,u+20),n=!0,t()}catch(s){a(s)}},o.onerror=()=>a(new Error("Failed to load image")),o.src=l}else n&&i.addPage(),i.setFontSize(16),i.text("Payslip ".concat(r),20,30),i.setFontSize(10),i.text("Original file: ".concat(e.name),20,50),i.text("File type: ".concat(e.type),20,60),i.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,70),i.text("Note: Original file content preserved",20,80),n=!0,t()}catch(l){a(l)}},o.onerror=()=>a(new Error("Failed to read file")),e.type.startsWith("image/")?o.readAsDataURL(e):o.readAsArrayBuffer(e)});try{i.setFontSize(20),i.text("Combined Payslips",20,30),i.setFontSize(12),i.text("Client NRC: ".concat(a),20,50),i.text("Generated: ".concat((new Date).toLocaleString()),20,60),i.setFontSize(10),i.text("This document contains three consecutive payslips:",20,80),i.text("1. Oldest payslip",30,90),i.text("2. Middle payslip",30,100),i.text("3. Most recent payslip",30,110),n=!0,await o(e,1),await o(r,2),await o(t,3);const s=i.output("blob"),l=a.replace(/[^\w]/g,"");return new File([s],"Combined_Payslips_".concat(l,".pdf"),{type:"application/pdf"})}catch(s){throw console.error("Error merging payslips:",s),new Error("Failed to merge payslips")}})(t.file,a.file,i.file,String(e)),o={file:n,type:"combined-payslips",status:"verified",mimeType:"application/pdf",sizeBytes:n.size,verificationNotes:"Combined from 3 individual payslips",progress:100};r(o),u("Payslips successfully merged into single document","success"),setTimeout(()=>v(o),500)}catch(n){console.error("Failed to merge payslips:",n),u("Failed to merge payslips - individual files preserved","error")}},[e,c,r,u,v]);(0,i.useEffect)(()=>{3!==["payslip-1","payslip-2","payslip-3"].filter(r=>e.find(e=>e.type===r&&"verified"===e.status)).length||e.find(e=>"combined-payslips"===e.type)||g()},[e,g]);const h=(0,i.useCallback)(r=>e.find(e=>e.type===r),[e]),x=e=>{var r;return null===(r=f.current[e])||void 0===r?void 0:r.click()};window.__documentsStepValidate=async()=>{var e;const r=["nrc-front","payslip-1","payslip-2","payslip-3"].filter(e=>!h(e));if(r.length)return u("Please upload all required documents: "+r.join(", "),"error"),!1;if(!["payslip-1","payslip-2","payslip-3"].every(e=>{var r;return"verified"===(null===(r=h(e))||void 0===r?void 0:r.status)}))return u("Payslips are still verifying \u2013 wait for completion.","warning"),!1;const t=h("nrc-front");return(null===t||void 0===t||null===(e=t.verificationNotes)||void 0===e?void 0:e.includes("mismatch"))&&u("Warning: NRC mismatch detected \u2013 please verify ID number.","warning"),!0};const A=["nrc-front","payslip-1","payslip-2","payslip-3"],j=A.filter(e=>{var r;return"verified"===(null===(r=h(e))||void 0===r?void 0:r.status)}).length,C=(0,i.useMemo)(()=>te.filter(e=>e.type.startsWith("payslip-")).map(e=>({cfg:e,doc:h(e.type)})),[h]),k=C.filter(e=>{var r;return"verified"===(null===(r=e.doc)||void 0===r?void 0:r.status)}).length,R=h("selfie"),S=(0,i.useMemo)(()=>Math.round(j/A.length*100),[j,A.length]);return(0,w.jsxs)(n.A,{children:[(0,w.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Supporting Documents"}),(0,w.jsx)(n.A,{sx:{mb:2,p:2,border:"1px solid",borderColor:"divider",borderRadius:2,background:100===S?"linear-gradient(90deg,#093B18,#2E7D32)":"linear-gradient(90deg,#132F52,#063970)",color:"#fff"},children:(0,w.jsxs)(s.A,{direction:{xs:"column",sm:"row"},spacing:1.5,alignItems:{xs:"flex-start",sm:"center"},children:[(0,w.jsxs)(o.A,{variant:"subtitle2",sx:{fontWeight:600},children:["Required Docs: ",j,"/",A.length," verified"]}),(0,w.jsx)(n.A,{sx:{flex:1,width:"100%",maxWidth:260},children:(0,w.jsx)(T,{variant:"determinate",value:S,sx:{height:8,borderRadius:4,background:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{background:"#fff"}}})}),(0,w.jsxs)(o.A,{variant:"caption",sx:{opacity:.9},children:[S,"%"]})]})}),(0,w.jsx)(o.A,{variant:"body2",sx:{mb:2},children:"Upload the required documents. You can replace a file by selecting it again."}),(0,w.jsxs)(s.A,{spacing:3,children:[te.filter(e=>!e.type.startsWith("payslip-")).map(e=>{var r,t,a;const i=h(e.type),c="selfie"===e.type,p="nrc-front"===e.type&&(null===i||void 0===i||null===(r=i.verificationNotes)||void 0===r?void 0:r.includes("mismatch"));return(0,w.jsxs)(n.A,{sx:{p:2,border:"1px dashed",borderColor:p?"error.light":"divider",borderRadius:2,position:"relative"},children:[p&&(0,w.jsx)(W.A,{size:"small",color:"error",label:"NRC Mismatch",sx:{position:"absolute",top:8,right:8}}),(0,w.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,w.jsxs)(n.A,{sx:{flex:1},children:[(0,w.jsx)(o.A,{variant:"subtitle2",children:e.label}),e.helper&&(0,w.jsx)(o.A,{variant:"caption",sx:{display:"block",color:"text.secondary",mt:.25},children:e.helper}),e.optional&&!i&&(0,w.jsx)(o.A,{variant:"caption",sx:{color:"text.secondary"},children:"Optional"}),i?(0,w.jsxs)(s.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:1,flexWrap:"wrap"},children:[(0,w.jsx)(W.A,{size:"small",color:"verified"===i.status?"success":"error"===i.status?"error":"verifying"===i.status?"warning":"default",label:(null===(t=i.file)||void 0===t?void 0:t.name)||(null===(a=i.checksumSha256)||void 0===a?void 0:a.slice(0,8))||"Document"}),i.previewUrl&&i.file&&(0,w.jsx)("img",{src:i.previewUrl,alt:e.label+" preview",style:{width:c?60:48,height:c?60:48,objectFit:"cover",borderRadius:c?"50%":6,border:c?"2px solid #1976d2":"1px solid rgba(0,0,0,0.15)"}}),(0,w.jsx)(ie,{status:i.status}),i.sizeBytes&&(0,w.jsx)(q.A,{title:"~".concat(Math.round(i.sizeBytes/1024)," KB"),children:(0,w.jsx)(W.A,{size:"small",variant:"outlined",label:Math.round(i.sizeBytes/1024)+" KB"})}),"number"===typeof i.progress&&"verified"!==i.status&&(0,w.jsx)(n.A,{sx:{width:140,ml:1},children:(0,w.jsx)(T,{variant:"determinate",value:i.progress,sx:{height:6,borderRadius:3}})}),i.verificationNotes&&"verified"===i.status&&"nrc-front"===e.type&&(0,w.jsx)(q.A,{title:i.verificationNotes,children:(0,w.jsx)(W.A,{size:"small",variant:"outlined",label:i.verificationNotes.includes("mismatch")?"Mismatch":"Match",color:i.verificationNotes.includes("mismatch")?"error":"success"})})]}):(0,w.jsx)(o.A,{variant:"caption",sx:{color:"text.secondary"},children:"No file selected"})]}),(0,w.jsx)("input",{type:"file",ref:r=>f.current[e.type]=r,accept:e.accept,style:{display:"none"},onChange:r=>b(r,e.type)}),(0,w.jsx)(K.A,{variant:"outlined",startIcon:(0,w.jsx)(Y,{}),onClick:()=>x(e.type),children:i?"Replace":"Select"}),i&&(0,w.jsx)(H.A,{color:"error",onClick:()=>l(e.type),"aria-label":"Remove ".concat(e.label),children:(0,w.jsx)(G.A,{})})]})]},e.type)}),(0,w.jsxs)(n.A,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[(0,w.jsxs)(s.A,{direction:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},spacing:2,sx:{mb:1},children:[(0,w.jsx)(o.A,{variant:"subtitle2",sx:{fontWeight:600},children:"Payslips (3)"}),(0,w.jsx)(n.A,{sx:{flex:1,width:"100%",maxWidth:240},children:(0,w.jsx)(T,{variant:"determinate",value:k/3*100,sx:{height:6,borderRadius:3}})}),(0,w.jsxs)(o.A,{variant:"caption",sx:{color:"text.secondary"},children:[k,"/3 verified"]})]}),(0,w.jsx)(V.A,{sx:{mb:1}}),(0,w.jsx)(s.A,{spacing:2,children:C.map(e=>{var r,t;let{cfg:a,doc:i}=e;return(0,w.jsx)(n.A,{sx:{p:1.5,border:"1px dashed",borderColor:"divider",borderRadius:2},children:(0,w.jsxs)(s.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,w.jsxs)(n.A,{sx:{flex:1},children:[(0,w.jsx)(o.A,{variant:"body2",sx:{fontWeight:500},children:a.label}),a.helper&&(0,w.jsx)(o.A,{variant:"caption",sx:{color:"text.secondary"},children:a.helper}),i?(0,w.jsxs)(s.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:.75,flexWrap:"wrap"},children:[(0,w.jsx)(W.A,{size:"small",color:"verified"===i.status?"success":"error"===i.status?"error":"verifying"===i.status?"warning":"default",label:(null===(r=i.file)||void 0===r?void 0:r.name)||(null===(t=i.checksumSha256)||void 0===t?void 0:t.slice(0,8))||"Payslip"}),i.previewUrl&&i.file&&(0,w.jsx)("img",{src:i.previewUrl,alt:a.label+" preview",style:{width:42,height:42,objectFit:"cover",borderRadius:4}}),(0,w.jsx)(ie,{status:i.status}),"number"===typeof i.progress&&"verified"!==i.status&&(0,w.jsx)(n.A,{sx:{width:120},children:(0,w.jsx)(T,{variant:"determinate",value:i.progress,sx:{height:5,borderRadius:3}})})]}):(0,w.jsx)(o.A,{variant:"caption",sx:{color:"text.secondary"},children:"No file selected"})]}),(0,w.jsx)("input",{type:"file",ref:e=>f.current[a.type]=e,accept:a.accept,style:{display:"none"},onChange:e=>b(e,a.type)}),(0,w.jsx)(K.A,{size:"small",variant:"outlined",startIcon:(0,w.jsx)(Y,{}),onClick:()=>x(a.type),children:i?"Replace":"Select"}),i&&(0,w.jsx)(H.A,{size:"small",color:"error",onClick:()=>l(a.type),"aria-label":"Remove ".concat(a.label),children:(0,w.jsx)(G.A,{fontSize:"small"})})]})},a.type)})})]}),e.find(e=>"combined-payslips"===e.type)&&(0,w.jsxs)(n.A,{sx:{p:2,border:"2px solid",borderColor:"success.light",borderRadius:2,background:"linear-gradient(90deg,#1b5e20,#2e7d32)",color:"#fff"},children:[(0,w.jsx)(o.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"\ud83d\udcc4 Combined Payslips Document"}),(r=>{const t=e.find(e=>"combined-payslips"===e.type);return t?(0,w.jsxs)(s.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,w.jsxs)(n.A,{sx:{flex:1},children:[(0,w.jsxs)(s.A,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,w.jsx)(W.A,{size:"small",color:"success",label:(null===(r=t.file)||void 0===r?void 0:r.name)||"Combined_Payslips.pdf",sx:{background:"rgba(255,255,255,0.9)",color:"#1b5e20"}}),(0,w.jsx)(W.A,{size:"small",variant:"outlined",label:"MERGED",sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}}),t.sizeBytes&&(0,w.jsx)(W.A,{size:"small",variant:"outlined",label:"".concat(Math.round(t.sizeBytes/1024)," KB"),sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}})]}),(0,w.jsx)(o.A,{variant:"caption",sx:{display:"block",mt:.5,opacity:.9},children:"All three payslips have been automatically combined into a single PDF document"})]}),(0,w.jsx)(H.A,{size:"small",sx:{color:"#fff"},onClick:()=>l("combined-payslips"),"aria-label":"Remove combined payslips",children:(0,w.jsx)(G.A,{fontSize:"small"})})]}):null})()]})]}),(0,w.jsxs)(o.A,{variant:"caption",sx:{mt:3,display:"block",color:"text.secondary"},children:["Files are stored locally until you submit. Verification here is preliminary.",R?"":" (Adding a selfie can speed up identity confirmation.)"]})]})},ie=e=>{let{status:r}=e;if(!r)return null;const t={pending:{color:"default",label:"PENDING"},uploading:{color:"warning",label:"UPLOADING"},uploaded:{color:"default",label:"UPLOADED"},verifying:{color:"warning",label:"VERIFYING"},verified:{color:"success",label:"VERIFIED"},error:{color:"error",label:"ERROR"}}[r];return(0,w.jsx)(W.A,{size:"small",variant:"outlined",color:t.color,label:t.label})}}}]);
//# sourceMappingURL=525.11ce2d09.chunk.js.map