{"version":3,"file":"static/js/700.d747d805.chunk.js","mappings":"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","sources":["api/mockApi.ts","components/wizard/steps/ConfirmationStep.tsx"],"sourcesContent":["interface MockSubmission {\r\n  id: string;\r\n  created: string;\r\n  statusTimeline: { stage: string; ts: string; description?: string }[];\r\n  currentStatus: string;\r\n  location?: string;\r\n  source?: string;\r\n  customerName?: string;\r\n  nrcNumber?: string;\r\n  loanAmount?: number;\r\n  loanProduct?: string;\r\n}\r\n\r\nexport interface MockSubmitResult { referenceId: string; status: string; location?: string; message?: string; }\r\nexport interface MockStatusResult extends MockSubmission {}\r\n\r\nconst store: Record<string, MockSubmission> = {};\r\n\r\n// Add some sample test data for testing\r\nfunction initializeSampleData() {\r\n  if (Object.keys(store).length === 0) {\r\n    const sampleRef = 'ALT24127890AB';\r\n    store[sampleRef] = {\r\n      id: sampleRef,\r\n      created: new Date(Date.now() - 25 * 60 * 60 * 1000).toISOString(), // 25 hours ago\r\n      statusTimeline: [\r\n        { \r\n          stage: 'submitted', \r\n          ts: new Date(Date.now() - 25 * 60 * 60 * 1000).toISOString(),\r\n          description: 'Application submitted successfully'\r\n        },\r\n        { \r\n          stage: 'review', \r\n          ts: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),\r\n          description: 'Documents under review'\r\n        },\r\n        { \r\n          stage: 'pending', \r\n          ts: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),\r\n          description: 'Additional verification required'\r\n        },\r\n      ],\r\n      currentStatus: 'pending',\r\n      location: 'Lusaka, Zambia',\r\n      source: 'web',\r\n      customerName: 'John Mwanza',\r\n      nrcNumber: '123456/78/90',\r\n      loanAmount: 15000,\r\n      loanProduct: 'government-personal',\r\n    };\r\n  }\r\n}\r\n\r\n// Helper to generate reference number using part of NRC\r\nfunction generateReferenceNumber(nrcNumber?: string): string {\r\n  if (!nrcNumber) {\r\n    // Fallback if no NRC provided\r\n    const randomPart = Math.random().toString(36).substring(2, 8).toUpperCase();\r\n    return `ALT${new Date().getFullYear().toString().slice(-2)}${randomPart}`;\r\n  }\r\n  \r\n  // Clean NRC and extract meaningful parts\r\n  const cleanNRC = nrcNumber.replace(/[^0-9]/g, '');\r\n  const nrcPart = cleanNRC.slice(-4); // Use last 4 digits of NRC\r\n  const randomPart = Math.random().toString(36).substring(2, 4).toUpperCase();\r\n  const datePart = new Date().getFullYear().toString().slice(-2);\r\n  const monthPart = (new Date().getMonth() + 1).toString().padStart(2, '0');\r\n  \r\n  return `ALT${datePart}${monthPart}${nrcPart}${randomPart}`;\r\n}\r\n\r\n// Helper to derive a location string\r\nfunction deriveLocation(payload: any): string {\r\n  const raw =\r\n    payload?.customer?.address ||\r\n    payload?.customer?.city ||\r\n    payload?.customer?.nationality ||\r\n    payload?.customer?.country ||\r\n    '';\r\n  if (typeof raw !== 'string') return 'Lusaka, Zambia';\r\n  const trimmed = raw.trim();\r\n  const parts = trimmed.split(',').map(s => s.trim()).filter(Boolean);\r\n  const guess = parts.length ? parts[parts.length - 1] : trimmed;\r\n  return guess || 'Lusaka, Zambia';\r\n}\r\n\r\nexport const isMockMode = () => process.env.REACT_APP_MOCK_MODE === 'true';\r\n\r\nexport function mockSubmitApplication(payload: any): Promise<MockSubmitResult> { // eslint-disable-line @typescript-eslint/no-explicit-any\r\n  const nrcNumber = payload?.customer?.nrc || '';\r\n  const referenceId = generateReferenceNumber(nrcNumber);\r\n  const now = new Date().toISOString();\r\n  const location = deriveLocation(payload);\r\n  \r\n  store[referenceId] = {\r\n    id: referenceId,\r\n    created: now,\r\n    statusTimeline: [\r\n      { \r\n        stage: 'submitted', \r\n        ts: now,\r\n        description: 'Application submitted successfully'\r\n      },\r\n      { \r\n        stage: 'review', \r\n        ts: now,\r\n        description: 'Documents under review'\r\n      },\r\n    ],\r\n    currentStatus: 'review',\r\n    location,\r\n    source: 'web',\r\n    customerName: `${payload?.customer?.firstName || ''} ${payload?.customer?.lastName || ''}`.trim(),\r\n    nrcNumber: nrcNumber,\r\n    loanAmount: payload?.loan?.amount || 0,\r\n    loanProduct: payload?.loan?.productCode || 'Unknown',\r\n  };\r\n  \r\n  return Promise.resolve({ \r\n    referenceId, \r\n    status: 'review', \r\n    location,\r\n    message: 'Application submitted successfully. You will be contacted within 24-48 hours.'\r\n  });\r\n}\r\n\r\nexport function mockGetStatus(ref: string): Promise<MockStatusResult> {\r\n  // Initialize sample data on first call\r\n  initializeSampleData();\r\n  \r\n  const found = store[ref];\r\n  if (!found) {\r\n    return Promise.reject(new Error('Application not found. Please check your reference number.'));\r\n  }\r\n  \r\n  // Simulate progression over time\r\n  const elapsed = Date.now() - Date.parse(found.created);\r\n  const hours = elapsed / (1000 * 60 * 60);\r\n  \r\n  // Progress application status based on time elapsed\r\n  if (hours > 24 && found.currentStatus === 'review') {\r\n    found.currentStatus = 'pending';\r\n    found.statusTimeline.push({ \r\n      stage: 'pending', \r\n      ts: new Date().toISOString(),\r\n      description: 'Additional verification required'\r\n    });\r\n  } else if (hours > 48 && found.currentStatus === 'pending') {\r\n    // Randomly approve or reject\r\n    const approved = Math.random() > 0.2; // 80% approval rate\r\n    if (approved) {\r\n      found.currentStatus = 'approved';\r\n      found.statusTimeline.push({ \r\n        stage: 'approved', \r\n        ts: new Date().toISOString(),\r\n        description: 'Loan approved. Disbursement in progress.'\r\n      });\r\n    } else {\r\n      found.currentStatus = 'rejected';\r\n      found.statusTimeline.push({ \r\n        stage: 'rejected', \r\n        ts: new Date().toISOString(),\r\n        description: 'Application declined. Please contact support for details.'\r\n      });\r\n    }\r\n  } else if (hours > 72 && found.currentStatus === 'approved') {\r\n    found.currentStatus = 'disbursed';\r\n    found.statusTimeline.push({ \r\n      stage: 'disbursed', \r\n      ts: new Date().toISOString(),\r\n      description: 'Loan amount disbursed to your account'\r\n    });\r\n  }\r\n  \r\n  return Promise.resolve(found);\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Box, Typography, Button, CircularProgress, Stack } from '@mui/material';\r\nimport { useWizardData } from '../WizardDataContext';\r\nimport { isMockMode, mockSubmitApplication } from '../../../api/mockApi';\r\n\r\n// Placeholder submission simulation; will be replaced with real API call.\r\nconst fakeSubmit = (): Promise<{ referenceId: string; status: string; }> =>\r\n  new Promise(resolve => setTimeout(\r\n    () => resolve({ referenceId: 'REF' + Math.floor(Math.random() * 1e6), status: 'PENDING_REVIEW' }),\r\n    1200\r\n  ));\r\n\r\nexport const ConfirmationStep: React.FC = () => {\r\n  const { customer, loan, documents, resetAll } = useWizardData();\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [result, setResult] = useState<{ referenceId: string; status: string;} | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const handleSubmit = async () => {\r\n    setSubmitting(true); setError(null);\r\n    try {\r\n      const applicationData = {\r\n        customer,\r\n        loan,\r\n        documents: documents.map(d => ({ type: d.type, status: d.status })),\r\n        submittedAt: new Date().toISOString()\r\n      };\r\n      const res = isMockMode() ? await mockSubmitApplication(applicationData) : await fakeSubmit();\r\n      setResult({ referenceId: res.referenceId, status: res.status });\r\n    } catch (e: any) {\r\n      setError(e.message || 'Submission failed');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  (window as any).__confirmationStepValidate = async () => true;\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h6\" gutterBottom>Confirmation</Typography>\r\n      {result ? (\r\n        <Box sx={{ p:2, bgcolor: 'background.paper', borderRadius:2, boxShadow:1 }}>\r\n          <Typography variant=\"subtitle1\" gutterBottom>Application Submitted</Typography>\r\n          <Typography variant=\"body2\">Reference ID: <strong>{result.referenceId}</strong></Typography>\r\n          <Typography variant=\"body2\" sx={{ mb:2 }}>Initial Status: <strong>{result.status}</strong></Typography>\r\n          <Typography variant=\"caption\" sx={{ display:'block', mb:2 }}>Use the tracking page with this reference ID to check updates.</Typography>\r\n          <Stack direction=\"row\" spacing={2}>\r\n            <Button variant=\"outlined\" onClick={() => resetAll()}>Start New Application</Button>\r\n          </Stack>\r\n        </Box>\r\n      ) : (\r\n        <Box>\r\n          <Typography variant=\"body2\" sx={{ mb:2 }}>Click submit to send your application. A reference will be generated.</Typography>\r\n          <Stack direction=\"row\" spacing={2}>\r\n            <Button variant=\"contained\" disabled={submitting} onClick={handleSubmit}>\r\n              {submitting ? <><CircularProgress size={18} sx={{ mr:1 }} /> Submitting...</> : 'Submit Application'}\r\n            </Button>\r\n          </Stack>\r\n          {error && <Typography color=\"error\" sx={{ mt:2 }}>{error}</Typography>}\r\n          <Typography variant=\"caption\" sx={{ display:'block', mt:3, color:'text.secondary' }}>\r\n            {isMockMode() ? 'Using mock submission mode (no network call).' : 'TODO: Replace with real API integration and optimistic status polling.'}\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n    </Box>\r\n  );\r\n};\r\n"],"names":["store","mockSubmitApplication","payload","_payload$customer5","_payload$customer6","_payload$customer7","_payload$loan","_payload$loan2","nrcNumber","customer","nrc","referenceId","randomPart","Math","random","toString","substring","toUpperCase","concat","Date","getFullYear","slice","nrcPart","replace","datePart","monthPart","getMonth","padStart","generateReferenceNumber","now","toISOString","location","_payload$customer","_payload$customer2","_payload$customer3","_payload$customer4","raw","address","city","nationality","country","trimmed","trim","parts","split","map","s","filter","Boolean","length","deriveLocation","id","created","statusTimeline","stage","ts","description","currentStatus","source","customerName","firstName","lastName","loanAmount","loan","amount","loanProduct","productCode","Promise","resolve","status","message","ConfirmationStep","documents","resetAll","useWizardData","submitting","setSubmitting","useState","result","setResult","error","setError","window","__confirmationStepValidate","async","_jsxs","Box","children","_jsx","Typography","variant","gutterBottom","sx","p","bgcolor","borderRadius","boxShadow","mb","display","Stack","direction","spacing","Button","onClick","disabled","applicationData","d","type","submittedAt","res","e","_Fragment","CircularProgress","size","mr","color","mt"],"sourceRoot":""}