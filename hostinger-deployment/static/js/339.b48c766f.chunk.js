"use strict";(self.webpackChunkaltus_loan_application_portal=self.webpackChunkaltus_loan_application_portal||[]).push([[339],{3339:(e,a,t)=>{t.d(a,{DocumentsStep:()=>le});var n=t(9379),r=t(5043),o=t(3969),i=t(5895),s=t(3830),l=t(2097),c=t(298),d=t(45),u=t(7528),p=t(8387),m=t(1807),f=t(2432),g=t(3290),h=t(8128),b=t(1612),y=t(4412),v=t(8301),x=t(7194),w=t(9857),C=t(6061);function k(e){return(0,C.Ay)("MuiLinearProgress",e)}(0,w.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var A=t(579);const N=["className","color","value","valueBuffer","variant"];var B,j,M,L,S,R;const z=(0,g.i7)(B||(B=(0,u.A)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"]))),P="string"!==typeof z?(0,g.AH)(j||(j=(0,u.A)(["\n        animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n      "])),z):null,K=(0,g.i7)(M||(M=(0,u.A)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"]))),I="string"!==typeof K?(0,g.AH)(L||(L=(0,u.A)(["\n        animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n      "])),K):null,D=(0,g.i7)(S||(S=(0,u.A)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"]))),F="string"!==typeof D?(0,g.AH)(R||(R=(0,u.A)(["\n        animation: "," 3s infinite linear;\n      "])),D):null,O=(e,a)=>e.vars?e.vars.palette.LinearProgress["".concat(a,"Bg")]:"light"===e.palette.mode?e.lighten(e.palette[a].main,.62):e.darken(e.palette[a].main,.5),E=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,a["color".concat((0,x.A)(t.color))],a[t.variant]]}})((0,b.A)(e=>{let{theme:a}=e;return{position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(a.palette).filter((0,y.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{backgroundColor:O(a,t)}}}),{props:e=>{let{ownerState:a}=e;return"inherit"===a.color&&"buffer"!==a.variant},style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}})),U=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.dashed,a["dashedColor".concat((0,x.A)(t.color))]]}})((0,b.A)(e=>{let{theme:a}=e;return{position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(a.palette).filter((0,y.A)()).map(e=>{let[t]=e;const n=O(a,t);return{props:{color:t},style:{backgroundImage:"radial-gradient(".concat(n," 0%, ").concat(n," 16%, transparent 42%)")}}})]}}),F||{animation:"".concat(D," 3s infinite linear")}),T=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.bar,a.bar1,a["barColor".concat((0,x.A)(t.color))],("indeterminate"===t.variant||"query"===t.variant)&&a.bar1Indeterminate,"determinate"===t.variant&&a.bar1Determinate,"buffer"===t.variant&&a.bar1Buffer]}})((0,b.A)(e=>{let{theme:a}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(a.palette).filter((0,y.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{backgroundColor:(a.vars||a).palette[t].main}}}),{props:{variant:"determinate"},style:{transition:"transform .".concat(4,"s linear")}},{props:{variant:"buffer"},style:{zIndex:1,transition:"transform .".concat(4,"s linear")}},{props:e=>{let{ownerState:a}=e;return"indeterminate"===a.variant||"query"===a.variant},style:{width:"auto"}},{props:e=>{let{ownerState:a}=e;return"indeterminate"===a.variant||"query"===a.variant},style:P||{animation:"".concat(z," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite")}}]}})),W=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.bar,a.bar2,a["barColor".concat((0,x.A)(t.color))],("indeterminate"===t.variant||"query"===t.variant)&&a.bar2Indeterminate,"buffer"===t.variant&&a.bar2Buffer]}})((0,b.A)(e=>{let{theme:a}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(a.palette).filter((0,y.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{"--LinearProgressBar2-barColor":(a.vars||a).palette[t].main}}}),{props:e=>{let{ownerState:a}=e;return"buffer"!==a.variant&&"inherit"!==a.color},style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:e=>{let{ownerState:a}=e;return"buffer"!==a.variant&&"inherit"===a.color},style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(a.palette).filter((0,y.A)()).map(e=>{let[t]=e;return{props:{color:t,variant:"buffer"},style:{backgroundColor:O(a,t),transition:"transform .".concat(4,"s linear")}}}),{props:e=>{let{ownerState:a}=e;return"indeterminate"===a.variant||"query"===a.variant},style:{width:"auto"}},{props:e=>{let{ownerState:a}=e;return"indeterminate"===a.variant||"query"===a.variant},style:I||{animation:"".concat(K," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite")}}]}})),H=r.forwardRef(function(e,a){const t=(0,v.b)({props:e,name:"MuiLinearProgress"}),{className:r,color:o="primary",value:i,valueBuffer:s,variant:l="indeterminate"}=t,c=(0,d.A)(t,N),u=(0,n.A)((0,n.A)({},t),{},{color:o,variant:l}),g=(e=>{const{classes:a,variant:t,color:n}=e,r={root:["root","color".concat((0,x.A)(n)),t],dashed:["dashed","dashedColor".concat((0,x.A)(n))],bar1:["bar","bar1","barColor".concat((0,x.A)(n)),("indeterminate"===t||"query"===t)&&"bar1Indeterminate","determinate"===t&&"bar1Determinate","buffer"===t&&"bar1Buffer"],bar2:["bar","bar2","buffer"!==t&&"barColor".concat((0,x.A)(n)),"buffer"===t&&"color".concat((0,x.A)(n)),("indeterminate"===t||"query"===t)&&"bar2Indeterminate","buffer"===t&&"bar2Buffer"]};return(0,m.A)(r,k,a)})(u),h=(0,f.I)(),b={},y={bar1:{},bar2:{}};if("determinate"===l||"buffer"===l)if(void 0!==i){b["aria-valuenow"]=Math.round(i),b["aria-valuemin"]=0,b["aria-valuemax"]=100;let e=i-100;h&&(e=-e),y.bar1.transform="translateX(".concat(e,"%)")}else 0;if("buffer"===l)if(void 0!==s){let e=(s||0)-100;h&&(e=-e),y.bar2.transform="translateX(".concat(e,"%)")}else 0;return(0,A.jsxs)(E,(0,n.A)((0,n.A)((0,n.A)({className:(0,p.A)(g.root,r),ownerState:u,role:"progressbar"},b),{},{ref:a},c),{},{children:["buffer"===l?(0,A.jsx)(U,{className:g.dashed,ownerState:u}):null,(0,A.jsx)(T,{className:g.bar1,ownerState:u,style:y.bar1}),"determinate"===l?null:(0,A.jsx)(W,{className:g.bar2,ownerState:u,style:y.bar2})]}))});var q=t(3759),_=t(6529),V=t(2579),G=t(4527);const Z=(0,t(4057).A)((0,A.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile");var Y=t(5362),J=t(3267),X=t(4332),$=t(5514),Q=t(8696),ee=t(193),ae=t(5264);const te=()=>{var e;const{customer:a,loan:t,setLoan:o}=(0,J.l)(),{state:i}=(0,$.Dy)();return{submitLoanApplication:(0,r.useCallback)(async()=>{var e,r,s,l,c,d,u,p,m,f,g,h,b;console.log("\ud83d\ude80 Starting UAT Loan Application Workflow...");const y=a.customerId||(null===(e=i.currentCustomer)||void 0===e?void 0:e.customerId);if(y?console.log("\u2705 Customer ID available:",y):console.log("\u26a0\ufe0f No CustomerID found - proceeding with form data only (TypeOfCustomer: New)"),!a.firstName||!a.lastName)throw new Error("Please complete Step 1: Customer Information (fill in your name and basic details) before uploading documents.");if(!a.nrc||!a.phone||!a.email)throw new Error("Please complete Step 1: Customer Information (fill in NRC, phone, and email) before uploading documents.");if(!t.amount||t.amount<=0)throw new Error("Please complete Step 2: Loan Calculator and specify a loan amount before uploading documents.");const v={TypeOfCustomer:"New",customerId:y||"",firstName:a.firstName||"",middleName:"",lastName:a.lastName||"",dateOfBirth:a.dateOfBirth||"",identityNo:a.nrc||"",contactNo:a.phone||"",emailId:a.email||"",primaryAddress:a.address||"",provinceName:(a.province||"").replace(" Province",""),districtName:a.city||"",countryName:"Zambia",postalcode:a.postalCode||"",employeeNumber:a.payrollNumber||a.employerId||"",designation:a.occupation||"",employerName:a.employerName||"",employmentType:a.employmentType||"Permanent",tenure:t.tenureMonths||12,loanAmount:t.amount,grossIncome:a.salary||0,netIncome:a.salary?.85*a.salary:0,deductions:a.salary?.15*a.salary:0,gender:a.gender||"Male",financialInstitutionName:a.bankName||"",financialInstitutionBranchName:(e=>{const t=(null===(e=a.bankBranch)||void 0===e?void 0:e.trim())||"";if(console.log("\ud83d\udd0d Bank Branch Validation:",{providedBranch:t,isValid:(0,ee.eB)(t)}),(0,ee.eB)(t))return console.log("\u2705 Using provided branch:",t),t;const n=(0,ee._0)(t);if(n)return console.log('\ud83d\udccd Mapped "'.concat(t,'" to valid branch: "').concat(n,'"')),n;const r=(0,ee.$E)(a.province||"");return console.log('\ud83d\udccd Using default branch for province "'.concat(a.province,'": "').concat(r,'"')),r})(),accountNumber:a.accountNumber||"",accountType:a.accountType||"",referrerName:(null===(r=a.reference)||void 0===r?void 0:r.name)||"",referrerNRC:(null===(s=a.reference)||void 0===s?void 0:s.nrc)||"",referrerContactNo:(null===(l=a.reference)||void 0===l?void 0:l.phone)||"",referrerPhysicalAddress:(null===(c=a.reference)||void 0===c?void 0:c.address)||"",referrerRelationType:(null===(d=a.reference)||void 0===d?void 0:d.relationship)||"",kinName:a.nextOfKin?"".concat(a.nextOfKin.firstName||""," ").concat(a.nextOfKin.lastName||"").trim():"",kinNRC:(null===(u=a.nextOfKin)||void 0===u?void 0:u.nrc)||"",kinRelationship:(null===(p=a.nextOfKin)||void 0===p?void 0:p.relationship)||"",kinMobileNo:(null===(m=a.nextOfKin)||void 0===m?void 0:m.phone)||"",kinAddress:(null===(f=a.nextOfKin)||void 0===f?void 0:f.address)||"",kinProvinceName:((null===(g=a.nextOfKin)||void 0===g?void 0:g.province)||"").replace(" Province",""),kinDistrictName:(null===(h=a.nextOfKin)||void 0===h?void 0:h.city)||"",kinCountryName:"Zambia"};if(console.log("\ud83d\udccb Submitting loan request...",{customerId:y||"(none - using form data)",identityNo:v.identityNo,loanAmount:v.loanAmount,tenure:v.tenure,bankName:v.financialInstitutionName,bankBranch:v.financialInstitutionBranchName,hasPersonalDetails:!0,hasAddressDetails:!(!v.primaryAddress||!v.provinceName),hasBankDetails:!(!v.financialInstitutionName||!v.accountNumber),hasNextOfKin:!!v.kinName,hasReference:!!v.referrerName}),console.log("\ud83d\udd12 Final branch being sent to ALTUS \u2192",v.financialInstitutionBranchName),!(0,ae.xw)(v.financialInstitutionBranchName)){const e='\u274c Invalid branch selected: "'.concat(v.financialInstitutionBranchName,'". Must be one of the 37 exact ALTUS branch names.');throw console.error(e),console.error("\ud83d\udccb Valid branches:",ae.yR),new Error('Invalid branch name: "'.concat(v.financialInstitutionBranchName,'". ')+"ALTUS only accepts these exact branch names: ".concat(ae.yR.slice(0,5).join(", "),"... (37 total). ")+"Please select a valid branch from the dropdown.")}console.log("\u2705 Branch validation passed:",v.financialInstitutionBranchName);const x=await Q.Ay.submitLoanRequest(v);if(console.log("\ud83d\udccb Full Loan Request Response:",x),"Success"!==x.executionStatus||null===(b=x.outParams)||void 0===b||!b.ApplicationNumber)throw console.error("\u274c Loan request failed:",x),new Error("Loan request failed: ".concat(x.executionMessage||"No ApplicationNumber returned"));const w=x.outParams.ApplicationNumber;return console.log("\u2705 Loan request submitted. ApplicationNumber:",w),console.log("\u23f3 Note: Backend requires manual approval before ApplicationNumber becomes active for document uploads"),console.log("\ud83d\udcdd Documents will be stored locally and uploaded automatically after approval"),o((0,n.A)((0,n.A)({},t),{},{applicationNumber:w,applicationId:w})),w},[a,t,i]),uploadDocument:(0,r.useCallback)(async(e,a,t)=>{var n;console.log("\ud83d\udce4 Uploading document...",{applicationNumber:e,documentType:a,fileName:t.name});const r=await Q.Ay.uploadLoanDocument(e,a,t);if("Success"!==r.executionStatus||null===(n=r.outParams)||void 0===n||!n.LRDocumentDetailsId)throw new Error("Document upload failed: ".concat(r.executionMessage));return console.log("\u2705 Document uploaded. Document ID:",r.outParams.LRDocumentDetailsId),r.outParams.LRDocumentDetailsId},[]),isCustomerReady:!!(a.customerId||null!==(e=i.currentCustomer)&&void 0!==e&&e.customerId)}},ne=["application/pdf","image/png","image/jpeg"];async function re(e){if(!ne.includes(e.type))return{ok:!1,error:"Unsupported file type"};if(e.size>5242880)return{ok:!1,error:"File exceeds 5MB size limit"};const a=await async function(e){const a=await e.arrayBuffer(),t=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e);return{ok:!0,meta:{mimeType:e.type,sizeBytes:e.size,checksum:a}}}const oe=/[A-Z0-9/]{6,12}/i;var ie=t(1389);const se=[{label:"NRC (Front)",type:"nrc-front",accept:".jpg,.jpeg,.png,.pdf",helper:"Clear photo of NRC front side"},{label:"NRC (Back)",type:"nrc-back",accept:".jpg,.jpeg,.png,.pdf",helper:"Clear photo of NRC back side"},{label:"Payslip (1 of 3)",type:"payslip-1",accept:".jpg,.jpeg,.png,.pdf",helper:"Oldest of the last 3 payslips"},{label:"Payslip (2 of 3)",type:"payslip-2",accept:".jpg,.jpeg,.png,.pdf",helper:"Middle month payslip"},{label:"Payslip (3 of 3)",type:"payslip-3",accept:".jpg,.jpeg,.png,.pdf",helper:"Most recent payslip"},{label:"Application Form/ Pre-Approval Form",type:"reference-letter",accept:".jpg,.jpeg,.png,.pdf",optional:!0,helper:"Pre-approval form from employer or institution"},{label:"Work ID",type:"work-id",accept:".jpg,.jpeg,.png,.pdf",optional:!0},{label:"Selfie / Applicant Photo",type:"selfie",accept:".jpg,.jpeg,.png",optional:!0,helper:"Clear, well-lit photo of the applicant"},{label:"Recent Bank Statement",type:"bank-statement",accept:".pdf",optional:!0}],le=()=>{var e;const{documents:a,addOrReplaceDocument:d,removeDocument:u,customer:p,loan:m}=(0,J.l)(),{state:f}=(0,$.Dy)(),{submitLoanApplication:g,uploadDocument:h}=te();const{push:b}=(0,X.d)(),y=(0,r.useRef)({}),v=(0,r.useRef)(a),x=(0,r.useRef)([]),w=(0,r.useRef)(null),C=(0,r.useRef)(new Map);(0,r.useEffect)(()=>{v.current=a},[a]),(0,r.useEffect)(()=>()=>{x.current.forEach(e=>clearInterval(e)),x.current=[]},[]);const k=(0,r.useCallback)(async e=>{if(e.file)try{var a;d((0,n.A)((0,n.A)({},e),{},{status:"uploading",progress:0}));const s=p.customerId||(null===(a=f.currentCustomer)||void 0===a?void 0:a.customerId);console.log("Debug: Customer ID for upload:",s||"(none - will use form data)"),console.log("Debug: Wizard customer data:",p),console.log("Debug: Altus context customer:",f.currentCustomer);const l={"nrc-front":"SKIP","nrc-back":"SKIP","combined-nrc":"6",payslip:"SKIP","payslip-1":"SKIP","payslip-2":"SKIP","payslip-3":"SKIP","combined-payslips":"18","reference-letter":"29","work-id":"29",selfie:"17","bank-statement":"30"}[e.type]||"6";if("SKIP"===l)return console.log("\u23ed\ufe0f Skipping individual upload for ".concat(e.type," - will be uploaded as merged document")),void d((0,n.A)((0,n.A)({},e),{},{status:"verified",progress:100}));let c=w.current;c?console.log("\u267b\ufe0f Reusing existing ApplicationNumber:",c):(console.log("\ud83d\ude80 Step 1: Submitting loan application for approval..."),c=await g(),w.current=c,console.log("\u2705 Got ApplicationNumber:",c),console.log("\u23f3 Waiting for backend approval before document upload (storing locally)...")),console.log("\ud83d\udce4 Step 2: Attempting document upload...");try{const a=await h(c,l,e.file);C.current.delete(e.type),d((0,n.A)((0,n.A)({},e),{},{id:a,status:"uploaded",progress:100})),b("".concat(e.type.replace("-"," ")," uploaded successfully!"),"success")}catch(i){var t,r,o;if(!((null===i||void 0===i||null===(t=i.message)||void 0===t?void 0:t.includes("Application Number does not exists"))||(null===i||void 0===i||null===(r=i.details)||void 0===r||null===(o=r.executionMessage)||void 0===o?void 0:o.includes("Application Number does not exists"))))throw i;{console.log("\u2139\ufe0f Loan application pending approval. Storing document for retry:",e.type);const a=new FileReader;a.onloadend=()=>{const t=a.result;C.current.set(e.type,{doc:e,base64:t,typeCode:l});const n=C.current.size;O(n),console.log("\ud83d\udce6 Stored ".concat(e.type," locally. Total pending: ").concat(n))},a.readAsDataURL(e.file),d((0,n.A)((0,n.A)({},e),{},{status:"uploaded",progress:100,id:"pending-".concat(Date.now())})),b("".concat(e.type.replace("-"," ")," ready. Will upload after loan approval."),"info")}}}catch(s){console.error("Error uploading document:",s);let a="Upload failed";s instanceof Error&&(a=s.message),d((0,n.A)((0,n.A)({},e),{},{status:"error",errorMessage:a})),b("Failed to upload ".concat(e.type.replace("-"," "),". ").concat(a),"error")}},[d,f.currentCustomer,p,g,h,b]),N=(0,r.useCallback)(async(e,r)=>{var o,i,s,l;console.log("Debug: File selection started for type:",r);const c=null===(o=e.target.files)||void 0===o?void 0:o[0];if(!c)return void console.log("Debug: No file selected");console.log("Debug: File selected:",c.name,"Size:",c.size,"Type:",c.type);const u=(null===p||void 0===p?void 0:p.nrc)||"Unknown_NRC",m="string"===typeof u?u.replace(/[^\w]/g,""):String(u).replace(/[^\w]/g,""),f=(e=>{const a=se.find(a=>a.type===e);return(null===a||void 0===a?void 0:a.label.replace(/[^\w\s-]/g,"").replace(/\s+/g,"_"))||e})(r),g=(e=>{const a=e.lastIndexOf(".");return-1!==a?e.substring(a):""})(c.name),h="".concat(f,"_").concat(m).concat(g),y=new File([c],h,{type:c.type});console.log("Debug: Starting file validation for:",y.name);const w=await re(y);if(console.log("Debug: File validation result:",w),!w.ok)return console.log("Debug: File validation failed:",w.error),b(w.error||"File rejected","error"),void d({file:y,type:r,status:"error",errorMessage:w.error});var C;if(a.find(e=>{var a;return e.checksumSha256&&e.checksumSha256===(null===(a=w.meta)||void 0===a?void 0:a.checksum)&&e.type!==r}))return b("This file appears already uploaded under a different document type.","warning"),void d({file:y,type:r,status:"error",errorMessage:"Duplicate of another document",checksumSha256:null===(C=w.meta)||void 0===C?void 0:C.checksum});const A=y.type.startsWith("image/")?URL.createObjectURL(y):void 0;d({file:y,type:r,status:"verifying",previewUrl:A,mimeType:null===(i=w.meta)||void 0===i?void 0:i.mimeType,sizeBytes:null===(s=w.meta)||void 0===s?void 0:s.sizeBytes,checksumSha256:null===(l=w.meta)||void 0===l?void 0:l.checksum,progress:0});const N=Date.now(),B=Math.min(1.8,Math.max(1,w.meta.sizeBytes/1048576)),j=window.setInterval(async()=>{const a=v.current.find(e=>e.type===r);if(!a)return;const o=Date.now()-N,i=Math.min(95,Math.round(o/(1200*B)*100));if(d((0,n.A)((0,n.A)({},a),{},{progress:i})),i>=95){var s,l,c,u,m;clearInterval(j),x.current=x.current.filter(e=>e!==j);let a=null;try{a=await async function(a){if(!a.type.startsWith("image/")&&"application/pdf"!==a.type)return console.warn("File type not supported for OCR:",a.type),null;if(a.size>10485760)return console.warn("File too large for OCR processing:",a.size),null;if(!a.size||0===a.size)return console.warn("File is empty or unreadable"),null;let n=null;try{const{createWorker:e}=await t.e(938).then(t.t.bind(t,9938,23));n=await e("eng");const r=URL.createObjectURL(a),o=new Image;await new Promise((e,a)=>{o.onload=e,o.onerror=()=>a(new Error("Invalid image file")),o.src=r}),URL.revokeObjectURL(r);const{data:i}=await Promise.race([n.recognize(a),new Promise((e,a)=>setTimeout(()=>a(new Error("OCR timeout")),3e4))]),s=i.text||"",l=s.trim().slice(0,160),c=s.match(oe);return{snippet:l,fullText:s,detectedNrc:c?c[0]:null}}catch(e){return console.warn("OCR failed:",e instanceof Error?e.message:"Unknown error"),null}finally{if(n)try{await n.terminate()}catch(r){console.warn("Failed to terminate OCR worker:",r)}}}(y)}catch(f){console.warn("OCR processing failed for file:",y.name,f)}let n="Basic checks passed";if(null!==(s=a)&&void 0!==s&&s.detectedNrc&&"nrc-front"===r){const e=null===p||void 0===p?void 0:p.nrc;if(e&&e.trim().length>0){const t=e=>e.replace(/[/\s\-]/g,"").toLowerCase().trim(),r=t(a.detectedNrc),o=t(String(e)),i=r===o;n+=i?" | NRC match confirmed":" | NRC mismatch (detected: ".concat(a.detectedNrc,", expected: ").concat(e,")"),console.log("NRC Validation:",{detected:a.detectedNrc,detectedNormalized:r,customer:e,customerNormalized:o,match:i})}else console.log("NRC Validation: Customer NRC not available for comparison, detected:",a.detectedNrc),n+=" | NRC detected: ".concat(a.detectedNrc," (no customer NRC to compare)")}const o={file:y,type:r,status:"verified",previewUrl:A,mimeType:null===(l=w.meta)||void 0===l?void 0:l.mimeType,sizeBytes:null===(c=w.meta)||void 0===c?void 0:c.sizeBytes,checksumSha256:null===(u=w.meta)||void 0===u?void 0:u.checksum,extractedTextSnippet:null===(m=a)||void 0===m?void 0:m.snippet,verificationNotes:n,progress:100};d(o),b("Document verified","success"),setTimeout(()=>k(o),500)}},150);x.current.push(j)},[d,a,b,p,k]),B=(0,r.useCallback)(async()=>{const e=a.find(e=>"payslip-1"===e.type&&"verified"===e.status),t=a.find(e=>"payslip-2"===e.type&&"verified"===e.status),n=a.find(e=>"payslip-3"===e.type&&"verified"===e.status);if(e&&t&&n&&e.file&&t.file&&n.file&&!a.find(e=>"combined-payslips"===e.type))try{b("Merging payslips into single document...","info");const a=(null===p||void 0===p?void 0:p.nrc)||"Unknown_NRC",r=await(async(e,a,t,n)=>{const r=new ie.uE;let o=!1;const i=async(e,a)=>new Promise((t,n)=>{const i=new FileReader;i.onload=async i=>{try{var s;const l=null===(s=i.target)||void 0===s?void 0:s.result;if("application/pdf"===e.type)o&&r.addPage(),r.setFontSize(16),r.text("Payslip ".concat(a),20,30),r.setFontSize(10),r.text("Original file: ".concat(e.name),20,50),r.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,60),r.text("Note: PDF content preserved in original file",20,70),o=!0,t();else if(e.type.startsWith("image/")){o&&r.addPage();const e=new Image;e.onload=()=>{try{const n=document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("Canvas context not available");const s=190,l=270,c=e.width/e.height;let d,u;c>s/l?(d=s,u=s/c):(u=l,d=l*c);const p=1200,m=1200;let f=e.width,g=e.height;if(f>p||g>m){const e=Math.min(p/f,m/g);f=Math.floor(f*e),g=Math.floor(g*e)}n.width=f,n.height=g,i.drawImage(e,0,0,f,g);const h=n.toDataURL("image/jpeg",.7);r.addImage(h,"JPEG",10,10,d,u),r.setFontSize(8),r.text("Payslip ".concat(a),10,u+20),o=!0,t()}catch(i){n(i)}},e.onerror=()=>n(new Error("Failed to load image")),e.src=l}else o&&r.addPage(),r.setFontSize(16),r.text("Payslip ".concat(a),20,30),r.setFontSize(10),r.text("Original file: ".concat(e.name),20,50),r.text("File type: ".concat(e.type),20,60),r.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,70),r.text("Note: Original file content preserved",20,80),o=!0,t()}catch(l){n(l)}},i.onerror=()=>n(new Error("Failed to read file")),e.type.startsWith("image/")?i.readAsDataURL(e):i.readAsArrayBuffer(e)});try{r.setFontSize(20),r.text("Combined Payslips",20,30),r.setFontSize(12),r.text("Client NRC: ".concat(n),20,50),r.text("Generated: ".concat((new Date).toLocaleString()),20,60),r.setFontSize(10),r.text("This document contains three consecutive payslips:",20,80),r.text("1. Oldest payslip",30,90),r.text("2. Middle payslip",30,100),r.text("3. Most recent payslip",30,110),o=!0,await i(e,1),await i(a,2),await i(t,3);const s=r.output("blob"),l=n.replace(/[^\w]/g,"");return new File([s],"Combined_Payslips_".concat(l,".pdf"),{type:"application/pdf"})}catch(s){throw console.error("Error merging payslips:",s),new Error("Failed to merge payslips")}})(e.file,t.file,n.file,String(a)),o={file:r,type:"combined-payslips",status:"verified",mimeType:"application/pdf",sizeBytes:r.size,verificationNotes:"Combined from 3 individual payslips",progress:100};d(o),b("Payslips successfully merged into single document","success"),setTimeout(()=>k(o),500)}catch(r){console.error("Failed to merge payslips:",r),b("Failed to merge payslips - individual files preserved","error")}},[a,p,d,b,k]),j=(0,r.useCallback)(async()=>{const e=a.find(e=>"nrc-front"===e.type&&"verified"===e.status),t=a.find(e=>"nrc-back"===e.type&&"verified"===e.status);if(e&&t&&e.file&&t.file&&!a.find(e=>"combined-nrc"===e.type))try{b("Merging NRC front and back into single document...","info");const a=(null===p||void 0===p?void 0:p.nrc)||"Unknown_NRC",n=await(async(e,a,t)=>{const n=new ie.uE;let r=!1;const o=async(e,a)=>new Promise((t,o)=>{const i=new FileReader;i.onload=async i=>{try{var s;const l=null===(s=i.target)||void 0===s?void 0:s.result;if(e.type.startsWith("image/")){r&&n.addPage();const i=new Image;i.onload=()=>{try{const e=document.createElement("canvas"),o=e.getContext("2d");if(!o)throw new Error("Canvas context not available");const s=190,l=270,c=i.width/i.height;let d,u;c>s/l?(d=s,u=s/c):(u=l,d=l*c);const p=1200,m=1200;let f=i.width,g=i.height;if(f>p||g>m){const e=Math.min(p/f,m/g);f=Math.floor(f*e),g=Math.floor(g*e)}e.width=f,e.height=g,o.drawImage(i,0,0,f,g);const h=e.toDataURL("image/jpeg",.7);n.addImage(h,"JPEG",10,10,d,u),n.setFontSize(10),n.setTextColor(100),n.text("".concat(a),10,u+20),r=!0,t()}catch(e){o(e)}},i.onerror=()=>o(new Error("Failed to load image: ".concat(e.name))),"string"===typeof l?i.src=l:o(new Error("Invalid file data"))}else"application/pdf"===e.type?(r&&n.addPage(),n.setFontSize(16),n.text(a,20,30),n.setFontSize(10),n.text("Original file: ".concat(e.name),20,50),n.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,60),n.text("Note: PDF content preserved in original file",20,70),r=!0,t()):o(new Error("Unsupported file type: ".concat(e.type)))}catch(l){o(l)}},i.onerror=()=>o(new Error("Failed to read file")),i.readAsDataURL(e)});try{await o(e,"NRC Front"),await o(a,"NRC Back");const r=n.output("blob"),i=Date.now(),s="NRC_Combined_".concat(t,"_").concat(i,".pdf");return new File([r],s,{type:"application/pdf"})}catch(i){throw console.error("Error merging NRC images:",i),i}})(e.file,t.file,String(a)),r={file:n,type:"combined-nrc",status:"verified",mimeType:"application/pdf",sizeBytes:n.size,verificationNotes:"Combined NRC front and back",progress:100};d(r),b("NRC documents successfully merged","success"),setTimeout(()=>k(r),500)}catch(n){console.error("Failed to merge NRC documents:",n),b("Failed to merge NRC documents - individual files preserved","error")}},[a,p,d,b,k]);(0,r.useEffect)(()=>{3!==["payslip-1","payslip-2","payslip-3"].filter(e=>a.find(a=>a.type===e&&"verified"===a.status)).length||a.find(e=>"combined-payslips"===e.type)||B()},[a,B]),(0,r.useEffect)(()=>{const e=a.find(e=>"nrc-front"===e.type&&"verified"===e.status),t=a.find(e=>"nrc-back"===e.type&&"verified"===e.status);e&&t&&!a.find(e=>"combined-nrc"===e.type)&&j()},[a,j]);const M=(0,r.useCallback)(e=>a.find(a=>a.type===e),[a]),L=e=>{console.log("Debug: Opening file picker for type:",e);const a=y.current[e];console.log("Debug: File input element:",a),a?(a.click(),console.log("Debug: File picker clicked")):console.error("Debug: File input not found for type:",e)};window.__documentsStepValidate=async()=>{var e;const a=["nrc-front","payslip-1","payslip-2","payslip-3"].filter(e=>!M(e));if(a.length)return b("Please upload all required documents: "+a.join(", "),"error"),!1;["payslip-1","payslip-2","payslip-3"].some(e=>{var a;return"verifying"===(null===(a=M(e))||void 0===a?void 0:a.status)})&&b("\u2713 Payslips are being verified. You can proceed to Review - verification will continue in background.","info");const t=M("nrc-front");return(null===t||void 0===t||null===(e=t.verificationNotes)||void 0===e?void 0:e.includes("mismatch"))&&b("Warning: NRC mismatch detected \u2013 please verify ID number.","warning"),w.current||b("\u2713 Documents saved. You can proceed to Review while waiting for loan approval.","info"),!0};const S=(0,r.useCallback)(async()=>{if(!w.current||0===C.current.size)return void b("No pending documents to retry","info");console.log("\ud83d\udd04 Retrying ".concat(C.current.size," pending document(s)...")),b("Retrying ".concat(C.current.size," pending document(s)..."),"info");const e=Array.from(C.current.entries());for(const[t,{doc:r,typeCode:o}]of e)if(r.file)try{console.log("\ud83d\udd04 Retrying upload for: ".concat(t)),d((0,n.A)((0,n.A)({},r),{},{status:"uploading",progress:50}));const e=await h(w.current,o,r.file);C.current.delete(t),d((0,n.A)((0,n.A)({},r),{},{id:e,status:"uploaded",progress:100})),b("".concat(t.replace("-"," ")," uploaded successfully!"),"success")}catch(a){console.error("Failed to retry ".concat(t,":"),a),d((0,n.A)((0,n.A)({},r),{},{status:"uploaded",progress:100}))}if(0===C.current.size)b("All documents uploaded successfully!","success"),O(0);else{const e=C.current.size;O(e),b("".concat(e," document(s) still pending approval"),"warning")}},[h,d,b]),R=["nrc-front","payslip-1","payslip-2","payslip-3"],z=R.filter(e=>{var a;return"verified"===(null===(a=M(e))||void 0===a?void 0:a.status)}).length,P=(0,r.useMemo)(()=>se.filter(e=>e.type.startsWith("payslip-")).map(e=>({cfg:e,doc:M(e.type)})),[M]),K=P.filter(e=>{var a;return"verified"===(null===(a=e.doc)||void 0===a?void 0:a.status)}).length,I=M("selfie"),D=(0,r.useMemo)(()=>Math.round(z/R.length*100),[z,R.length]),[F,O]=r.useState(0);r.useEffect(()=>{const e=C.current.size;O(e),console.log("\ud83d\udcca Pending documents count updated: ".concat(e))},[a]);(0,r.useCallback)(()=>{const e=C.current.size;O(e),console.log("\ud83d\udcca Pending documents count: ".concat(e))},[]);return(0,A.jsxs)(o.A,{children:[(0,A.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Supporting Documents"}),F>0&&(0,A.jsxs)(s.A,{severity:"warning",sx:{mb:2,border:"2px solid",borderColor:"warning.main",boxShadow:"0 4px 12px rgba(255, 152, 0, 0.2)"},action:(0,A.jsxs)(l.A,{color:"inherit",size:"small",onClick:S,sx:{whiteSpace:"nowrap",fontWeight:700,bgcolor:"warning.dark",color:"white","&:hover":{bgcolor:"warning.main"}},children:["\ud83d\udd04 Retry Upload (",F,")"]}),children:[(0,A.jsxs)(i.A,{variant:"body2",sx:{fontWeight:700,fontSize:"1rem"},children:["\u23f3 ",F," Document(s) Awaiting Backend Approval"]}),(0,A.jsxs)(i.A,{variant:"caption",sx:{display:"block",mt:.5},children:[(0,A.jsxs)("strong",{children:["Application Number: ",w.current]}),(0,A.jsx)("br",{}),"Your loan application requires manual approval from the Altus system administrator before documents can be uploaded. All documents are saved securely in your browser.",(0,A.jsx)("br",{}),(0,A.jsx)("strong",{children:"What happens next:"}),(0,A.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[(0,A.jsxs)("li",{children:["Administrator reviews your loan application (",w.current,")"]}),(0,A.jsx)("li",{children:'Once approved, click "Retry Upload" to upload all pending documents'}),(0,A.jsx)("li",{children:"You can close this page and return later - your documents are saved locally"})]}),(0,A.jsx)("em",{children:"Approval typically takes 5-15 minutes during business hours."})]})]}),w.current&&0===F&&(0,A.jsxs)(s.A,{severity:"info",sx:{mb:2},children:[(0,A.jsxs)(i.A,{variant:"body2",sx:{fontWeight:600},children:["\ud83d\udccb Loan Application: ",w.current]}),(0,A.jsxs)(i.A,{variant:"caption",sx:{display:"block",mt:.5},children:[(0,A.jsx)("strong",{children:"Status:"})," Pending backend approval by Altus administrator.",(0,A.jsx)("br",{}),"Continue uploading documents - they will be stored locally and uploaded automatically after approval."]})]}),!(null!==(e=f.currentCustomer)&&void 0!==e&&e.customerId)&&!(null!==p&&void 0!==p&&p.customerId)&&(0,A.jsxs)(s.A,{severity:"success",sx:{mb:2},children:[(0,A.jsx)(i.A,{variant:"body2",sx:{fontWeight:600,mb:.5},children:"\u26a1 Fast Track Mode Active"}),(0,A.jsx)(i.A,{variant:"caption",sx:{display:"block"},children:"Skip creating a customer account - just fill the form in Step 1 and Step 2, then upload documents here. Your loan application will be created automatically using your form data."})]}),(0,A.jsx)(o.A,{sx:{mb:2,p:2,border:"1px solid",borderColor:"divider",borderRadius:2,background:100===D?"linear-gradient(90deg,#093B18,#2E7D32)":"linear-gradient(90deg,#132F52,#063970)",color:"#fff"},children:(0,A.jsxs)(c.A,{direction:{xs:"column",sm:"row"},spacing:1.5,alignItems:{xs:"flex-start",sm:"center"},children:[(0,A.jsxs)(i.A,{variant:"subtitle2",sx:{fontWeight:600},children:["Required Docs: ",z,"/",R.length," verified"]}),(0,A.jsx)(o.A,{sx:{flex:1,width:"100%",maxWidth:260},children:(0,A.jsx)(H,{variant:"determinate",value:D,sx:{height:8,borderRadius:4,background:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{background:"#fff"}}})}),(0,A.jsxs)(i.A,{variant:"caption",sx:{opacity:.9},children:[D,"%"]})]})}),(0,A.jsx)(i.A,{variant:"body2",sx:{mb:2},children:"Upload the required documents. You can replace a file by selecting it again."}),(0,A.jsxs)(c.A,{spacing:3,children:[se.filter(e=>!e.type.startsWith("payslip-")).map(e=>{var a,t,n;const r=M(e.type),s="selfie"===e.type,d="nrc-front"===e.type&&(null===r||void 0===r||null===(a=r.verificationNotes)||void 0===a?void 0:a.includes("mismatch"));return(0,A.jsxs)(o.A,{sx:{p:2,border:"1px dashed",borderColor:d?"error.light":"divider",borderRadius:2,position:"relative"},children:[d&&(0,A.jsx)(q.A,{size:"small",color:"error",label:"NRC Mismatch",sx:{position:"absolute",top:8,right:8}}),(0,A.jsxs)(c.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,A.jsxs)(o.A,{sx:{flex:1},children:[(0,A.jsx)(i.A,{variant:"subtitle2",children:e.label}),e.helper&&(0,A.jsx)(i.A,{variant:"caption",sx:{display:"block",color:"text.secondary",mt:.25},children:e.helper}),e.optional&&!r&&(0,A.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:"Optional"}),r?(0,A.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:1,flexWrap:"wrap"},children:[(0,A.jsx)(q.A,{size:"small",color:"verified"===r.status?"success":"error"===r.status?"error":"verifying"===r.status?"warning":"default",label:(null===(t=r.file)||void 0===t?void 0:t.name)||(null===(n=r.checksumSha256)||void 0===n?void 0:n.slice(0,8))||"Document"}),r.previewUrl&&r.file&&(0,A.jsx)("img",{src:r.previewUrl,alt:e.label+" preview",style:{width:s?60:48,height:s?60:48,objectFit:"cover",borderRadius:s?"50%":6,border:s?"2px solid #1976d2":"1px solid rgba(0,0,0,0.15)"}}),(0,A.jsx)(ce,{status:r.status}),r.sizeBytes&&(0,A.jsx)(_.A,{title:"~".concat(Math.round(r.sizeBytes/1024)," KB"),children:(0,A.jsx)(q.A,{size:"small",variant:"outlined",label:Math.round(r.sizeBytes/1024)+" KB"})}),"number"===typeof r.progress&&"verified"!==r.status&&(0,A.jsx)(o.A,{sx:{width:140,ml:1},children:(0,A.jsx)(H,{variant:"determinate",value:r.progress,sx:{height:6,borderRadius:3}})}),r.verificationNotes&&"verified"===r.status&&"nrc-front"===e.type&&(0,A.jsx)(_.A,{title:r.verificationNotes,children:(0,A.jsx)(q.A,{size:"small",variant:"outlined",label:r.verificationNotes.includes("mismatch")?"Mismatch":"Match",color:r.verificationNotes.includes("mismatch")?"error":"success"})})]}):(0,A.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:"No file selected"})]}),(0,A.jsx)("input",{type:"file",ref:a=>y.current[e.type]=a,accept:e.accept,style:{display:"none"},onChange:a=>N(a,e.type)}),(0,A.jsx)(l.A,{variant:"outlined",startIcon:(0,A.jsx)(Z,{}),onClick:()=>L(e.type),children:r?"Replace":"Select"}),r&&(0,A.jsx)(V.A,{color:"error",onClick:()=>u(e.type),"aria-label":"Remove ".concat(e.label),children:(0,A.jsx)(Y.A,{})})]})]},e.type)}),(0,A.jsxs)(o.A,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[(0,A.jsxs)(c.A,{direction:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},spacing:2,sx:{mb:1},children:[(0,A.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:600},children:"Payslips (3)"}),(0,A.jsx)(o.A,{sx:{flex:1,width:"100%",maxWidth:240},children:(0,A.jsx)(H,{variant:"determinate",value:K/3*100,sx:{height:6,borderRadius:3}})}),(0,A.jsxs)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:[K,"/3 verified"]})]}),(0,A.jsx)(G.A,{sx:{mb:1}}),(0,A.jsx)(c.A,{spacing:2,children:P.map(e=>{var a,t;let{cfg:n,doc:r}=e;return(0,A.jsx)(o.A,{sx:{p:1.5,border:"1px dashed",borderColor:"divider",borderRadius:2},children:(0,A.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,A.jsxs)(o.A,{sx:{flex:1},children:[(0,A.jsx)(i.A,{variant:"body2",sx:{fontWeight:500},children:n.label}),n.helper&&(0,A.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:n.helper}),r?(0,A.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:.75,flexWrap:"wrap"},children:[(0,A.jsx)(q.A,{size:"small",color:"verified"===r.status?"success":"error"===r.status?"error":"verifying"===r.status?"warning":"default",label:(null===(a=r.file)||void 0===a?void 0:a.name)||(null===(t=r.checksumSha256)||void 0===t?void 0:t.slice(0,8))||"Payslip"}),r.previewUrl&&r.file&&(0,A.jsx)("img",{src:r.previewUrl,alt:n.label+" preview",style:{width:42,height:42,objectFit:"cover",borderRadius:4}}),(0,A.jsx)(ce,{status:r.status}),"number"===typeof r.progress&&"verified"!==r.status&&(0,A.jsx)(o.A,{sx:{width:120},children:(0,A.jsx)(H,{variant:"determinate",value:r.progress,sx:{height:5,borderRadius:3}})})]}):(0,A.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:"No file selected"})]}),(0,A.jsx)("input",{type:"file",ref:e=>y.current[n.type]=e,accept:n.accept,style:{display:"none"},onChange:e=>N(e,n.type)}),(0,A.jsx)(l.A,{size:"small",variant:"outlined",startIcon:(0,A.jsx)(Z,{}),onClick:()=>L(n.type),children:r?"Replace":"Select"}),r&&(0,A.jsx)(V.A,{size:"small",color:"error",onClick:()=>u(n.type),"aria-label":"Remove ".concat(n.label),children:(0,A.jsx)(Y.A,{fontSize:"small"})})]})},n.type)})})]}),a.find(e=>"combined-nrc"===e.type)&&(0,A.jsxs)(o.A,{sx:{p:2,border:"2px solid",borderColor:"primary.light",borderRadius:2,background:"linear-gradient(90deg,#0d47a1,#1976d2)",color:"#fff",mb:2},children:[(0,A.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"\ud83e\udeaa Combined NRC Document"}),(e=>{const t=a.find(e=>"combined-nrc"===e.type);return t?(0,A.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,A.jsxs)(o.A,{sx:{flex:1},children:[(0,A.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,A.jsx)(q.A,{size:"small",color:"primary",label:(null===(e=t.file)||void 0===e?void 0:e.name)||"NRC_Combined.pdf",sx:{background:"rgba(255,255,255,0.9)",color:"#0d47a1"}}),(0,A.jsx)(q.A,{size:"small",variant:"outlined",label:"MERGED",sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}}),t.sizeBytes&&(0,A.jsx)(q.A,{size:"small",variant:"outlined",label:"".concat(Math.round(t.sizeBytes/1024)," KB"),sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}})]}),(0,A.jsx)(i.A,{variant:"caption",sx:{display:"block",mt:.5,opacity:.9},children:"NRC front and back have been automatically combined into a single PDF document"})]}),(0,A.jsx)(V.A,{size:"small",sx:{color:"#fff"},onClick:()=>u("combined-nrc"),"aria-label":"Remove combined NRC",children:(0,A.jsx)(Y.A,{fontSize:"small"})})]}):null})()]}),a.find(e=>"combined-payslips"===e.type)&&(0,A.jsxs)(o.A,{sx:{p:2,border:"2px solid",borderColor:"success.light",borderRadius:2,background:"linear-gradient(90deg,#1b5e20,#2e7d32)",color:"#fff"},children:[(0,A.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"\ud83d\udcc4 Combined Payslips Document"}),(e=>{const t=a.find(e=>"combined-payslips"===e.type);return t?(0,A.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,A.jsxs)(o.A,{sx:{flex:1},children:[(0,A.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,A.jsx)(q.A,{size:"small",color:"success",label:(null===(e=t.file)||void 0===e?void 0:e.name)||"Combined_Payslips.pdf",sx:{background:"rgba(255,255,255,0.9)",color:"#1b5e20"}}),(0,A.jsx)(q.A,{size:"small",variant:"outlined",label:"MERGED",sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}}),t.sizeBytes&&(0,A.jsx)(q.A,{size:"small",variant:"outlined",label:"".concat(Math.round(t.sizeBytes/1024)," KB"),sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}})]}),(0,A.jsx)(i.A,{variant:"caption",sx:{display:"block",mt:.5,opacity:.9},children:"All three payslips have been automatically combined into a single PDF document"})]}),(0,A.jsx)(V.A,{size:"small",sx:{color:"#fff"},onClick:()=>u("combined-payslips"),"aria-label":"Remove combined payslips",children:(0,A.jsx)(Y.A,{fontSize:"small"})})]}):null})()]})]}),(0,A.jsxs)(i.A,{variant:"caption",sx:{mt:3,display:"block",color:"text.secondary"},children:["Files are stored locally until you submit. Verification here is preliminary.",I?"":" (Adding a selfie can speed up identity confirmation.)"]})]})},ce=e=>{let{status:a}=e;if(!a)return null;const t={pending:{color:"default",label:"PENDING"},uploading:{color:"warning",label:"UPLOADING"},uploaded:{color:"default",label:"UPLOADED"},verifying:{color:"warning",label:"VERIFYING"},verified:{color:"success",label:"VERIFIED"},error:{color:"error",label:"ERROR"}}[a];return(0,A.jsx)(q.A,{size:"small",variant:"outlined",color:t.color,label:t.label})}},5264:(e,a,t)=>{t.d(a,{Cm:()=>l,eX:()=>i,xw:()=>s,yR:()=>n});const n=["Head Office","Lusaka Square","Lusaka South End","Lusaka Corporate Service Centre Branch","Kalingalinga","Tazara","Garden","Makumbi","Bread of Life","Longacres Prestige Branch","Manda Hill Branch","Matero Branch","Ndola","Kitwe","Kitwe Agency","Chililabombwe","Chingola","Kasama","Mpulungu","Mbala","Mbala Branch Zambia","Mansa","Mansa Branch","Mwense","Chipata","Petauke Branch","Solwezi","Mufumbwe","Mkushi Branch"],r={BNK20201490000000622:["Banking Society Business Park","Mufulira","Mpika","Mansa","Kapiri Mposhi","Livingstone","Mazabuka","Mongu","Luanshya","Solwezi","Kasama","Society House","Permanent House","Kabwe","Chipata","Choma","Soweto Agency","Chililabombwe","Chingola","Nyimba","Kitwe","Ndola"],BNK20200430000000002:["Head Office","Cairo Main","Chilenje","Matero","Kalinglinga","Chelston","Garden","Kitwe"],BNK20200430000000006:["Head Office","Cairo Road","Longacres","Acacia","Makeni","Ndola","Kitwe","Solwezi"],BNK20203020000000662:["Head Office","Northend","Longacres","Arcades","Ndola Centre Branch","Kitwe","Makeni","Mansa Centre Branch","Mbala Centre Branch","Mbala Main Branch","Ndola Main Branch","City Mall Branch - Solwezi","Solwezi Main Branch"],BNK20200430000000007:["Lusaka"],BNK20200430000000008:["Lusaka","Kitwe"],BNK20200440000000035:["Head Office","Head Office - Elunda","Lusaka - Kamwala","Lusaka - Northend","Lusaka - Matero","Lusaka Business Centre","Lusaka Longacres","Chilenje","Lusaka Industrial","University of Zambia Lusaka","Soweto","Chelstone","Kabwata","Lusaka - Chawama","Manda Hill","Lusaka Operation Processing Centre","Kabelenga","Elunda Premium Banking Centre","Ndola Business Centre","Ndola Operations Processing Centre","Ndola - Masala","Kitwe Business Centre","Kitwe Chimwemwe","Kitwe Parklands Center","Kitwe Operations Processing Centre","Chingola & Prestige","Chililabombwe","Mufulira & Prestige","Kalulushi","Luanshya","Kasama","Kabwe & Prestige","Livingstone","Chipata","Choma","Mbala","Nakonde","Mpika","Mansa","Mkushi","Kapiri Mposhi","Lundazi","Mfuwe","Solwezi","Mongu","Kafue","Chirundu","Mazabuka","Monze","Kalomo","Petauke","Chongwe","Katete","Chambishi","Mumbwa","Levy"],BNK20200830000000616:["Petauke Branch","Manda Hill Branch","Matero Branch","Mkushi Branch","Mbala Branch Zambia","Longacres Prestige Branch","Lusaka Corporate Service Centre Branch","Mansa Branch"],BNK20200440000000036:["Head Office","Lusaka Square","Lusaka South End","Kalingalinga","Tazara","Garden","Makumbi","Bread of Life","Ndola","Kitwe"],BNK20200450000000043:["Lusaka"],BNK20200450000000044:["Lusaka"],BNK20200450000000046:["Lusaka"],BNK20200450000000049:["Lusaka"],BNK20200480000000053:["Commercial Suite","Industrial","FNB Operation Centre","Head Office","Electronic Banking","Treasury","Manda Hill","Vehicle and Asset Finance","Makeni Mall","Home Loan","Branchless Banking","Electronic Wallet","CIB Corporate","Premier Banking","Agriculture Centre","Corporate Investment Banking","Chilenje","Cash Centre","PHI Branch","Cairo","Kabulonga","Ndola","Jacaranda Mall","Kitwe","Mukuba Mall","Kitwe Industrial","Chingola","Mufulira","Luanshya","Kabwe","Livingstone","Chipata","Choma","Mkushi","Solwezi","Kalumbila","Mazabuka"],FNB:["Commercial Suite","Industrial","FNB Operation Centre","Head Office","Electronic Banking","Treasury","Manda Hill","Vehicle and Asset Finance","Makeni Mall","Home Loan","Branchless Banking","Electronic Wallet","CIB Corporate","Premier Banking","Agriculture Centre","Corporate Investment Banking","Chilenje","Cash Centre","PHI Branch","Cairo","Kabulonga","Ndola","Jacaranda Mall","Kitwe","Mukuba Mall","Kitwe Industrial","Chingola","Mufulira","Luanshya","Kabwe","Livingstone","Chipata","Choma","Mkushi","Solwezi","Kalumbila","Mazabuka"],BNK20200520000000062:["Lusaka"],BNK20200520000000065:["Lusaka"],BNK20200550000000081:["Lusaka"],BNK20200760000000614:["Cosmopolitan"],BNK20201490000000621:["Chama","Chavuma","Chilubi Island","Chimwemwe","Chinsali","Chipata","Choma","Chongwe","Kabwe","Kalabo","Kaputa","Kasama","Kasempa","Kazungula","Kitwe","Livingstone","Luanshya","Lumwana","Lufwanyama","Lukulu","Credit Centre","Lusaka Chilenje","Lusaka Main Branch","Lusaka Matero","Lusaka Northend","Luwingu","Mansa","Mongu","Mpika","Mporokoso","Mpongwe","Mumbwa","Mwense","Nchelenge","Ndola","Petauke","Solwezi","Zambezi","Head office","Cosmopolitan"],BNK20200690000000253:["Lusaka"],BNK20200590000000113:["Lusaka"],"Stanbic Bank":["Lusaka"],Stanbic:["Lusaka"],BNK20200590000000119:["Lusaka"],"Standard Chartered":["Lusaka"],BNK20200590000000120:["Lusaka"],BNK20200590000000121:["Lusaka"],BNK20200590000000122:["Lusaka"],BNK20200590000000123:["Head Office","Lusaka Main Branch","Ndola","Kitwe","Livingstone","Kasama","Chipata"],BNK20213160000000663:["Lusaka Business Centre"],BNK20222300000000664:["Lusaka Main Branch"]},o={"Lusaka Province - Head Office":["Head Office","Lusaka Corporate Service Centre Branch"],"Lusaka Province - Retail Branches":["Lusaka Square","Lusaka South End","Kalingalinga","Tazara","Garden","Makumbi","Bread of Life","Longacres Prestige Branch","Manda Hill Branch","Matero Branch"],"Copperbelt Province":["Ndola","Kitwe","Kitwe Agency","Chililabombwe","Chingola"],"Northern Province":["Kasama","Mpulungu","Mbala","Mbala Branch Zambia"],"Luapula Province":["Mansa","Mansa Branch","Mwense"],"Eastern Province":["Chipata","Petauke Branch"],"North-Western Province":["Solwezi","Mufumbwe"],"Central Province":["Mkushi Branch"]},i=e=>{for(const[a,t]of Object.entries(o))if(t.includes(e))return a;return null},s=e=>n.includes(e),l=e=>r[e]||n}}]);
//# sourceMappingURL=339.b48c766f.chunk.js.map