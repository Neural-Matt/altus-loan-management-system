{"version":3,"file":"static/js/408.378d29bd.chunk.js","mappings":"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","sources":["utils/loanCalculator.ts"],"sourcesContent":["// Reusable local loan calculation utility mirroring the hero quick estimate logic.\r\n// Updated rates and product structure based on new business requirements.\r\n\r\nexport type LocalLoanInstallment = {\r\n  month: number;\r\n  openingBalance: number;\r\n  interestPortion: number;\r\n  principalPortion: number;\r\n  installment: number;\r\n  closingBalance: number;\r\n};\r\n\r\nexport type LocalLoanEstimate = {\r\n  monthlyInstallment: number;\r\n  totalInterest: number;\r\n  totalPayable: number;\r\n  monthlyRate: number; // raw monthly rate used\r\n  schedule: LocalLoanInstallment[];\r\n};\r\n\r\nexport type LoanTypeKey = 'instant-salary-advance' | 'corporate-payroll' | 'government-personal' | 'zambia-army' | 'zambia-airforce';\r\n\r\n// Product definitions with tenure limits and interest rate structures\r\nexport const LOAN_PRODUCTS = {\r\n  'instant-salary-advance': {\r\n    name: 'Instant Salary Advances',\r\n    maxTenureMonths: 3,\r\n    rateStructure: [\r\n      { minAmount: 500, maxAmount: 900, monthlyRate: 0.30 }, // 30% monthly\r\n      { minAmount: 1000, maxAmount: 2500, monthlyRate: 0.25 }, // 25% monthly  \r\n      { minAmount: 3000, maxAmount: 5000, monthlyRate: 0.18 } // 18% monthly\r\n    ]\r\n  },\r\n  'corporate-payroll': {\r\n    name: 'Corporate Payroll',\r\n    maxTenureMonths: 24,\r\n    rateStructure: [\r\n      { minAmount: 0, maxAmount: Number.MAX_SAFE_INTEGER, monthlyRate: 0.05 } // 5% monthly for all amounts\r\n    ]\r\n  },\r\n  'government-personal': {\r\n    name: 'Government Personal Loans',\r\n    maxTenureMonths: 60,\r\n    rateStructure: [\r\n      { minAmount: 0, maxAmount: 14999, monthlyRate: 0.05 }, // 5% monthly below 15000\r\n      { minAmount: 15000, maxAmount: Number.MAX_SAFE_INTEGER, monthlyRate: 0.045 } // 4.5% monthly above 15000\r\n    ]\r\n  },\r\n  'zambia-army': {\r\n    name: 'Zambia Army Loans',\r\n    maxTenureMonths: 60,\r\n    rateStructure: [\r\n      { minAmount: 0, maxAmount: 14999, monthlyRate: 0.05 }, // 5% monthly below 15000\r\n      { minAmount: 15000, maxAmount: Number.MAX_SAFE_INTEGER, monthlyRate: 0.045 } // 4.5% monthly above 15000\r\n    ]\r\n  },\r\n  'zambia-airforce': {\r\n    name: 'Zambia Airforce Loans',\r\n    maxTenureMonths: 60,\r\n    rateStructure: [\r\n      { minAmount: 0, maxAmount: 14999, monthlyRate: 0.05 }, // 5% monthly below 15000\r\n      { minAmount: 15000, maxAmount: Number.MAX_SAFE_INTEGER, monthlyRate: 0.045 } // 4.5% monthly above 15000\r\n    ]\r\n  }\r\n};\r\n\r\n// Get the appropriate monthly rate for a loan amount and product type\r\nfunction getMonthlyRate(amount: number, loanType: LoanTypeKey): number {\r\n  const product = LOAN_PRODUCTS[loanType];\r\n  const applicableRate = product.rateStructure.find(tier => \r\n    amount >= tier.minAmount && amount <= tier.maxAmount\r\n  );\r\n  \r\n  if (!applicableRate) {\r\n    throw new Error(`No rate structure found for amount ${amount} in product ${loanType}`);\r\n  }\r\n  \r\n  return applicableRate.monthlyRate;\r\n}\r\n\r\n// Get maximum tenure for a product type\r\nexport function getMaxTenure(loanType: LoanTypeKey): number {\r\n  return LOAN_PRODUCTS[loanType].maxTenureMonths;\r\n}\r\n\r\n// Validate if amount is within allowed range for the product\r\nexport function validateLoanAmount(amount: number, loanType: LoanTypeKey): { valid: boolean; message?: string } {\r\n  // For instant salary advances, check specific amount ranges\r\n  if (loanType === 'instant-salary-advance') {\r\n    if (amount < 500) {\r\n      return { valid: false, message: 'Minimum amount for Instant Salary Advances is K500' };\r\n    }\r\n    if (amount > 5000) {\r\n      return { valid: false, message: 'Maximum amount for Instant Salary Advances is K5000' };\r\n    }\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n// Get all available loan products for UI display\r\nexport function getLoanProducts(): Array<{ key: LoanTypeKey; name: string; maxTenure: number }> {\r\n  return Object.entries(LOAN_PRODUCTS).map(([key, product]) => ({\r\n    key: key as LoanTypeKey,\r\n    name: product.name,\r\n    maxTenure: product.maxTenureMonths\r\n  }));\r\n}\r\n\r\nexport interface CalcInput {\r\n  principal: number; // amount\r\n  tenureMonths: number;\r\n  loanType?: LoanTypeKey; // optional; default instant-salary-advance\r\n}\r\n\r\n// Simple declining balance schedule: interest each month = current balance * rate; principal = installment - interest.\r\n// Installment derived from linear interest approximation used earlier for UI parity.\r\nexport function computeLocalLoanEstimate({ principal, tenureMonths, loanType = 'instant-salary-advance' }: CalcInput): LocalLoanEstimate {\r\n  if (principal <= 0 || tenureMonths <= 0) {\r\n    throw new Error('Principal and tenure must be positive');\r\n  }\r\n  \r\n  // Validate loan amount for the product type\r\n  const amountValidation = validateLoanAmount(principal, loanType);\r\n  if (!amountValidation.valid) {\r\n    throw new Error(amountValidation.message);\r\n  }\r\n  \r\n  // Validate tenure for the product type\r\n  const maxTenure = getMaxTenure(loanType);\r\n  if (tenureMonths > maxTenure) {\r\n    throw new Error(`Maximum tenure for ${LOAN_PRODUCTS[loanType].name} is ${maxTenure} months`);\r\n  }\r\n  \r\n  const rate = getMonthlyRate(principal, loanType);\r\n  const totalPayable = Math.round(principal * (1 + rate * tenureMonths));\r\n  const monthlyInstallment = Math.round(totalPayable / tenureMonths);\r\n  const schedule: LocalLoanInstallment[] = [];\r\n  let balance = principal;\r\n  let totalInterest = 0;\r\n  for (let m=1; m<=tenureMonths; m++) {\r\n    const opening = balance;\r\n    const interest = Math.round(opening * rate);\r\n    let principalPortion = monthlyInstallment - interest;\r\n    if (principalPortion > balance) principalPortion = balance; // final adjustment\r\n    const closing = opening - principalPortion;\r\n    totalInterest += interest;\r\n    schedule.push({\r\n      month: m,\r\n      openingBalance: opening,\r\n      interestPortion: interest,\r\n      principalPortion,\r\n      installment: interest + principalPortion,\r\n      closingBalance: closing < 1 ? 0 : closing\r\n    });\r\n    balance = closing;\r\n  }\r\n  const totalPayableAdj = principal + totalInterest;\r\n  return { monthlyInstallment, totalInterest, totalPayable: totalPayableAdj, monthlyRate: rate, schedule };\r\n}\r\n"],"names":["LOAN_PRODUCTS","name","maxTenureMonths","rateStructure","minAmount","maxAmount","monthlyRate","Number","MAX_SAFE_INTEGER","getMaxTenure","loanType","getLoanProducts","Object","entries","map","_ref","key","product","maxTenure","computeLocalLoanEstimate","_ref2","principal","tenureMonths","Error","amountValidation","amount","valid","message","validateLoanAmount","concat","rate","applicableRate","find","tier","getMonthlyRate","totalPayable","Math","round","monthlyInstallment","schedule","balance","totalInterest","m","opening","interest","principalPortion","closing","push","month","openingBalance","interestPortion","installment","closingBalance"],"sourceRoot":""}