"use strict";(self.webpackChunkaltus_loan_application_portal=self.webpackChunkaltus_loan_application_portal||[]).push([[339],{3339:(e,t,r)=>{r.d(t,{DocumentsStep:()=>ie});var o=r(9379),n=r(5043),a=r(3969),i=r(5895),s=r(6803),l=r(2097),c=r(298),d=r(45),p=r(7528),u=r(8387),m=r(1807),f=r(2432),y=r(3290),g=r(8128),b=r(1612),v=r(4412),h=r(8301),x=r(7194),A=r(9857),w=r(6061);function C(e){return(0,w.Ay)("MuiLinearProgress",e)}(0,A.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var j=r(579);const N=["className","color","value","valueBuffer","variant"];var k,R,S,z,D,I;const P=(0,y.i7)(k||(k=(0,p.A)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"]))),F="string"!==typeof P?(0,y.AH)(R||(R=(0,p.A)(["\n        animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n      "])),P):null,M=(0,y.i7)(S||(S=(0,p.A)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"]))),B="string"!==typeof M?(0,y.AH)(z||(z=(0,p.A)(["\n        animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n      "])),M):null,O=(0,y.i7)(D||(D=(0,p.A)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"]))),E="string"!==typeof O?(0,y.AH)(I||(I=(0,p.A)(["\n        animation: "," 3s infinite linear;\n      "])),O):null,L=(e,t)=>e.vars?e.vars.palette.LinearProgress["".concat(t,"Bg")]:"light"===e.palette.mode?e.lighten(e.palette[t].main,.62):e.darken(e.palette[t].main,.5),U=(0,g.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["color".concat((0,x.A)(r.color))],t[r.variant]]}})((0,b.A)(e=>{let{theme:t}=e;return{position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(t.palette).filter((0,v.A)()).map(e=>{let[r]=e;return{props:{color:r},style:{backgroundColor:L(t,r)}}}),{props:e=>{let{ownerState:t}=e;return"inherit"===t.color&&"buffer"!==t.variant},style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}})),T=(0,g.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.dashed,t["dashedColor".concat((0,x.A)(r.color))]]}})((0,b.A)(e=>{let{theme:t}=e;return{position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(t.palette).filter((0,v.A)()).map(e=>{let[r]=e;const o=L(t,r);return{props:{color:r},style:{backgroundImage:"radial-gradient(".concat(o," 0%, ").concat(o," 16%, transparent 42%)")}}})]}}),E||{animation:"".concat(O," 3s infinite linear")}),K=(0,g.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t.bar1,t["barColor".concat((0,x.A)(r.color))],("indeterminate"===r.variant||"query"===r.variant)&&t.bar1Indeterminate,"determinate"===r.variant&&t.bar1Determinate,"buffer"===r.variant&&t.bar1Buffer]}})((0,b.A)(e=>{let{theme:t}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(t.palette).filter((0,v.A)()).map(e=>{let[r]=e;return{props:{color:r},style:{backgroundColor:(t.vars||t).palette[r].main}}}),{props:{variant:"determinate"},style:{transition:"transform .".concat(4,"s linear")}},{props:{variant:"buffer"},style:{zIndex:1,transition:"transform .".concat(4,"s linear")}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:{width:"auto"}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:F||{animation:"".concat(P," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite")}}]}})),W=(0,g.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t.bar2,t["barColor".concat((0,x.A)(r.color))],("indeterminate"===r.variant||"query"===r.variant)&&t.bar2Indeterminate,"buffer"===r.variant&&t.bar2Buffer]}})((0,b.A)(e=>{let{theme:t}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(t.palette).filter((0,v.A)()).map(e=>{let[r]=e;return{props:{color:r},style:{"--LinearProgressBar2-barColor":(t.vars||t).palette[r].main}}}),{props:e=>{let{ownerState:t}=e;return"buffer"!==t.variant&&"inherit"!==t.color},style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:e=>{let{ownerState:t}=e;return"buffer"!==t.variant&&"inherit"===t.color},style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(t.palette).filter((0,v.A)()).map(e=>{let[r]=e;return{props:{color:r,variant:"buffer"},style:{backgroundColor:L(t,r),transition:"transform .".concat(4,"s linear")}}}),{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:{width:"auto"}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:B||{animation:"".concat(M," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite")}}]}})),q=n.forwardRef(function(e,t){const r=(0,h.b)({props:e,name:"MuiLinearProgress"}),{className:n,color:a="primary",value:i,valueBuffer:s,variant:l="indeterminate"}=r,c=(0,d.A)(r,N),p=(0,o.A)((0,o.A)({},r),{},{color:a,variant:l}),y=(e=>{const{classes:t,variant:r,color:o}=e,n={root:["root","color".concat((0,x.A)(o)),r],dashed:["dashed","dashedColor".concat((0,x.A)(o))],bar1:["bar","bar1","barColor".concat((0,x.A)(o)),("indeterminate"===r||"query"===r)&&"bar1Indeterminate","determinate"===r&&"bar1Determinate","buffer"===r&&"bar1Buffer"],bar2:["bar","bar2","buffer"!==r&&"barColor".concat((0,x.A)(o)),"buffer"===r&&"color".concat((0,x.A)(o)),("indeterminate"===r||"query"===r)&&"bar2Indeterminate","buffer"===r&&"bar2Buffer"]};return(0,m.A)(n,C,t)})(p),g=(0,f.I)(),b={},v={bar1:{},bar2:{}};if("determinate"===l||"buffer"===l)if(void 0!==i){b["aria-valuenow"]=Math.round(i),b["aria-valuemin"]=0,b["aria-valuemax"]=100;let e=i-100;g&&(e=-e),v.bar1.transform="translateX(".concat(e,"%)")}else 0;if("buffer"===l)if(void 0!==s){let e=(s||0)-100;g&&(e=-e),v.bar2.transform="translateX(".concat(e,"%)")}else 0;return(0,j.jsxs)(U,(0,o.A)((0,o.A)((0,o.A)({className:(0,u.A)(y.root,n),ownerState:p,role:"progressbar"},b),{},{ref:t},c),{},{children:["buffer"===l?(0,j.jsx)(T,{className:y.dashed,ownerState:p}):null,(0,j.jsx)(K,{className:y.bar1,ownerState:p,style:v.bar1}),"determinate"===l?null:(0,j.jsx)(W,{className:y.bar2,ownerState:p,style:v.bar2})]}))});var _=r(3759),G=r(8065),V=r(2579),H=r(4527);const Y=(0,r(4057).A)((0,j.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile");var Z=r(5362),J=r(3267),X=r(4332),Q=r(5514),$=r(4968);const ee=()=>{var e;const{customer:t,loan:r,setCustomer:a,setLoan:i}=(0,J.l)(),{state:s}=(0,Q.Dy)();return{submitLoanApplication:(0,n.useCallback)(async()=>{var e,n,l,c,d,p,u,m,f,y,g,b,v;console.log("\ud83d\ude80 Starting UAT Loan Application Workflow...");let h=t.customerId||(null===(e=s.currentCustomer)||void 0===e?void 0:e.customerId);if(h)console.log("\u2705 Using existing Customer ID:",h);else{var x,A,w,C,j;console.log("\ud83d\udc64 No CustomerID found - creating new customer first...");const e={firstName:t.firstName||"",lastName:t.lastName||t.firstName||"",nrc:t.nrc||"",nrcIssueDate:t.nrcIssueDate||"",phoneNumber:t.phone||"",emailAddress:t.email||"",dateOfBirth:t.dateOfBirth||"",title:t.title||"",gender:t.gender||"Male",nationality:"Other"===t.nationality?t.otherNationality||"":t.nationality||"Zambian",maritalStatus:t.maritalStatus||"Single",address:{street:t.address||"",city:t.city||"",province:t.province||"",postalCode:t.postalCode||"",country:"Zambia"},preferredBranch:t.preferredBranch,employment:{employerId:t.employerId||"EMP001",employerName:t.employerName||"",employerCode:t.payrollNumber||"",position:t.occupation||"Employee",salary:t.salary||0,employmentDate:t.employmentDate||"",employmentType:t.employmentType||"Permanent"},nextOfKin:{firstName:(null===(x=t.nextOfKin)||void 0===x?void 0:x.firstName)||"",lastName:(null===(A=t.nextOfKin)||void 0===A?void 0:A.lastName)||"",relationship:(null===(w=t.nextOfKin)||void 0===w?void 0:w.relationship)||"",phoneNumber:(null===(C=t.nextOfKin)||void 0===C?void 0:C.phone)||"",address:(null===(j=t.nextOfKin)||void 0===j?void 0:j.address)||""},bankDetails:{bankName:t.bankName||"",accountNumber:t.accountNumber||"",accountType:t.accountType||"",branchCode:t.bankBranch||""}};try{var N;const r=await $.Ay.createRetailCustomer(e);if(h=null===(N=r.outParams)||void 0===N?void 0:N.CustomerID,!h)throw new Error("Customer creation succeeded but no CustomerID returned");console.log("\u2705 Customer created successfully, ID:",h),a((0,o.A)((0,o.A)({},t),{},{customerId:h,apiCustomerData:r}))}catch(z){throw console.error("\u274c Customer creation failed:",z),z}}if(!t.firstName||!t.lastName)throw new Error("Please complete Step 1: Customer Information (fill in your name and basic details) before uploading documents.");if(!t.nrc||!t.phone||!t.email)throw new Error("Please complete Step 1: Customer Information (fill in NRC, phone, and email) before uploading documents.");if(!r.amount||r.amount<=0)throw new Error("Please complete Step 2: Loan Calculator and specify a loan amount before uploading documents.");const k={TypeOfCustomer:"Existing",CustomerId:h,identityNo:t.nrc||"",contactNo:t.phone||"",emailId:t.email||"",primaryAddress:t.address||"",provinceName:t.province||"",districtName:t.city||"",countryName:"Zambia",postalcode:t.postalCode||"",employeeNumber:t.payrollNumber||t.employerId||"",designation:t.occupation||"",employerName:t.employerName||"",employmentType:"Permanent"===t.employmentType?"1":"Contract"===t.employmentType?"2":"1",tenure:r.tenureMonths||12,loanAmount:r.amount,grossIncome:t.salary||0,netIncome:t.salary?.85*t.salary:0,deductions:t.salary?.15*t.salary:0,gender:t.gender||"Male",financialInstitutionName:t.bankName||"",financialInstitutionBranchName:t.bankBranch||"",accountNumber:t.accountNumber||"",accountType:t.accountType||"",referrerName:(null===(n=t.reference)||void 0===n?void 0:n.name)||"",referrerNRC:(null===(l=t.reference)||void 0===l?void 0:l.nrc)||"",referrerContactNo:(null===(c=t.reference)||void 0===c?void 0:c.phone)||"",referrerPhysicalAddress:(null===(d=t.reference)||void 0===d?void 0:d.address)||"",referrerRelationType:(null===(p=t.reference)||void 0===p?void 0:p.relationship)||"",kinName:t.nextOfKin?"".concat(t.nextOfKin.firstName||""," ").concat(t.nextOfKin.lastName||"").trim():"",kinNRC:(null===(u=t.nextOfKin)||void 0===u?void 0:u.nrc)||"",kinRelationship:(null===(m=t.nextOfKin)||void 0===m?void 0:m.relationship)||"",kinMobileNo:(null===(f=t.nextOfKin)||void 0===f?void 0:f.phone)||"",kinAddress:(null===(y=t.nextOfKin)||void 0===y?void 0:y.address)||"",kinProvinceName:(null===(g=t.nextOfKin)||void 0===g?void 0:g.province)||"",kinDistrictName:(null===(b=t.nextOfKin)||void 0===b?void 0:b.city)||"",kinCountryName:"Zambia"};console.log("\ud83d\udccb Submitting loan request...",{customerId:h||"(none - using form data)",identityNo:k.identityNo,loanAmount:k.loanAmount,tenure:k.tenure,hasPersonalDetails:!0,hasAddressDetails:!(!k.primaryAddress||!k.provinceName),hasBankDetails:!(!k.financialInstitutionName||!k.accountNumber),hasNextOfKin:!!k.kinName,hasReference:!!k.referrerName});const R=await $.Ay.submitLoanRequest(k);if(console.log("\ud83d\udccb Full Loan Request Response:",R),console.log("\ud83d\udccb Response Status:",R.executionStatus),console.log("\ud83d\udccb Response Message:",R.executionMessage),console.log("\ud83d\udccb Response outParams:",R.outParams),"Success"!==R.executionStatus||null===(v=R.outParams)||void 0===v||!v.ApplicationNumber)throw console.error("\u274c Loan request failed:",R),console.error("\u274c Error Message:",R.executionMessage),new Error("Loan request failed: ".concat(R.executionMessage||"No ApplicationNumber returned"));const S=R.outParams.ApplicationNumber;return console.log("\u2705 Loan request submitted. ApplicationNumber:",S),i((0,o.A)((0,o.A)({},r),{},{applicationNumber:S})),console.log("\u23f3 Note: Backend requires manual approval before ApplicationNumber becomes active for document uploads"),console.log("\ud83d\udcdd Documents will be stored locally and uploaded automatically after approval"),S},[t,r,s]),uploadDocument:(0,n.useCallback)(async(e,t,r)=>{var o;console.log("\ud83d\udce4 Uploading document...",{applicationNumber:e,documentType:t,fileName:r.name});const n=await $.Ay.uploadLoanDocument(e,t,r);if("Success"!==n.executionStatus||null===(o=n.outParams)||void 0===o||!o.LRDocumentDetailsId)throw new Error("Document upload failed: ".concat(n.executionMessage));return console.log("\u2705 Document uploaded. Document ID:",n.outParams.LRDocumentDetailsId),n.outParams.LRDocumentDetailsId},[]),isCustomerReady:!!(t.customerId||null!==(e=s.currentCustomer)&&void 0!==e&&e.customerId)}},te=["application/pdf","image/png","image/jpeg"];async function re(e){if(!te.includes(e.type))return{ok:!1,error:"Unsupported file type"};if(e.size>5242880)return{ok:!1,error:"File exceeds 5MB size limit"};const t=await async function(e){const t=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e);return{ok:!0,meta:{mimeType:e.type,sizeBytes:e.size,checksum:t}}}const oe=/[A-Z0-9/]{6,12}/i;var ne=r(1389);const ae=[{label:"NRC (Front)",type:"nrc-front",accept:".jpg,.jpeg,.png,.pdf",helper:"Clear photo of NRC front side"},{label:"NRC (Back)",type:"nrc-back",accept:".jpg,.jpeg,.png,.pdf",helper:"Clear photo of NRC back side"},{label:"Payslip (1 of 3)",type:"payslip-1",accept:".jpg,.jpeg,.png,.pdf",helper:"Oldest of the last 3 payslips"},{label:"Payslip (2 of 3)",type:"payslip-2",accept:".jpg,.jpeg,.png,.pdf",helper:"Middle month payslip"},{label:"Payslip (3 of 3)",type:"payslip-3",accept:".jpg,.jpeg,.png,.pdf",helper:"Most recent payslip"},{label:"Application Form/ Pre-Approval Form",type:"reference-letter",accept:".jpg,.jpeg,.png,.pdf",optional:!0,helper:"Pre-approval form from employer or institution"},{label:"Work ID",type:"work-id",accept:".jpg,.jpeg,.png,.pdf",optional:!0},{label:"Selfie / Applicant Photo",type:"selfie",accept:".jpg,.jpeg,.png",optional:!0,helper:"Clear, well-lit photo of the applicant"},{label:"Recent Bank Statement",type:"bank-statement",accept:".pdf",optional:!0}],ie=()=>{var e;const{documents:t,addOrReplaceDocument:d,removeDocument:p,customer:u,loan:m}=(0,J.l)(),{state:f}=(0,Q.Dy)(),{submitLoanApplication:y,uploadDocument:g}=ee();const{push:b}=(0,X.d)(),v=(0,n.useRef)({}),h=(0,n.useRef)(t),x=(0,n.useRef)([]),A=(0,n.useRef)(null),w=(0,n.useRef)(new Map);(0,n.useEffect)(()=>{h.current=t},[t]),(0,n.useEffect)(()=>()=>{x.current.forEach(e=>clearInterval(e)),x.current=[]},[]);const C=(0,n.useCallback)(async e=>{if(e.file)try{var t;d((0,o.A)((0,o.A)({},e),{},{status:"uploading",progress:0}));const l=u.customerId||(null===(t=f.currentCustomer)||void 0===t?void 0:t.customerId);console.log("Debug: Customer ID for upload:",l||"(none - will use form data)"),console.log("Debug: Wizard customer data:",u),console.log("Debug: Altus context customer:",f.currentCustomer);const c={"nrc-front":"SKIP","nrc-back":"SKIP","combined-nrc":"6",payslip:"SKIP","payslip-1":"SKIP","payslip-2":"SKIP","payslip-3":"SKIP","combined-payslips":"18","reference-letter":"29","work-id":"29",selfie:"17","bank-statement":"30"}[e.type]||"6";if("SKIP"===c)return console.log("\u23ed\ufe0f Skipping individual upload for ".concat(e.type," - will be uploaded as merged document")),void d((0,o.A)((0,o.A)({},e),{},{status:"verified",progress:100}));let p=A.current;if(p)console.log("\u267b\ufe0f Reusing existing ApplicationNumber:",p);else{console.log("\ud83d\ude80 Step 1: Submitting loan application for approval...");try{p=await y(),A.current=p,console.log("\u2705 Got ApplicationNumber:",p),console.log("\u23f3 Waiting for backend approval before document upload (storing locally)...")}catch(i){console.error("\u274c Loan submission failed:",i);const e=(null===i||void 0===i?void 0:i.message)||"Loan submission failed";throw b("Loan submission failed: ".concat(e),"error"),i}}console.log("\ud83d\udce4 Step 2: Attempting document upload...");try{const t=await g(p,c,e.file);w.current.delete(e.type),d((0,o.A)((0,o.A)({},e),{},{id:t,status:"uploaded",progress:100})),b("".concat(e.type.replace("-"," ")," uploaded successfully!"),"success")}catch(s){var r,n,a;if(!((null===s||void 0===s||null===(r=s.message)||void 0===r?void 0:r.includes("Application Number does not exists"))||(null===s||void 0===s||null===(n=s.details)||void 0===n||null===(a=n.executionMessage)||void 0===a?void 0:a.includes("Application Number does not exists"))))throw s;{console.log("\u2139\ufe0f Loan application pending approval. Storing document for retry:",e.type);const t=new FileReader;t.onloadend=()=>{const r=t.result;w.current.set(e.type,{doc:e,base64:r,typeCode:c});const o=w.current.size;L(o),console.log("\ud83d\udce6 Stored ".concat(e.type," locally. Total pending: ").concat(o))},t.readAsDataURL(e.file),d((0,o.A)((0,o.A)({},e),{},{status:"uploaded",progress:100,id:"pending-".concat(Date.now())})),b("".concat(e.type.replace("-"," ")," ready. Will upload after loan approval."),"info")}}}catch(l){console.error("Error uploading document:",l);let t="Upload failed";l instanceof Error&&(t=l.message),d((0,o.A)((0,o.A)({},e),{},{status:"error",errorMessage:t})),b("Failed to upload ".concat(e.type.replace("-"," "),". ").concat(t),"error")}},[d,f.currentCustomer,u,y,g,b]),N=(0,n.useCallback)(async(e,n)=>{var a,i,s,l;console.log("Debug: File selection started for type:",n);const c=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!c)return void console.log("Debug: No file selected");console.log("Debug: File selected:",c.name,"Size:",c.size,"Type:",c.type);const p=(null===u||void 0===u?void 0:u.nrc)||"Unknown_NRC",m="string"===typeof p?p.replace(/[^\w]/g,""):String(p).replace(/[^\w]/g,""),f=(e=>{const t=ae.find(t=>t.type===e);return(null===t||void 0===t?void 0:t.label.replace(/[^\w\s-]/g,"").replace(/\s+/g,"_"))||e})(n),y=(e=>{const t=e.lastIndexOf(".");return-1!==t?e.substring(t):""})(c.name),g="".concat(f,"_").concat(m).concat(y),v=new File([c],g,{type:c.type});console.log("Debug: Starting file validation for:",v.name);const A=await re(v);if(console.log("Debug: File validation result:",A),!A.ok)return console.log("Debug: File validation failed:",A.error),b(A.error||"File rejected","error"),void d({file:v,type:n,status:"error",errorMessage:A.error});var w;if(t.find(e=>{var t;return e.checksumSha256&&e.checksumSha256===(null===(t=A.meta)||void 0===t?void 0:t.checksum)&&e.type!==n}))return b("This file appears already uploaded under a different document type.","warning"),void d({file:v,type:n,status:"error",errorMessage:"Duplicate of another document",checksumSha256:null===(w=A.meta)||void 0===w?void 0:w.checksum});const j=v.type.startsWith("image/")?URL.createObjectURL(v):void 0;d({file:v,type:n,status:"verifying",previewUrl:j,mimeType:null===(i=A.meta)||void 0===i?void 0:i.mimeType,sizeBytes:null===(s=A.meta)||void 0===s?void 0:s.sizeBytes,checksumSha256:null===(l=A.meta)||void 0===l?void 0:l.checksum,progress:0});const N=Date.now(),k=Math.min(1.8,Math.max(1,A.meta.sizeBytes/1048576)),R=window.setInterval(async()=>{const t=h.current.find(e=>e.type===n);if(!t)return;const a=Date.now()-N,i=Math.min(95,Math.round(a/(1200*k)*100));if(d((0,o.A)((0,o.A)({},t),{},{progress:i})),i>=95){var s,l,c,p,m;clearInterval(R),x.current=x.current.filter(e=>e!==R);let t=null;try{t=await async function(t){if(!t.type.startsWith("image/")&&"application/pdf"!==t.type)return console.warn("File type not supported for OCR:",t.type),null;if(t.size>10485760)return console.warn("File too large for OCR processing:",t.size),null;if(!t.size||0===t.size)return console.warn("File is empty or unreadable"),null;let o=null;try{const{createWorker:e}=await r.e(938).then(r.t.bind(r,9938,23));o=await e("eng");const n=URL.createObjectURL(t),a=new Image;await new Promise((e,t)=>{a.onload=e,a.onerror=()=>t(new Error("Invalid image file")),a.src=n}),URL.revokeObjectURL(n);const{data:i}=await Promise.race([o.recognize(t),new Promise((e,t)=>setTimeout(()=>t(new Error("OCR timeout")),3e4))]),s=i.text||"",l=s.trim().slice(0,160),c=s.match(oe);return{snippet:l,fullText:s,detectedNrc:c?c[0]:null}}catch(e){return console.warn("OCR failed:",e instanceof Error?e.message:"Unknown error"),null}finally{if(o)try{await o.terminate()}catch(n){console.warn("Failed to terminate OCR worker:",n)}}}(v)}catch(f){console.warn("OCR processing failed for file:",v.name,f)}let o="Basic checks passed";if(null!==(s=t)&&void 0!==s&&s.detectedNrc&&"nrc-front"===n){const e=null===u||void 0===u?void 0:u.nrc;if(e&&e.trim().length>0){const r=e=>e.replace(/[/\s\-]/g,"").toLowerCase().trim(),n=r(t.detectedNrc),a=r(String(e)),i=n===a;o+=i?" | NRC match confirmed":" | NRC mismatch (detected: ".concat(t.detectedNrc,", expected: ").concat(e,")"),console.log("NRC Validation:",{detected:t.detectedNrc,detectedNormalized:n,customer:e,customerNormalized:a,match:i})}else console.log("NRC Validation: Customer NRC not available for comparison, detected:",t.detectedNrc),o+=" | NRC detected: ".concat(t.detectedNrc," (no customer NRC to compare)")}const a={file:v,type:n,status:"verified",previewUrl:j,mimeType:null===(l=A.meta)||void 0===l?void 0:l.mimeType,sizeBytes:null===(c=A.meta)||void 0===c?void 0:c.sizeBytes,checksumSha256:null===(p=A.meta)||void 0===p?void 0:p.checksum,extractedTextSnippet:null===(m=t)||void 0===m?void 0:m.snippet,verificationNotes:o,progress:100};d(a),b("Document verified","success"),setTimeout(()=>C(a),500)}},150);x.current.push(R)},[d,t,b,u,C]),k=(0,n.useCallback)(async()=>{const e=t.find(e=>"payslip-1"===e.type&&"verified"===e.status),r=t.find(e=>"payslip-2"===e.type&&"verified"===e.status),o=t.find(e=>"payslip-3"===e.type&&"verified"===e.status);if(e&&r&&o&&e.file&&r.file&&o.file&&!t.find(e=>"combined-payslips"===e.type))try{b("Merging payslips into single document...","info");const t=(null===u||void 0===u?void 0:u.nrc)||"Unknown_NRC",n=await(async(e,t,r,o)=>{const n=new ne.uE;let a=!1;const i=async(e,t)=>new Promise((r,o)=>{const i=new FileReader;i.onload=async i=>{try{var s;const l=null===(s=i.target)||void 0===s?void 0:s.result;if("application/pdf"===e.type)a&&n.addPage(),n.setFontSize(16),n.text("Payslip ".concat(t),20,30),n.setFontSize(10),n.text("Original file: ".concat(e.name),20,50),n.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,60),n.text("Note: PDF content preserved in original file",20,70),a=!0,r();else if(e.type.startsWith("image/")){a&&n.addPage();const e=new Image;e.onload=()=>{try{const o=document.createElement("canvas"),i=o.getContext("2d");if(!i)throw new Error("Canvas context not available");const s=190,l=270,c=e.width/e.height;let d,p;c>s/l?(d=s,p=s/c):(p=l,d=l*c);const u=1200,m=1200;let f=e.width,y=e.height;if(f>u||y>m){const e=Math.min(u/f,m/y);f=Math.floor(f*e),y=Math.floor(y*e)}o.width=f,o.height=y,i.drawImage(e,0,0,f,y);const g=o.toDataURL("image/jpeg",.7);n.addImage(g,"JPEG",10,10,d,p),n.setFontSize(8),n.text("Payslip ".concat(t),10,p+20),a=!0,r()}catch(i){o(i)}},e.onerror=()=>o(new Error("Failed to load image")),e.src=l}else a&&n.addPage(),n.setFontSize(16),n.text("Payslip ".concat(t),20,30),n.setFontSize(10),n.text("Original file: ".concat(e.name),20,50),n.text("File type: ".concat(e.type),20,60),n.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,70),n.text("Note: Original file content preserved",20,80),a=!0,r()}catch(l){o(l)}},i.onerror=()=>o(new Error("Failed to read file")),e.type.startsWith("image/")?i.readAsDataURL(e):i.readAsArrayBuffer(e)});try{n.setFontSize(20),n.text("Combined Payslips",20,30),n.setFontSize(12),n.text("Client NRC: ".concat(o),20,50),n.text("Generated: ".concat((new Date).toLocaleString()),20,60),n.setFontSize(10),n.text("This document contains three consecutive payslips:",20,80),n.text("1. Oldest payslip",30,90),n.text("2. Middle payslip",30,100),n.text("3. Most recent payslip",30,110),a=!0,await i(e,1),await i(t,2),await i(r,3);const s=n.output("blob"),l=o.replace(/[^\w]/g,"");return new File([s],"Combined_Payslips_".concat(l,".pdf"),{type:"application/pdf"})}catch(s){throw console.error("Error merging payslips:",s),new Error("Failed to merge payslips")}})(e.file,r.file,o.file,String(t)),a={file:n,type:"combined-payslips",status:"verified",mimeType:"application/pdf",sizeBytes:n.size,verificationNotes:"Combined from 3 individual payslips",progress:100};d(a),b("Payslips successfully merged into single document","success"),setTimeout(()=>C(a),500)}catch(n){console.error("Failed to merge payslips:",n),b("Failed to merge payslips - individual files preserved","error")}},[t,u,d,b,C]),R=(0,n.useCallback)(async()=>{const e=t.find(e=>"nrc-front"===e.type&&"verified"===e.status),r=t.find(e=>"nrc-back"===e.type&&"verified"===e.status);if(e&&r&&e.file&&r.file&&!t.find(e=>"combined-nrc"===e.type))try{b("Merging NRC front and back into single document...","info");const t=(null===u||void 0===u?void 0:u.nrc)||"Unknown_NRC",o=await(async(e,t,r)=>{const o=new ne.uE;let n=!1;const a=async(e,t)=>new Promise((r,a)=>{const i=new FileReader;i.onload=async i=>{try{var s;const l=null===(s=i.target)||void 0===s?void 0:s.result;if(e.type.startsWith("image/")){n&&o.addPage();const i=new Image;i.onload=()=>{try{const e=document.createElement("canvas"),a=e.getContext("2d");if(!a)throw new Error("Canvas context not available");const s=190,l=270,c=i.width/i.height;let d,p;c>s/l?(d=s,p=s/c):(p=l,d=l*c);const u=1200,m=1200;let f=i.width,y=i.height;if(f>u||y>m){const e=Math.min(u/f,m/y);f=Math.floor(f*e),y=Math.floor(y*e)}e.width=f,e.height=y,a.drawImage(i,0,0,f,y);const g=e.toDataURL("image/jpeg",.7);o.addImage(g,"JPEG",10,10,d,p),o.setFontSize(10),o.setTextColor(100),o.text("".concat(t),10,p+20),n=!0,r()}catch(e){a(e)}},i.onerror=()=>a(new Error("Failed to load image: ".concat(e.name))),"string"===typeof l?i.src=l:a(new Error("Invalid file data"))}else"application/pdf"===e.type?(n&&o.addPage(),o.setFontSize(16),o.text(t,20,30),o.setFontSize(10),o.text("Original file: ".concat(e.name),20,50),o.text("File size: ".concat(Math.round(e.size/1024)," KB"),20,60),o.text("Note: PDF content preserved in original file",20,70),n=!0,r()):a(new Error("Unsupported file type: ".concat(e.type)))}catch(l){a(l)}},i.onerror=()=>a(new Error("Failed to read file")),i.readAsDataURL(e)});try{await a(e,"NRC Front"),await a(t,"NRC Back");const n=o.output("blob"),i=Date.now(),s="NRC_Combined_".concat(r,"_").concat(i,".pdf");return new File([n],s,{type:"application/pdf"})}catch(i){throw console.error("Error merging NRC images:",i),i}})(e.file,r.file,String(t)),n={file:o,type:"combined-nrc",status:"verified",mimeType:"application/pdf",sizeBytes:o.size,verificationNotes:"Combined NRC front and back",progress:100};d(n),b("NRC documents successfully merged","success"),setTimeout(()=>C(n),500)}catch(o){console.error("Failed to merge NRC documents:",o),b("Failed to merge NRC documents - individual files preserved","error")}},[t,u,d,b,C]);(0,n.useEffect)(()=>{3!==["payslip-1","payslip-2","payslip-3"].filter(e=>t.find(t=>t.type===e&&"verified"===t.status)).length||t.find(e=>"combined-payslips"===e.type)||k()},[t,k]),(0,n.useEffect)(()=>{const e=t.find(e=>"nrc-front"===e.type&&"verified"===e.status),r=t.find(e=>"nrc-back"===e.type&&"verified"===e.status);e&&r&&!t.find(e=>"combined-nrc"===e.type)&&R()},[t,R]);const S=(0,n.useCallback)(e=>t.find(t=>t.type===e),[t]),z=e=>{console.log("Debug: Opening file picker for type:",e);const t=v.current[e];console.log("Debug: File input element:",t),t?(t.click(),console.log("Debug: File picker clicked")):console.error("Debug: File input not found for type:",e)};window.__documentsStepValidate=async()=>{var e;const t=["nrc-front","payslip-1","payslip-2","payslip-3"].filter(e=>!S(e));if(t.length)return b("Please upload all required documents: "+t.join(", "),"error"),!1;["payslip-1","payslip-2","payslip-3"].some(e=>{var t;return"verifying"===(null===(t=S(e))||void 0===t?void 0:t.status)})&&b("\u2713 Payslips are being verified. You can proceed to Review - verification will continue in background.","info");const r=S("nrc-front");return(null===r||void 0===r||null===(e=r.verificationNotes)||void 0===e?void 0:e.includes("mismatch"))&&b("Warning: NRC mismatch detected \u2013 please verify ID number.","warning"),A.current||b("\u2713 Documents saved. You can proceed to Review while waiting for loan approval.","info"),!0};const D=(0,n.useCallback)(async()=>{if(!A.current||0===w.current.size)return void b("No pending documents to retry","info");console.log("\ud83d\udd04 Retrying ".concat(w.current.size," pending document(s)...")),b("Retrying ".concat(w.current.size," pending document(s)..."),"info");const e=Array.from(w.current.entries());for(const[r,{doc:n,typeCode:a}]of e)if(n.file)try{console.log("\ud83d\udd04 Retrying upload for: ".concat(r)),d((0,o.A)((0,o.A)({},n),{},{status:"uploading",progress:50}));const e=await g(A.current,a,n.file);w.current.delete(r),d((0,o.A)((0,o.A)({},n),{},{id:e,status:"uploaded",progress:100})),b("".concat(r.replace("-"," ")," uploaded successfully!"),"success")}catch(t){console.error("Failed to retry ".concat(r,":"),t),d((0,o.A)((0,o.A)({},n),{},{status:"uploaded",progress:100}))}if(0===w.current.size)b("All documents uploaded successfully!","success"),L(0);else{const e=w.current.size;L(e),b("".concat(e," document(s) still pending approval"),"warning")}},[g,d,b]),I=["nrc-front","payslip-1","payslip-2","payslip-3"],P=I.filter(e=>{var t;return"verified"===(null===(t=S(e))||void 0===t?void 0:t.status)}).length,F=(0,n.useMemo)(()=>ae.filter(e=>e.type.startsWith("payslip-")).map(e=>({cfg:e,doc:S(e.type)})),[S]),M=F.filter(e=>{var t;return"verified"===(null===(t=e.doc)||void 0===t?void 0:t.status)}).length,B=S("selfie"),O=(0,n.useMemo)(()=>Math.round(P/I.length*100),[P,I.length]),[E,L]=n.useState(0);n.useEffect(()=>{const e=w.current.size;L(e),console.log("\ud83d\udcca Pending documents count updated: ".concat(e))},[t]);(0,n.useCallback)(()=>{const e=w.current.size;L(e),console.log("\ud83d\udcca Pending documents count: ".concat(e))},[]);return(0,j.jsxs)(a.A,{children:[(0,j.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Supporting Documents"}),E>0&&(0,j.jsxs)(s.A,{severity:"warning",sx:{mb:2,border:"2px solid",borderColor:"warning.main",boxShadow:"0 4px 12px rgba(255, 152, 0, 0.2)"},action:(0,j.jsxs)(l.A,{color:"inherit",size:"small",onClick:D,sx:{whiteSpace:"nowrap",fontWeight:700,bgcolor:"warning.dark",color:"white","&:hover":{bgcolor:"warning.main"}},children:["\ud83d\udd04 Retry Upload (",E,")"]}),children:[(0,j.jsxs)(i.A,{variant:"body2",sx:{fontWeight:700,fontSize:"1rem"},children:["\u23f3 ",E," Document(s) Awaiting Backend Approval"]}),(0,j.jsxs)(i.A,{variant:"caption",sx:{display:"block",mt:.5},children:[(0,j.jsxs)("strong",{children:["Application Number: ",A.current]}),(0,j.jsx)("br",{}),"Your loan application requires manual approval from the Altus system administrator before documents can be uploaded. All documents are saved securely in your browser.",(0,j.jsx)("br",{}),(0,j.jsx)("strong",{children:"What happens next:"}),(0,j.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[(0,j.jsxs)("li",{children:["Administrator reviews your loan application (",A.current,")"]}),(0,j.jsx)("li",{children:'Once approved, click "Retry Upload" to upload all pending documents'}),(0,j.jsx)("li",{children:"You can close this page and return later - your documents are saved locally"})]}),(0,j.jsx)("em",{children:"Approval typically takes 5-15 minutes during business hours."})]})]}),A.current&&0===E&&(0,j.jsxs)(s.A,{severity:"info",sx:{mb:2},children:[(0,j.jsxs)(i.A,{variant:"body2",sx:{fontWeight:600},children:["\ud83d\udccb Loan Application: ",A.current]}),(0,j.jsxs)(i.A,{variant:"caption",sx:{display:"block",mt:.5},children:[(0,j.jsx)("strong",{children:"Status:"})," Pending backend approval by Altus administrator.",(0,j.jsx)("br",{}),"Continue uploading documents - they will be stored locally and uploaded automatically after approval."]})]}),!(null!==(e=f.currentCustomer)&&void 0!==e&&e.customerId)&&!(null!==u&&void 0!==u&&u.customerId)&&(0,j.jsxs)(s.A,{severity:"success",sx:{mb:2},children:[(0,j.jsx)(i.A,{variant:"body2",sx:{fontWeight:600,mb:.5},children:"\u26a1 Fast Track Mode Active"}),(0,j.jsx)(i.A,{variant:"caption",sx:{display:"block"},children:"Skip creating a customer account - just fill the form in Step 1 and Step 2, then upload documents here. Your loan application will be created automatically using your form data."})]}),(0,j.jsx)(a.A,{sx:{mb:2,p:2,border:"1px solid",borderColor:"divider",borderRadius:2,background:100===O?"linear-gradient(90deg,#093B18,#2E7D32)":"linear-gradient(90deg,#132F52,#063970)",color:"#fff"},children:(0,j.jsxs)(c.A,{direction:{xs:"column",sm:"row"},spacing:1.5,alignItems:{xs:"flex-start",sm:"center"},children:[(0,j.jsxs)(i.A,{variant:"subtitle2",sx:{fontWeight:600},children:["Required Docs: ",P,"/",I.length," verified"]}),(0,j.jsx)(a.A,{sx:{flex:1,width:"100%",maxWidth:260},children:(0,j.jsx)(q,{variant:"determinate",value:O,sx:{height:8,borderRadius:4,background:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{background:"#fff"}}})}),(0,j.jsxs)(i.A,{variant:"caption",sx:{opacity:.9},children:[O,"%"]})]})}),(0,j.jsx)(i.A,{variant:"body2",sx:{mb:2},children:"Upload the required documents. You can replace a file by selecting it again."}),(0,j.jsxs)(c.A,{spacing:3,children:[ae.filter(e=>!e.type.startsWith("payslip-")).map(e=>{var t,r,o;const n=S(e.type),s="selfie"===e.type,d="nrc-front"===e.type&&(null===n||void 0===n||null===(t=n.verificationNotes)||void 0===t?void 0:t.includes("mismatch"));return(0,j.jsxs)(a.A,{sx:{p:2,border:"1px dashed",borderColor:d?"error.light":"divider",borderRadius:2,position:"relative"},children:[d&&(0,j.jsx)(_.A,{size:"small",color:"error",label:"NRC Mismatch",sx:{position:"absolute",top:8,right:8}}),(0,j.jsxs)(c.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,j.jsxs)(a.A,{sx:{flex:1},children:[(0,j.jsx)(i.A,{variant:"subtitle2",children:e.label}),e.helper&&(0,j.jsx)(i.A,{variant:"caption",sx:{display:"block",color:"text.secondary",mt:.25},children:e.helper}),e.optional&&!n&&(0,j.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:"Optional"}),n?(0,j.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:1,flexWrap:"wrap"},children:[(0,j.jsx)(_.A,{size:"small",color:"verified"===n.status?"success":"error"===n.status?"error":"verifying"===n.status?"warning":"default",label:(null===(r=n.file)||void 0===r?void 0:r.name)||(null===(o=n.checksumSha256)||void 0===o?void 0:o.slice(0,8))||"Document"}),n.previewUrl&&n.file&&(0,j.jsx)("img",{src:n.previewUrl,alt:e.label+" preview",style:{width:s?60:48,height:s?60:48,objectFit:"cover",borderRadius:s?"50%":6,border:s?"2px solid #1976d2":"1px solid rgba(0,0,0,0.15)"}}),(0,j.jsx)(se,{status:n.status}),n.sizeBytes&&(0,j.jsx)(G.A,{title:"~".concat(Math.round(n.sizeBytes/1024)," KB"),children:(0,j.jsx)(_.A,{size:"small",variant:"outlined",label:Math.round(n.sizeBytes/1024)+" KB"})}),"number"===typeof n.progress&&"verified"!==n.status&&(0,j.jsx)(a.A,{sx:{width:140,ml:1},children:(0,j.jsx)(q,{variant:"determinate",value:n.progress,sx:{height:6,borderRadius:3}})}),n.verificationNotes&&"verified"===n.status&&"nrc-front"===e.type&&(0,j.jsx)(G.A,{title:n.verificationNotes,children:(0,j.jsx)(_.A,{size:"small",variant:"outlined",label:n.verificationNotes.includes("mismatch")?"Mismatch":"Match",color:n.verificationNotes.includes("mismatch")?"error":"success"})})]}):(0,j.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:"No file selected"})]}),(0,j.jsx)("input",{type:"file",ref:t=>v.current[e.type]=t,accept:e.accept,style:{display:"none"},onChange:t=>N(t,e.type)}),(0,j.jsx)(l.A,{variant:"outlined",startIcon:(0,j.jsx)(Y,{}),onClick:()=>z(e.type),children:n?"Replace":"Select"}),n&&(0,j.jsx)(V.A,{color:"error",onClick:()=>p(e.type),"aria-label":"Remove ".concat(e.label),children:(0,j.jsx)(Z.A,{})})]})]},e.type)}),(0,j.jsxs)(a.A,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[(0,j.jsxs)(c.A,{direction:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},spacing:2,sx:{mb:1},children:[(0,j.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:600},children:"Payslips (3)"}),(0,j.jsx)(a.A,{sx:{flex:1,width:"100%",maxWidth:240},children:(0,j.jsx)(q,{variant:"determinate",value:M/3*100,sx:{height:6,borderRadius:3}})}),(0,j.jsxs)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:[M,"/3 verified"]})]}),(0,j.jsx)(H.A,{sx:{mb:1}}),(0,j.jsx)(c.A,{spacing:2,children:F.map(e=>{var t,r;let{cfg:o,doc:n}=e;return(0,j.jsx)(a.A,{sx:{p:1.5,border:"1px dashed",borderColor:"divider",borderRadius:2},children:(0,j.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,j.jsxs)(a.A,{sx:{flex:1},children:[(0,j.jsx)(i.A,{variant:"body2",sx:{fontWeight:500},children:o.label}),o.helper&&(0,j.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:o.helper}),n?(0,j.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:.75,flexWrap:"wrap"},children:[(0,j.jsx)(_.A,{size:"small",color:"verified"===n.status?"success":"error"===n.status?"error":"verifying"===n.status?"warning":"default",label:(null===(t=n.file)||void 0===t?void 0:t.name)||(null===(r=n.checksumSha256)||void 0===r?void 0:r.slice(0,8))||"Payslip"}),n.previewUrl&&n.file&&(0,j.jsx)("img",{src:n.previewUrl,alt:o.label+" preview",style:{width:42,height:42,objectFit:"cover",borderRadius:4}}),(0,j.jsx)(se,{status:n.status}),"number"===typeof n.progress&&"verified"!==n.status&&(0,j.jsx)(a.A,{sx:{width:120},children:(0,j.jsx)(q,{variant:"determinate",value:n.progress,sx:{height:5,borderRadius:3}})})]}):(0,j.jsx)(i.A,{variant:"caption",sx:{color:"text.secondary"},children:"No file selected"})]}),(0,j.jsx)("input",{type:"file",ref:e=>v.current[o.type]=e,accept:o.accept,style:{display:"none"},onChange:e=>N(e,o.type)}),(0,j.jsx)(l.A,{size:"small",variant:"outlined",startIcon:(0,j.jsx)(Y,{}),onClick:()=>z(o.type),children:n?"Replace":"Select"}),n&&(0,j.jsx)(V.A,{size:"small",color:"error",onClick:()=>p(o.type),"aria-label":"Remove ".concat(o.label),children:(0,j.jsx)(Z.A,{fontSize:"small"})})]})},o.type)})})]}),t.find(e=>"combined-nrc"===e.type)&&(0,j.jsxs)(a.A,{sx:{p:2,border:"2px solid",borderColor:"primary.light",borderRadius:2,background:"linear-gradient(90deg,#0d47a1,#1976d2)",color:"#fff",mb:2},children:[(0,j.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"\ud83e\udeaa Combined NRC Document"}),(e=>{const r=t.find(e=>"combined-nrc"===e.type);return r?(0,j.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,j.jsxs)(a.A,{sx:{flex:1},children:[(0,j.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,j.jsx)(_.A,{size:"small",color:"primary",label:(null===(e=r.file)||void 0===e?void 0:e.name)||"NRC_Combined.pdf",sx:{background:"rgba(255,255,255,0.9)",color:"#0d47a1"}}),(0,j.jsx)(_.A,{size:"small",variant:"outlined",label:"MERGED",sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}}),r.sizeBytes&&(0,j.jsx)(_.A,{size:"small",variant:"outlined",label:"".concat(Math.round(r.sizeBytes/1024)," KB"),sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}})]}),(0,j.jsx)(i.A,{variant:"caption",sx:{display:"block",mt:.5,opacity:.9},children:"NRC front and back have been automatically combined into a single PDF document"})]}),(0,j.jsx)(V.A,{size:"small",sx:{color:"#fff"},onClick:()=>p("combined-nrc"),"aria-label":"Remove combined NRC",children:(0,j.jsx)(Z.A,{fontSize:"small"})})]}):null})()]}),t.find(e=>"combined-payslips"===e.type)&&(0,j.jsxs)(a.A,{sx:{p:2,border:"2px solid",borderColor:"success.light",borderRadius:2,background:"linear-gradient(90deg,#1b5e20,#2e7d32)",color:"#fff"},children:[(0,j.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"\ud83d\udcc4 Combined Payslips Document"}),(e=>{const r=t.find(e=>"combined-payslips"===e.type);return r?(0,j.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,j.jsxs)(a.A,{sx:{flex:1},children:[(0,j.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,j.jsx)(_.A,{size:"small",color:"success",label:(null===(e=r.file)||void 0===e?void 0:e.name)||"Combined_Payslips.pdf",sx:{background:"rgba(255,255,255,0.9)",color:"#1b5e20"}}),(0,j.jsx)(_.A,{size:"small",variant:"outlined",label:"MERGED",sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}}),r.sizeBytes&&(0,j.jsx)(_.A,{size:"small",variant:"outlined",label:"".concat(Math.round(r.sizeBytes/1024)," KB"),sx:{borderColor:"rgba(255,255,255,0.5)",color:"#fff"}})]}),(0,j.jsx)(i.A,{variant:"caption",sx:{display:"block",mt:.5,opacity:.9},children:"All three payslips have been automatically combined into a single PDF document"})]}),(0,j.jsx)(V.A,{size:"small",sx:{color:"#fff"},onClick:()=>p("combined-payslips"),"aria-label":"Remove combined payslips",children:(0,j.jsx)(Z.A,{fontSize:"small"})})]}):null})()]})]}),(0,j.jsxs)(i.A,{variant:"caption",sx:{mt:3,display:"block",color:"text.secondary"},children:["Files are stored locally until you submit. Verification here is preliminary.",B?"":" (Adding a selfie can speed up identity confirmation.)"]})]})},se=e=>{let{status:t}=e;if(!t)return null;const r={pending:{color:"default",label:"PENDING"},uploading:{color:"warning",label:"UPLOADING"},uploaded:{color:"default",label:"UPLOADED"},verifying:{color:"warning",label:"VERIFYING"},verified:{color:"success",label:"VERIFIED"},error:{color:"error",label:"ERROR"}}[t];return(0,j.jsx)(_.A,{size:"small",variant:"outlined",color:r.color,label:r.label})}}}]);
//# sourceMappingURL=339.da394c14.chunk.js.map