{"version":3,"file":"static/js/339.da394c14.chunk.js","mappings":"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","sources":["../node_modules/@mui/material/esm/LinearProgress/linearProgressClasses.js","../node_modules/@mui/material/esm/LinearProgress/LinearProgress.js","../node_modules/@mui/icons-material/esm/UploadFile.js","hooks/useUATWorkflow.ts","utils/docValidation.ts","utils/payslipMerger.ts","components/wizard/steps/DocumentsStep.tsx","utils/nrcMerger.ts"],"sourcesContent":["import generateUtilityClasses from '@mui/utils/generateUtilityClasses';\nimport generateUtilityClass from '@mui/utils/generateUtilityClass';\nexport function getLinearProgressUtilityClass(slot) {\n  return generateUtilityClass('MuiLinearProgress', slot);\n}\nconst linearProgressClasses = generateUtilityClasses('MuiLinearProgress', ['root', 'colorPrimary', 'colorSecondary', 'determinate', 'indeterminate', 'buffer', 'query', 'dashed', 'dashedColorPrimary', 'dashedColorSecondary', 'bar', 'bar1', 'bar2', 'barColorPrimary', 'barColorSecondary', 'bar1Indeterminate', 'bar1Determinate', 'bar1Buffer', 'bar2Indeterminate', 'bar2Buffer']);\nexport default linearProgressClasses;","'use client';\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport composeClasses from '@mui/utils/composeClasses';\nimport { useRtl } from '@mui/system/RtlProvider';\nimport { keyframes, css, styled } from \"../zero-styled/index.js\";\nimport memoTheme from \"../utils/memoTheme.js\";\nimport createSimplePaletteValueFilter from \"../utils/createSimplePaletteValueFilter.js\";\nimport { useDefaultProps } from \"../DefaultPropsProvider/index.js\";\nimport capitalize from \"../utils/capitalize.js\";\nimport { getLinearProgressUtilityClass } from \"./linearProgressClasses.js\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst TRANSITION_DURATION = 4; // seconds\nconst indeterminate1Keyframe = keyframes`\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n`;\n\n// This implementation is for supporting both Styled-components v4+ and Pigment CSS.\n// A global animation has to be created here for Styled-components v4+ (https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#12).\n// which can be done by checking typeof indeterminate1Keyframe !== 'string' (at runtime, Pigment CSS transform keyframes`` to a string).\nconst indeterminate1Animation = typeof indeterminate1Keyframe !== 'string' ? css`\n        animation: ${indeterminate1Keyframe} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n      ` : null;\nconst indeterminate2Keyframe = keyframes`\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n`;\nconst indeterminate2Animation = typeof indeterminate2Keyframe !== 'string' ? css`\n        animation: ${indeterminate2Keyframe} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n      ` : null;\nconst bufferKeyframe = keyframes`\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n`;\nconst bufferAnimation = typeof bufferKeyframe !== 'string' ? css`\n        animation: ${bufferKeyframe} 3s infinite linear;\n      ` : null;\nconst useUtilityClasses = ownerState => {\n  const {\n    classes,\n    variant,\n    color\n  } = ownerState;\n  const slots = {\n    root: ['root', `color${capitalize(color)}`, variant],\n    dashed: ['dashed', `dashedColor${capitalize(color)}`],\n    bar1: ['bar', 'bar1', `barColor${capitalize(color)}`, (variant === 'indeterminate' || variant === 'query') && 'bar1Indeterminate', variant === 'determinate' && 'bar1Determinate', variant === 'buffer' && 'bar1Buffer'],\n    bar2: ['bar', 'bar2', variant !== 'buffer' && `barColor${capitalize(color)}`, variant === 'buffer' && `color${capitalize(color)}`, (variant === 'indeterminate' || variant === 'query') && 'bar2Indeterminate', variant === 'buffer' && 'bar2Buffer']\n  };\n  return composeClasses(slots, getLinearProgressUtilityClass, classes);\n};\nconst getColorShade = (theme, color) => {\n  if (theme.vars) {\n    return theme.vars.palette.LinearProgress[`${color}Bg`];\n  }\n  return theme.palette.mode === 'light' ? theme.lighten(theme.palette[color].main, 0.62) : theme.darken(theme.palette[color].main, 0.5);\n};\nconst LinearProgressRoot = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Root',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.root, styles[`color${capitalize(ownerState.color)}`], styles[ownerState.variant]];\n  }\n})(memoTheme(({\n  theme\n}) => ({\n  position: 'relative',\n  overflow: 'hidden',\n  display: 'block',\n  height: 4,\n  // Fix Safari's bug during composition of different paint.\n  zIndex: 0,\n  '@media print': {\n    colorAdjust: 'exact'\n  },\n  variants: [...Object.entries(theme.palette).filter(createSimplePaletteValueFilter()).map(([color]) => ({\n    props: {\n      color\n    },\n    style: {\n      backgroundColor: getColorShade(theme, color)\n    }\n  })), {\n    props: ({\n      ownerState\n    }) => ownerState.color === 'inherit' && ownerState.variant !== 'buffer',\n    style: {\n      '&::before': {\n        content: '\"\"',\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'currentColor',\n        opacity: 0.3\n      }\n    }\n  }, {\n    props: {\n      variant: 'buffer'\n    },\n    style: {\n      backgroundColor: 'transparent'\n    }\n  }, {\n    props: {\n      variant: 'query'\n    },\n    style: {\n      transform: 'rotate(180deg)'\n    }\n  }]\n})));\nconst LinearProgressDashed = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Dashed',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.dashed, styles[`dashedColor${capitalize(ownerState.color)}`]];\n  }\n})(memoTheme(({\n  theme\n}) => ({\n  position: 'absolute',\n  marginTop: 0,\n  height: '100%',\n  width: '100%',\n  backgroundSize: '10px 10px',\n  backgroundPosition: '0 -23px',\n  variants: [{\n    props: {\n      color: 'inherit'\n    },\n    style: {\n      opacity: 0.3,\n      backgroundImage: `radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)`\n    }\n  }, ...Object.entries(theme.palette).filter(createSimplePaletteValueFilter()).map(([color]) => {\n    const backgroundColor = getColorShade(theme, color);\n    return {\n      props: {\n        color\n      },\n      style: {\n        backgroundImage: `radial-gradient(${backgroundColor} 0%, ${backgroundColor} 16%, transparent 42%)`\n      }\n    };\n  })]\n})), bufferAnimation || {\n  // At runtime for Pigment CSS, `bufferAnimation` will be null and the generated keyframe will be used.\n  animation: `${bufferKeyframe} 3s infinite linear`\n});\nconst LinearProgressBar1 = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Bar1',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.bar, styles.bar1, styles[`barColor${capitalize(ownerState.color)}`], (ownerState.variant === 'indeterminate' || ownerState.variant === 'query') && styles.bar1Indeterminate, ownerState.variant === 'determinate' && styles.bar1Determinate, ownerState.variant === 'buffer' && styles.bar1Buffer];\n  }\n})(memoTheme(({\n  theme\n}) => ({\n  width: '100%',\n  position: 'absolute',\n  left: 0,\n  bottom: 0,\n  top: 0,\n  transition: 'transform 0.2s linear',\n  transformOrigin: 'left',\n  variants: [{\n    props: {\n      color: 'inherit'\n    },\n    style: {\n      backgroundColor: 'currentColor'\n    }\n  }, ...Object.entries(theme.palette).filter(createSimplePaletteValueFilter()).map(([color]) => ({\n    props: {\n      color\n    },\n    style: {\n      backgroundColor: (theme.vars || theme).palette[color].main\n    }\n  })), {\n    props: {\n      variant: 'determinate'\n    },\n    style: {\n      transition: `transform .${TRANSITION_DURATION}s linear`\n    }\n  }, {\n    props: {\n      variant: 'buffer'\n    },\n    style: {\n      zIndex: 1,\n      transition: `transform .${TRANSITION_DURATION}s linear`\n    }\n  }, {\n    props: ({\n      ownerState\n    }) => ownerState.variant === 'indeterminate' || ownerState.variant === 'query',\n    style: {\n      width: 'auto'\n    }\n  }, {\n    props: ({\n      ownerState\n    }) => ownerState.variant === 'indeterminate' || ownerState.variant === 'query',\n    style: indeterminate1Animation || {\n      animation: `${indeterminate1Keyframe} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`\n    }\n  }]\n})));\nconst LinearProgressBar2 = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Bar2',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.bar, styles.bar2, styles[`barColor${capitalize(ownerState.color)}`], (ownerState.variant === 'indeterminate' || ownerState.variant === 'query') && styles.bar2Indeterminate, ownerState.variant === 'buffer' && styles.bar2Buffer];\n  }\n})(memoTheme(({\n  theme\n}) => ({\n  width: '100%',\n  position: 'absolute',\n  left: 0,\n  bottom: 0,\n  top: 0,\n  transition: 'transform 0.2s linear',\n  transformOrigin: 'left',\n  variants: [...Object.entries(theme.palette).filter(createSimplePaletteValueFilter()).map(([color]) => ({\n    props: {\n      color\n    },\n    style: {\n      '--LinearProgressBar2-barColor': (theme.vars || theme).palette[color].main\n    }\n  })), {\n    props: ({\n      ownerState\n    }) => ownerState.variant !== 'buffer' && ownerState.color !== 'inherit',\n    style: {\n      backgroundColor: 'var(--LinearProgressBar2-barColor, currentColor)'\n    }\n  }, {\n    props: ({\n      ownerState\n    }) => ownerState.variant !== 'buffer' && ownerState.color === 'inherit',\n    style: {\n      backgroundColor: 'currentColor'\n    }\n  }, {\n    props: {\n      color: 'inherit'\n    },\n    style: {\n      opacity: 0.3\n    }\n  }, ...Object.entries(theme.palette).filter(createSimplePaletteValueFilter()).map(([color]) => ({\n    props: {\n      color,\n      variant: 'buffer'\n    },\n    style: {\n      backgroundColor: getColorShade(theme, color),\n      transition: `transform .${TRANSITION_DURATION}s linear`\n    }\n  })), {\n    props: ({\n      ownerState\n    }) => ownerState.variant === 'indeterminate' || ownerState.variant === 'query',\n    style: {\n      width: 'auto'\n    }\n  }, {\n    props: ({\n      ownerState\n    }) => ownerState.variant === 'indeterminate' || ownerState.variant === 'query',\n    style: indeterminate2Animation || {\n      animation: `${indeterminate2Keyframe} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`\n    }\n  }]\n})));\n\n/**\n * ## ARIA\n *\n * If the progress bar is describing the loading progress of a particular region of a page,\n * you should use `aria-describedby` to point to the progress bar, and set the `aria-busy`\n * attribute to `true` on that region until it has finished loading.\n */\nconst LinearProgress = /*#__PURE__*/React.forwardRef(function LinearProgress(inProps, ref) {\n  const props = useDefaultProps({\n    props: inProps,\n    name: 'MuiLinearProgress'\n  });\n  const {\n    className,\n    color = 'primary',\n    value,\n    valueBuffer,\n    variant = 'indeterminate',\n    ...other\n  } = props;\n  const ownerState = {\n    ...props,\n    color,\n    variant\n  };\n  const classes = useUtilityClasses(ownerState);\n  const isRtl = useRtl();\n  const rootProps = {};\n  const inlineStyles = {\n    bar1: {},\n    bar2: {}\n  };\n  if (variant === 'determinate' || variant === 'buffer') {\n    if (value !== undefined) {\n      rootProps['aria-valuenow'] = Math.round(value);\n      rootProps['aria-valuemin'] = 0;\n      rootProps['aria-valuemax'] = 100;\n      let transform = value - 100;\n      if (isRtl) {\n        transform = -transform;\n      }\n      inlineStyles.bar1.transform = `translateX(${transform}%)`;\n    } else if (process.env.NODE_ENV !== 'production') {\n      console.error('MUI: You need to provide a value prop ' + 'when using the determinate or buffer variant of LinearProgress .');\n    }\n  }\n  if (variant === 'buffer') {\n    if (valueBuffer !== undefined) {\n      let transform = (valueBuffer || 0) - 100;\n      if (isRtl) {\n        transform = -transform;\n      }\n      inlineStyles.bar2.transform = `translateX(${transform}%)`;\n    } else if (process.env.NODE_ENV !== 'production') {\n      console.error('MUI: You need to provide a valueBuffer prop ' + 'when using the buffer variant of LinearProgress.');\n    }\n  }\n  return /*#__PURE__*/_jsxs(LinearProgressRoot, {\n    className: clsx(classes.root, className),\n    ownerState: ownerState,\n    role: \"progressbar\",\n    ...rootProps,\n    ref: ref,\n    ...other,\n    children: [variant === 'buffer' ? /*#__PURE__*/_jsx(LinearProgressDashed, {\n      className: classes.dashed,\n      ownerState: ownerState\n    }) : null, /*#__PURE__*/_jsx(LinearProgressBar1, {\n      className: classes.bar1,\n      ownerState: ownerState,\n      style: inlineStyles.bar1\n    }), variant === 'determinate' ? null : /*#__PURE__*/_jsx(LinearProgressBar2, {\n      className: classes.bar2,\n      ownerState: ownerState,\n      style: inlineStyles.bar2\n    })]\n  });\n});\nprocess.env.NODE_ENV !== \"production\" ? LinearProgress.propTypes /* remove-proptypes */ = {\n  //  Warning \n  //  These PropTypes are generated from the TypeScript type definitions. \n  //     To update them, edit the d.ts file and run `pnpm proptypes`.     \n  // \n  /**\n   * Override or extend the styles applied to the component.\n   */\n  classes: PropTypes.object,\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n  /**\n   * The color of the component.\n   * It supports both default and custom theme colors, which can be added as shown in the\n   * [palette customization guide](https://mui.com/material-ui/customization/palette/#custom-colors).\n   * @default 'primary'\n   */\n  color: PropTypes /* @typescript-to-proptypes-ignore */.oneOfType([PropTypes.oneOf(['inherit', 'primary', 'secondary']), PropTypes.string]),\n  /**\n   * The system prop that allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object]),\n  /**\n   * The value of the progress indicator for the determinate and buffer variants.\n   * Value between 0 and 100.\n   */\n  value: PropTypes.number,\n  /**\n   * The value for the buffer variant.\n   * Value between 0 and 100.\n   */\n  valueBuffer: PropTypes.number,\n  /**\n   * The variant to use.\n   * Use indeterminate or query when there is no progress value.\n   * @default 'indeterminate'\n   */\n  variant: PropTypes.oneOf(['buffer', 'determinate', 'indeterminate', 'query'])\n} : void 0;\nexport default LinearProgress;","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z\"\n}), 'UploadFile');","/**\r\n * UAT API Workflow Integration\r\n * Handles the proper sequence: Customer  Loan Request  Document Upload\r\n */\r\n\r\nimport { useCallback } from 'react';\r\nimport altusApi from '../api/altusApi';\r\nimport { useWizardData } from '../components/wizard/WizardDataContext';\r\nimport { useAltus } from '../context/AltusContext';\r\n\r\n// UAT API Response Types\r\ninterface UATResponse<T> {\r\n  executionStatus: 'Success' | 'Failure';\r\n  executionMessage: string;\r\n  instanceId: string;\r\n  outParams: T;\r\n  gridParams: any;\r\n  docParams: any;\r\n}\r\n\r\ninterface LoanRequestResponse {\r\n  ApplicationNumber: string;\r\n}\r\n\r\ninterface DocumentUploadResponse {\r\n  LRDocumentDetailsId: string;\r\n}\r\n\r\nexport interface LoanApplicationWorkflow {\r\n  customer: any;\r\n  loanRequest: any;\r\n  applicationNumber?: string;\r\n}\r\n\r\nexport const useUATWorkflow = () => {\r\n  const { customer, loan, setCustomer, setLoan } = useWizardData();\r\n  const { state } = useAltus();\r\n\r\n  const submitLoanApplication = useCallback(async (): Promise<string> => {\r\n    console.log(' Starting UAT Loan Application Workflow...');\r\n\r\n    let customerId = customer.customerId || state.currentCustomer?.customerId;\r\n    \r\n    // For new customers, create customer first\r\n    if (!customerId) {\r\n      console.log(' No CustomerID found - creating new customer first...');\r\n      \r\n      // Prepare customer creation data\r\n      const customerRequest = {\r\n        firstName: customer.firstName || '',\r\n        lastName: customer.lastName || customer.firstName || '', // Use firstName if lastName is empty\r\n        nrc: customer.nrc || '',\r\n        nrcIssueDate: customer.nrcIssueDate || '',\r\n        phoneNumber: customer.phone || '',\r\n        emailAddress: customer.email || '',\r\n        dateOfBirth: customer.dateOfBirth || '',\r\n        title: customer.title || '',\r\n        gender: (customer.gender as \"Male\" | \"Female\") || \"Male\",\r\n        nationality: customer.nationality === 'Other' ? customer.otherNationality || '' : customer.nationality || 'Zambian',\r\n        maritalStatus: customer.maritalStatus || 'Single',\r\n        address: {\r\n          street: customer.address || '',\r\n          city: customer.city || '',\r\n          province: customer.province || '',\r\n          postalCode: customer.postalCode || \"\",\r\n          country: \"Zambia\"\r\n        },\r\n        preferredBranch: customer.preferredBranch,\r\n        employment: {\r\n          employerId: customer.employerId || \"EMP001\",\r\n          employerName: customer.employerName || '',\r\n          employerCode: customer.payrollNumber || '',\r\n          position: customer.occupation || 'Employee',\r\n          salary: customer.salary || 0,\r\n          employmentDate: customer.employmentDate || '',\r\n          employmentType: (customer.employmentType as \"Permanent\" | \"Contract\" | \"Temporary\") || \"Permanent\"\r\n        },\r\n        nextOfKin: {\r\n          firstName: customer.nextOfKin?.firstName || '',\r\n          lastName: customer.nextOfKin?.lastName || '',\r\n          relationship: customer.nextOfKin?.relationship || '',\r\n          phoneNumber: customer.nextOfKin?.phone || '',\r\n          address: customer.nextOfKin?.address || ''\r\n        },\r\n        bankDetails: {\r\n          bankName: customer.bankName || '',\r\n          accountNumber: customer.accountNumber || '',\r\n          accountType: customer.accountType || '',\r\n          branchCode: customer.bankBranch || ''\r\n        }\r\n      };\r\n\r\n      try {\r\n        const createdCustomer = await altusApi.createRetailCustomer(customerRequest);\r\n        customerId = createdCustomer.outParams?.CustomerID;\r\n        \r\n        if (!customerId) {\r\n          throw new Error('Customer creation succeeded but no CustomerID returned');\r\n        }\r\n        \r\n        console.log(' Customer created successfully, ID:', customerId);\r\n        \r\n        // Update wizard data with the CustomerID\r\n        setCustomer({\r\n          ...customer,\r\n          customerId: customerId,\r\n          apiCustomerData: createdCustomer\r\n        });\r\n      } catch (error) {\r\n        console.error(' Customer creation failed:', error);\r\n        throw error;\r\n      }\r\n    } else {\r\n      console.log(' Using existing Customer ID:', customerId);\r\n    }\r\n\r\n    // Validate required customer data from form\r\n    if (!customer.firstName || !customer.lastName) {\r\n      throw new Error('Please complete Step 1: Customer Information (fill in your name and basic details) before uploading documents.');\r\n    }\r\n\r\n    if (!customer.nrc || !customer.phone || !customer.email) {\r\n      throw new Error('Please complete Step 1: Customer Information (fill in NRC, phone, and email) before uploading documents.');\r\n    }\r\n\r\n    // Validate loan amount is provided\r\n    if (!loan.amount || loan.amount <= 0) {\r\n      throw new Error('Please complete Step 2: Loan Calculator and specify a loan amount before uploading documents.');\r\n    }\r\n\r\n    // Step 2: Submit loan request to get ApplicationNumber\r\n    // Customer already created, so use TypeOfCustomer \"Existing\"\r\n    const loanRequestData = {\r\n      TypeOfCustomer: \"Existing\",\r\n      CustomerId: customerId,\r\n      \r\n      // Identity and contact details (required even for existing customers)\r\n      identityNo: customer.nrc || \"\",\r\n      contactNo: customer.phone || \"\",\r\n      emailId: customer.email || \"\",\r\n      \r\n      // Address Information\r\n      primaryAddress: customer.address || \"\",\r\n      provinceName: customer.province || \"\",\r\n      districtName: customer.city || \"\",\r\n      countryName: \"Zambia\",\r\n      postalcode: customer.postalCode || \"\",\r\n      \r\n      // Employment details\r\n      employeeNumber: customer.payrollNumber || customer.employerId || \"\",\r\n      designation: customer.occupation || \"\",\r\n      employerName: customer.employerName || \"\",\r\n      employmentType: customer.employmentType === \"Permanent\" ? \"1\" : customer.employmentType === \"Contract\" ? \"2\" : \"1\",\r\n      \r\n      // Loan details\r\n      tenure: loan.tenureMonths || 12,\r\n      loanAmount: loan.amount,\r\n      grossIncome: customer.salary || 0,\r\n      netIncome: customer.salary ? customer.salary * 0.85 : 0,\r\n      deductions: customer.salary ? customer.salary * 0.15 : 0,\r\n      gender: customer.gender || 'Male',\r\n      \r\n      // Bank Details\r\n      financialInstitutionName: customer.bankName || \"\",\r\n      financialInstitutionBranchName: customer.bankBranch || \"\",\r\n      accountNumber: customer.accountNumber || \"\",\r\n      accountType: customer.accountType || \"\",\r\n      \r\n      // Reference/Referrer Details\r\n      referrerName: customer.reference?.name || \"\",\r\n      referrerNRC: customer.reference?.nrc || \"\",\r\n      referrerContactNo: customer.reference?.phone || \"\",\r\n      referrerPhysicalAddress: customer.reference?.address || \"\",\r\n      referrerRelationType: customer.reference?.relationship || \"\",\r\n      \r\n      // Next of Kin Details\r\n      kinName: customer.nextOfKin ? `${customer.nextOfKin.firstName || ''} ${customer.nextOfKin.lastName || ''}`.trim() : \"\",\r\n      kinNRC: customer.nextOfKin?.nrc || \"\",\r\n      kinRelationship: customer.nextOfKin?.relationship || \"\",\r\n      kinMobileNo: customer.nextOfKin?.phone || \"\",\r\n      kinAddress: customer.nextOfKin?.address || \"\",\r\n      kinProvinceName: customer.nextOfKin?.province || \"\",\r\n      kinDistrictName: customer.nextOfKin?.city || \"\",\r\n      kinCountryName: \"Zambia\"\r\n    };\r\n\r\n    console.log(' Submitting loan request...', {\r\n      customerId: customerId || '(none - using form data)',\r\n      identityNo: loanRequestData.identityNo,\r\n      loanAmount: loanRequestData.loanAmount,\r\n      tenure: loanRequestData.tenure,\r\n      hasPersonalDetails: true,\r\n      hasAddressDetails: !!(loanRequestData.primaryAddress && loanRequestData.provinceName),\r\n      hasBankDetails: !!(loanRequestData.financialInstitutionName && loanRequestData.accountNumber),\r\n      hasNextOfKin: !!loanRequestData.kinName,\r\n      hasReference: !!loanRequestData.referrerName\r\n    });\r\n    const loanResult = await altusApi.submitLoanRequest(loanRequestData) as UATResponse<LoanRequestResponse>;\r\n    \r\n    console.log(' Full Loan Request Response:', loanResult);\r\n    console.log(' Response Status:', loanResult.executionStatus);\r\n    console.log(' Response Message:', loanResult.executionMessage);\r\n    console.log(' Response outParams:', loanResult.outParams);\r\n    \r\n    if (loanResult.executionStatus !== 'Success' || !loanResult.outParams?.ApplicationNumber) {\r\n      console.error(' Loan request failed:', loanResult);\r\n      console.error(' Error Message:', loanResult.executionMessage);\r\n      throw new Error(`Loan request failed: ${loanResult.executionMessage || 'No ApplicationNumber returned'}`);\r\n    }\r\n\r\n    const applicationNumber = loanResult.outParams.ApplicationNumber;\r\n    console.log(' Loan request submitted. ApplicationNumber:', applicationNumber);\r\n    \r\n    // Update wizard data with the ApplicationNumber\r\n    setLoan({\r\n      ...loan,\r\n      applicationNumber: applicationNumber\r\n    });\r\n    \r\n    console.log(' Note: Backend requires manual approval before ApplicationNumber becomes active for document uploads');\r\n    console.log(' Documents will be stored locally and uploaded automatically after approval');\r\n\r\n    return applicationNumber;\r\n  }, [customer, loan, state]);\r\n\r\n  const uploadDocument = useCallback(async (\r\n    applicationNumber: string, \r\n    documentType: string, \r\n    file: File\r\n  ): Promise<string> => {\r\n    console.log(' Uploading document...', { applicationNumber, documentType, fileName: file.name });\r\n    \r\n    const result = await altusApi.uploadLoanDocument(applicationNumber, documentType, file) as UATResponse<DocumentUploadResponse>;\r\n    \r\n    if (result.executionStatus !== 'Success' || !result.outParams?.LRDocumentDetailsId) {\r\n      throw new Error(`Document upload failed: ${result.executionMessage}`);\r\n    }\r\n\r\n    console.log(' Document uploaded. Document ID:', result.outParams.LRDocumentDetailsId);\r\n    return result.outParams.LRDocumentDetailsId;\r\n  }, []);\r\n\r\n  return {\r\n    submitLoanApplication,\r\n    uploadDocument,\r\n    isCustomerReady: !!(customer.customerId || state.currentCustomer?.customerId)\r\n  };\r\n};\r\n\r\nexport default useUATWorkflow;","// Document pre-validation & hashing utilities\r\n// These are client-side safeguards; server-side validation should re-check everything.\r\n\r\nexport const ALLOWED_MIME = ['application/pdf', 'image/png', 'image/jpeg'];\r\nexport const MAX_BYTES = 5 * 1024 * 1024; // 5MB limit (adjust as needed)\r\n\r\nexport interface PreCheckMeta {\r\n  mimeType: string;\r\n  sizeBytes: number;\r\n  checksum: string;\r\n}\r\n\r\nexport interface PreCheckResult {\r\n  ok: boolean;\r\n  error?: string;\r\n  meta?: PreCheckMeta;\r\n}\r\n\r\nexport async function computeSha256(file: File): Promise<string> {\r\n  const buf = await file.arrayBuffer();\r\n  const digest = await crypto.subtle.digest('SHA-256', buf);\r\n  return Array.from(new Uint8Array(digest)).map(b => b.toString(16).padStart(2,'0')).join('');\r\n}\r\n\r\nexport async function preValidateFile(file: File): Promise<PreCheckResult> {\r\n  if (!ALLOWED_MIME.includes(file.type)) {\r\n    return { ok: false, error: 'Unsupported file type' };\r\n  }\r\n  if (file.size > MAX_BYTES) {\r\n    return { ok: false, error: 'File exceeds 5MB size limit' };\r\n  }\r\n  const checksum = await computeSha256(file);\r\n  return {\r\n    ok: true,\r\n    meta: { mimeType: file.type, sizeBytes: file.size, checksum }\r\n  };\r\n}\r\n\r\nexport interface OcrResult { snippet: string; fullText?: string; detectedNrc?: string | null; }\r\n\r\n// Simple NRC pattern (adjust as needed)  alphanumeric or slash characters 6-12 length.\r\nconst NRC_REGEX = /[A-Z0-9/]{6,12}/i;\r\n\r\nexport async function attemptOcr(file: File): Promise<OcrResult | null> {\r\n  // Check if file is valid for OCR processing\r\n  if (!(file.type.startsWith('image/') || file.type === 'application/pdf')) {\r\n    console.warn('File type not supported for OCR:', file.type);\r\n    return null;\r\n  }\r\n  \r\n  // Check file size (avoid processing very large files)\r\n  if (file.size > 10 * 1024 * 1024) { // 10MB limit\r\n    console.warn('File too large for OCR processing:', file.size);\r\n    return null;\r\n  }\r\n  \r\n  // Check if file is actually readable\r\n  if (!file.size || file.size === 0) {\r\n    console.warn('File is empty or unreadable');\r\n    return null;\r\n  }\r\n  \r\n  let worker = null;\r\n  try {\r\n    const { createWorker } = await import('tesseract.js');\r\n    \r\n    // Create a worker with better error handling\r\n    worker = await createWorker('eng');\r\n    \r\n    // Validate that the file can be read as an image\r\n    const url = URL.createObjectURL(file);\r\n    const img = new Image();\r\n    \r\n    await new Promise((resolve, reject) => {\r\n      img.onload = resolve;\r\n      img.onerror = () => reject(new Error('Invalid image file'));\r\n      img.src = url;\r\n    });\r\n    \r\n    URL.revokeObjectURL(url);\r\n    \r\n    // Perform OCR with timeout\r\n    const { data } = await Promise.race([\r\n      worker.recognize(file),\r\n      new Promise((_, reject) => \r\n        setTimeout(() => reject(new Error('OCR timeout')), 30000) // 30 second timeout\r\n      )\r\n    ]) as any;\r\n    \r\n    const fullText: string = data.text || '';\r\n    const snippet = fullText.trim().slice(0, 160);\r\n    const match = fullText.match(NRC_REGEX);\r\n    \r\n    return { snippet, fullText, detectedNrc: match ? match[0] : null };\r\n  } catch (e) {\r\n    console.warn('OCR failed:', e instanceof Error ? e.message : 'Unknown error');\r\n    return null;\r\n  } finally {\r\n    // Ensure worker is always terminated\r\n    if (worker) {\r\n      try {\r\n        await worker.terminate();\r\n      } catch (terminateError) {\r\n        console.warn('Failed to terminate OCR worker:', terminateError);\r\n      }\r\n    }\r\n  }\r\n}\r\n","// Utility for merging payslip documents into a single PDF\r\nimport { jsPDF } from 'jspdf';\r\n\r\nexport const mergePayslips = async (payslip1: File, payslip2: File, payslip3: File, clientNRC: string): Promise<File> => {\r\n  const pdf = new jsPDF();\r\n  let pageAdded = false;\r\n\r\n  const addFileToPDF = async (file: File, pageNumber: number) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      \r\n      reader.onload = async (e) => {\r\n        try {\r\n          const result = e.target?.result;\r\n          \r\n          if (file.type === 'application/pdf') {\r\n            // For PDF files, we'll add a text placeholder since direct PDF merging\r\n            // requires more complex libraries. In production, use pdf-lib or similar.\r\n            if (pageAdded) pdf.addPage();\r\n            pdf.setFontSize(16);\r\n            pdf.text(`Payslip ${pageNumber}`, 20, 30);\r\n            pdf.setFontSize(10);\r\n            pdf.text(`Original file: ${file.name}`, 20, 50);\r\n            pdf.text(`File size: ${Math.round(file.size / 1024)} KB`, 20, 60);\r\n            pdf.text(`Note: PDF content preserved in original file`, 20, 70);\r\n            pageAdded = true;\r\n            resolve();\r\n          } else if (file.type.startsWith('image/')) {\r\n            // For image files, add them directly to the PDF with compression\r\n            if (pageAdded) pdf.addPage();\r\n            \r\n            const img = new Image();\r\n            img.onload = () => {\r\n              try {\r\n                const canvas = document.createElement('canvas');\r\n                const ctx = canvas.getContext('2d');\r\n                if (!ctx) throw new Error('Canvas context not available');\r\n                \r\n                // Calculate dimensions to fit page\r\n                const pageWidth = 190; // A4 width minus margins\r\n                const pageHeight = 270; // A4 height minus margins\r\n                const imgRatio = img.width / img.height;\r\n                const pageRatio = pageWidth / pageHeight;\r\n                \r\n                let pdfWidth, pdfHeight;\r\n                if (imgRatio > pageRatio) {\r\n                  pdfWidth = pageWidth;\r\n                  pdfHeight = pageWidth / imgRatio;\r\n                } else {\r\n                  pdfHeight = pageHeight;\r\n                  pdfWidth = pageHeight * imgRatio;\r\n                }\r\n                \r\n                // Optimize canvas size - use max 1200px width for compression\r\n                const maxWidth = 1200;\r\n                const maxHeight = 1200;\r\n                let canvasWidth = img.width;\r\n                let canvasHeight = img.height;\r\n                \r\n                if (canvasWidth > maxWidth || canvasHeight > maxHeight) {\r\n                  const scale = Math.min(maxWidth / canvasWidth, maxHeight / canvasHeight);\r\n                  canvasWidth = Math.floor(canvasWidth * scale);\r\n                  canvasHeight = Math.floor(canvasHeight * scale);\r\n                }\r\n                \r\n                // Set canvas to optimized size\r\n                canvas.width = canvasWidth;\r\n                canvas.height = canvasHeight;\r\n                \r\n                // Draw scaled image\r\n                ctx.drawImage(img, 0, 0, canvasWidth, canvasHeight);\r\n                \r\n                // Convert to JPEG with compression (0.7 quality)\r\n                const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\r\n                pdf.addImage(dataUrl, 'JPEG', 10, 10, pdfWidth, pdfHeight);\r\n                pdf.setFontSize(8);\r\n                pdf.text(`Payslip ${pageNumber}`, 10, pdfHeight + 20);\r\n                \r\n                pageAdded = true;\r\n                resolve();\r\n              } catch (error) {\r\n                reject(error);\r\n              }\r\n            };\r\n            img.onerror = () => reject(new Error('Failed to load image'));\r\n            img.src = result as string;\r\n          } else {\r\n            // For other file types, add metadata\r\n            if (pageAdded) pdf.addPage();\r\n            pdf.setFontSize(16);\r\n            pdf.text(`Payslip ${pageNumber}`, 20, 30);\r\n            pdf.setFontSize(10);\r\n            pdf.text(`Original file: ${file.name}`, 20, 50);\r\n            pdf.text(`File type: ${file.type}`, 20, 60);\r\n            pdf.text(`File size: ${Math.round(file.size / 1024)} KB`, 20, 70);\r\n            pdf.text(`Note: Original file content preserved`, 20, 80);\r\n            pageAdded = true;\r\n            resolve();\r\n          }\r\n        } catch (error) {\r\n          reject(error);\r\n        }\r\n      };\r\n      \r\n      reader.onerror = () => reject(new Error('Failed to read file'));\r\n      \r\n      if (file.type.startsWith('image/')) {\r\n        reader.readAsDataURL(file);\r\n      } else {\r\n        reader.readAsArrayBuffer(file);\r\n      }\r\n    });\r\n  };\r\n\r\n  try {\r\n    // Add title page\r\n    pdf.setFontSize(20);\r\n    pdf.text('Combined Payslips', 20, 30);\r\n    pdf.setFontSize(12);\r\n    pdf.text(`Client NRC: ${clientNRC}`, 20, 50);\r\n    pdf.text(`Generated: ${new Date().toLocaleString()}`, 20, 60);\r\n    pdf.setFontSize(10);\r\n    pdf.text('This document contains three consecutive payslips:', 20, 80);\r\n    pdf.text('1. Oldest payslip', 30, 90);\r\n    pdf.text('2. Middle payslip', 30, 100);\r\n    pdf.text('3. Most recent payslip', 30, 110);\r\n    pageAdded = true;\r\n\r\n    // Add each payslip\r\n    await addFileToPDF(payslip1, 1);\r\n    await addFileToPDF(payslip2, 2);\r\n    await addFileToPDF(payslip3, 3);\r\n\r\n    // Generate the merged PDF\r\n    const pdfBlob = pdf.output('blob');\r\n    const sanitizedNRC = clientNRC.replace(/[^\\w]/g, '');\r\n    const mergedFile = new File([pdfBlob], `Combined_Payslips_${sanitizedNRC}.pdf`, {\r\n      type: 'application/pdf'\r\n    });\r\n\r\n    return mergedFile;\r\n  } catch (error) {\r\n    console.error('Error merging payslips:', error);\r\n    throw new Error('Failed to merge payslips');\r\n  }\r\n};","import React, { useCallback, useRef, useEffect, useMemo } from 'react';\r\nimport { Box, Typography, Button, Stack, IconButton, Chip, Tooltip, LinearProgress, Divider, Alert } from '@mui/material';\r\nimport UploadFileIcon from '@mui/icons-material/UploadFile';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport { useWizardData, UploadedDoc } from '../WizardDataContext';\r\nimport { useSnackbar } from '../../feedback/SnackbarProvider';\r\nimport { useAltus } from '../../../context/AltusContext';\r\nimport { useUATWorkflow } from '../../../hooks/useUATWorkflow';\r\nimport { preValidateFile, attemptOcr } from '../../../utils/docValidation';\r\nimport { mergePayslips } from '../../../utils/payslipMerger';\r\nimport { mergeNRCImages } from '../../../utils/nrcMerger';\r\n\r\nconst docTypes: { label: string; type: UploadedDoc['type']; accept: string; optional?: boolean; helper?: string; }[] = [\r\n  { label: 'NRC (Front)', type: 'nrc-front', accept: '.jpg,.jpeg,.png,.pdf', helper: 'Clear photo of NRC front side' },\r\n  { label: 'NRC (Back)', type: 'nrc-back', accept: '.jpg,.jpeg,.png,.pdf', helper: 'Clear photo of NRC back side' },\r\n  { label: 'Payslip (1 of 3)', type: 'payslip-1', accept: '.jpg,.jpeg,.png,.pdf', helper: 'Oldest of the last 3 payslips' },\r\n  { label: 'Payslip (2 of 3)', type: 'payslip-2', accept: '.jpg,.jpeg,.png,.pdf', helper: 'Middle month payslip' },\r\n  { label: 'Payslip (3 of 3)', type: 'payslip-3', accept: '.jpg,.jpeg,.png,.pdf', helper: 'Most recent payslip' },\r\n  { label: 'Application Form/ Pre-Approval Form', type: 'reference-letter', accept: '.jpg,.jpeg,.png,.pdf', optional: true, helper: 'Pre-approval form from employer or institution' },\r\n  { label: 'Work ID', type: 'work-id', accept: '.jpg,.jpeg,.png,.pdf', optional: true },\r\n  { label: 'Selfie / Applicant Photo', type: 'selfie', accept: '.jpg,.jpeg,.png', optional: true, helper: 'Clear, well-lit photo of the applicant' },\r\n  { label: 'Recent Bank Statement', type: 'bank-statement', accept: '.pdf', optional: true }\r\n];\r\n\r\nexport const DocumentsStep: React.FC = () => {\r\n  const { documents, addOrReplaceDocument, removeDocument, customer, loan } = useWizardData();\r\n  const { state } = useAltus();\r\n  const { submitLoanApplication, uploadDocument } = useUATWorkflow();\r\n  // Debug to ensure component is loaded and dependencies resolved\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    // eslint-disable-next-line no-console\r\n    console.debug('[DocumentsStep] mount', { docCount: documents.length });\r\n  }\r\n  const { push } = useSnackbar();\r\n  const fileInputs = useRef<Record<string, HTMLInputElement | null>>({});\r\n  const documentsRef = useRef(documents);\r\n  const activeIntervalsRef = useRef<number[]>([]);\r\n  const applicationNumberRef = useRef<string | null>(null); // Store ApplicationNumber to reuse for all documents\r\n  const pendingDocumentsRef = useRef<Map<string, { doc: UploadedDoc, base64: string, typeCode: string }>>(new Map()); // Store pending documents for retry\r\n\r\n  // Keep ref synced with latest documents to avoid stale closure inside intervals\r\n  useEffect(() => { documentsRef.current = documents; }, [documents]);\r\n\r\n  // Cleanup intervals on unmount\r\n  useEffect(() => () => {\r\n    activeIntervalsRef.current.forEach(id => clearInterval(id));\r\n    activeIntervalsRef.current = [];\r\n  }, []);\r\n\r\n  // Function to upload document to API after verification\r\n  const uploadToAPI = useCallback(async (doc: UploadedDoc) => {\r\n    if (!doc.file) return;\r\n    \r\n    try {\r\n      // Mark as uploading\r\n      addOrReplaceDocument({ ...doc, status: 'uploading', progress: 0 });\r\n      \r\n      // Customer ID is now optional - we can proceed directly to loan application\r\n      const customerId = customer.customerId || state.currentCustomer?.customerId;\r\n      console.log('Debug: Customer ID for upload:', customerId || '(none - will use form data)');\r\n      console.log('Debug: Wizard customer data:', customer);\r\n      console.log('Debug: Altus context customer:', state.currentCustomer);\r\n      \r\n      // Map document type to UAT document type codes per API V2 docs\r\n      const documentTypeMap: Record<UploadedDoc['type'], string> = {\r\n        'nrc-front': 'SKIP',      // Will be merged with nrc-back\r\n        'nrc-back': 'SKIP',       // Will be merged with nrc-front\r\n        'combined-nrc': '6',      // NRC ID (Client) - merged front+back\r\n        'payslip': 'SKIP',        // Individual payslips not uploaded\r\n        'payslip-1': 'SKIP',      // Will be merged into combined-payslips\r\n        'payslip-2': 'SKIP',      // Will be merged into combined-payslips\r\n        'payslip-3': 'SKIP',      // Will be merged into combined-payslips\r\n        'combined-payslips': '18', // Payslip (Last 3 months) - merged 3 payslips\r\n        'reference-letter': '29',  // Employment Contract\r\n        'work-id': '29',           // Employment Contract\r\n        'selfie': '17',            // Passport (closest match for photo ID)\r\n        'bank-statement': '30'     // Order Copies (supporting financial docs)\r\n      };\r\n      \r\n      const documentTypeCode = documentTypeMap[doc.type] || '6';\r\n      \r\n      // Skip upload for individual NRC and payslip documents (will be uploaded as merged)\r\n      if (documentTypeCode === 'SKIP') {\r\n        console.log(` Skipping individual upload for ${doc.type} - will be uploaded as merged document`);\r\n        addOrReplaceDocument({ ...doc, status: 'verified', progress: 100 });\r\n        return;\r\n      }\r\n      \r\n      // Step 1: Get or create ApplicationNumber\r\n      // IMPORTANT: Backend requires MANUAL APPROVAL before ApplicationNumber is active\r\n      // Documents are stored locally and will be uploaded after approval\r\n      let applicationNumber = applicationNumberRef.current;\r\n      \r\n      if (!applicationNumber) {\r\n        console.log(' Step 1: Submitting loan application for approval...');\r\n        try {\r\n          applicationNumber = await submitLoanApplication();\r\n          applicationNumberRef.current = applicationNumber; // Store for reuse\r\n          console.log(' Got ApplicationNumber:', applicationNumber);\r\n          console.log(' Waiting for backend approval before document upload (storing locally)...');\r\n        } catch (loanError: any) {\r\n          console.error(' Loan submission failed:', loanError);\r\n          const errorMessage = loanError?.message || 'Loan submission failed';\r\n          push(`Loan submission failed: ${errorMessage}`, 'error');\r\n          throw loanError; // Re-throw to prevent document upload\r\n        }\r\n      } else {\r\n        console.log(' Reusing existing ApplicationNumber:', applicationNumber);\r\n      }\r\n      \r\n      // Step 2: Attempt document upload (will be stored locally if pending approval)\r\n      console.log(' Step 2: Attempting document upload...');\r\n      \r\n      try {\r\n        const response = await uploadDocument(applicationNumber, documentTypeCode, doc.file);\r\n        \r\n        // Upload successful - remove from pending queue if it was there\r\n        pendingDocumentsRef.current.delete(doc.type);\r\n        \r\n        // Update document with API response\r\n        addOrReplaceDocument({ \r\n          ...doc, \r\n          id: response,\r\n          status: 'uploaded', \r\n          progress: 100 \r\n        });\r\n        \r\n        push(`${doc.type.replace('-', ' ')} uploaded successfully!`, 'success');\r\n      } catch (uploadError: any) {\r\n        // Check if error is \"Application Number does not exists\" - this means pending approval\r\n        const isPendingApproval = uploadError?.message?.includes('Application Number does not exists') || \r\n                                   uploadError?.details?.executionMessage?.includes('Application Number does not exists');\r\n        \r\n        if (isPendingApproval) {\r\n          // This is expected - loan is pending approval\r\n          // Store the document data for retry after approval\r\n          console.log(' Loan application pending approval. Storing document for retry:', doc.type);\r\n          \r\n          // Convert file to base64 to store it\r\n          const reader = new FileReader();\r\n          reader.onloadend = () => {\r\n            const base64 = reader.result as string;\r\n            pendingDocumentsRef.current.set(doc.type, { \r\n              doc, \r\n              base64, \r\n              typeCode: documentTypeCode \r\n            });\r\n            \r\n            // Update pending count immediately\r\n            const newCount = pendingDocumentsRef.current.size;\r\n            setPendingCount(newCount);\r\n            console.log(` Stored ${doc.type} locally. Total pending: ${newCount}`);\r\n          };\r\n          reader.readAsDataURL(doc.file);\r\n          \r\n          addOrReplaceDocument({ \r\n            ...doc, \r\n            status: 'uploaded', // Mark as uploaded (pending in queue)\r\n            progress: 100,\r\n            id: `pending-${Date.now()}` // Temporary ID\r\n          });\r\n          \r\n          push(`${doc.type.replace('-', ' ')} ready. Will upload after loan approval.`, 'info');\r\n        } else {\r\n          // Actual upload error - re-throw to outer catch\r\n          throw uploadError;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error uploading document:', error);\r\n      \r\n      // Provide helpful error messages\r\n      let errorMessage = 'Upload failed';\r\n      if (error instanceof Error) {\r\n        errorMessage = error.message;\r\n      }\r\n      \r\n      addOrReplaceDocument({ \r\n        ...doc, \r\n        status: 'error', \r\n        errorMessage \r\n      });\r\n      \r\n      push(`Failed to upload ${doc.type.replace('-', ' ')}. ${errorMessage}`, 'error');\r\n    }\r\n  }, [addOrReplaceDocument, state.currentCustomer, customer, submitLoanApplication, uploadDocument, push]);\r\n\r\n  const onSelect = useCallback(async (e: React.ChangeEvent<HTMLInputElement>, type: UploadedDoc['type']) => {\r\n    console.log('Debug: File selection started for type:', type);\r\n    const file = e.target.files?.[0];\r\n    if (!file) {\r\n      console.log('Debug: No file selected');\r\n      return;\r\n    }\r\n    \r\n    console.log('Debug: File selected:', file.name, 'Size:', file.size, 'Type:', file.type);\r\n    \r\n    // Create renamed file with document name and client's NRC\r\n    const getFileExtension = (filename: string) => {\r\n      const lastDot = filename.lastIndexOf('.');\r\n      return lastDot !== -1 ? filename.substring(lastDot) : '';\r\n    };\r\n    \r\n    const getDocumentDisplayName = (docType: UploadedDoc['type']) => {\r\n      const docConfig = docTypes.find(d => d.type === docType);\r\n      return docConfig?.label.replace(/[^\\w\\s-]/g, '').replace(/\\s+/g, '_') || docType;\r\n    };\r\n    \r\n    const clientNRC = customer?.nrc || 'Unknown_NRC';\r\n    const sanitizedNRC = typeof clientNRC === 'string' ? clientNRC.replace(/[^\\w]/g, '') : String(clientNRC).replace(/[^\\w]/g, '');\r\n    const documentName = getDocumentDisplayName(type);\r\n    const fileExtension = getFileExtension(file.name);\r\n    const newFileName = `${documentName}_${sanitizedNRC}${fileExtension}`;\r\n    \r\n    // Create a new file object with the renamed filename\r\n    const renamedFile = new File([file], newFileName, { type: file.type });\r\n    \r\n    console.log('Debug: Starting file validation for:', renamedFile.name);\r\n    const pre = await preValidateFile(renamedFile);\r\n    console.log('Debug: File validation result:', pre);\r\n    \r\n    if (!pre.ok) {\r\n      console.log('Debug: File validation failed:', pre.error);\r\n      push(pre.error || 'File rejected', 'error');\r\n      addOrReplaceDocument({ file: renamedFile, type, status: 'error', errorMessage: pre.error });\r\n      return;\r\n    }\r\n    const existingDup = documents.find(d => d.checksumSha256 && d.checksumSha256 === pre.meta?.checksum && d.type !== type);\r\n    if (existingDup) {\r\n      push('This file appears already uploaded under a different document type.', 'warning');\r\n      addOrReplaceDocument({ file: renamedFile, type, status: 'error', errorMessage: 'Duplicate of another document', checksumSha256: pre.meta?.checksum });\r\n      return;\r\n    }\r\n    const previewUrl = renamedFile.type.startsWith('image/') ? URL.createObjectURL(renamedFile) : undefined;\r\n    addOrReplaceDocument({ file: renamedFile, type, status: 'verifying', previewUrl, mimeType: pre.meta?.mimeType, sizeBytes: pre.meta?.sizeBytes, checksumSha256: pre.meta?.checksum, progress: 0 });\r\n    const start = Date.now();\r\n    const sizeFactor = Math.min(1.8, Math.max(1, (pre.meta!.sizeBytes / (1024 * 1024))));\r\n    const interval = window.setInterval(async () => {\r\n      const current = documentsRef.current.find(d => d.type === type);\r\n      if (!current) return;\r\n      const elapsed = Date.now() - start;\r\n      const pct = Math.min(95, Math.round((elapsed / (1200 * sizeFactor)) * 100));\r\n      addOrReplaceDocument({ ...current, progress: pct });\r\n      if (pct >= 95) {\r\n        clearInterval(interval);\r\n        activeIntervalsRef.current = activeIntervalsRef.current.filter(id => id !== interval);\r\n        \r\n        // Safely attempt OCR with error handling\r\n        let ocr = null;\r\n        try {\r\n          ocr = await attemptOcr(renamedFile);\r\n        } catch (ocrError) {\r\n          console.warn('OCR processing failed for file:', renamedFile.name, ocrError);\r\n        }\r\n        \r\n        let notes = 'Basic checks passed';\r\n        if (ocr?.detectedNrc && type === 'nrc-front') {\r\n          // Get NRC from customer data\r\n          const customerNrc = customer?.nrc;\r\n          \r\n          if (customerNrc && customerNrc.trim().length > 0) {\r\n            // Normalize both NRCs for comparison - remove slashes, spaces, hyphens\r\n            const normalizeNrc = (nrc: string) => nrc.replace(/[/\\s\\-]/g, '').toLowerCase().trim();\r\n            const detectedNormalized = normalizeNrc(ocr.detectedNrc);\r\n            const customerNormalized = normalizeNrc(String(customerNrc));\r\n            \r\n            const isMatch = detectedNormalized === customerNormalized;\r\n            notes += isMatch ? ' | NRC match confirmed' : ` | NRC mismatch (detected: ${ocr.detectedNrc}, expected: ${customerNrc})`;\r\n            \r\n            console.log('NRC Validation:', {\r\n              detected: ocr.detectedNrc,\r\n              detectedNormalized,\r\n              customer: customerNrc,\r\n              customerNormalized,\r\n              match: isMatch\r\n            });\r\n          } else {\r\n            console.log('NRC Validation: Customer NRC not available for comparison, detected:', ocr.detectedNrc);\r\n            notes += ` | NRC detected: ${ocr.detectedNrc} (no customer NRC to compare)`;\r\n          }\r\n        }\r\n        \r\n        const verifiedDoc = { \r\n          file: renamedFile, \r\n          type, \r\n          status: 'verified' as const, \r\n          previewUrl, \r\n          mimeType: pre.meta?.mimeType, \r\n          sizeBytes: pre.meta?.sizeBytes, \r\n          checksumSha256: pre.meta?.checksum, \r\n          extractedTextSnippet: ocr?.snippet, \r\n          verificationNotes: notes, \r\n          progress: 100 \r\n        };\r\n        \r\n        addOrReplaceDocument(verifiedDoc);\r\n        push('Document verified', 'success');\r\n        \r\n        // Upload to API after verification\r\n        setTimeout(() => uploadToAPI(verifiedDoc), 500);\r\n      }\r\n    }, 150);\r\n    activeIntervalsRef.current.push(interval);\r\n  }, [addOrReplaceDocument, documents, push, customer, uploadToAPI]);\r\n  \r\n  const checkAndMergePayslips = useCallback(async () => {\r\n    const payslip1 = documents.find(d => d.type === 'payslip-1' && d.status === 'verified');\r\n    const payslip2 = documents.find(d => d.type === 'payslip-2' && d.status === 'verified');\r\n    const payslip3 = documents.find(d => d.type === 'payslip-3' && d.status === 'verified');\r\n    \r\n    // Check if all payslips are verified and none are already merged\r\n    if (payslip1 && payslip2 && payslip3 && \r\n        payslip1.file && payslip2.file && payslip3.file &&\r\n        !documents.find(d => d.type === 'combined-payslips')) {\r\n      \r\n      try {\r\n        push('Merging payslips into single document...', 'info');\r\n        \r\n        const clientNRC = customer?.nrc || 'Unknown_NRC';\r\n        const mergedFile = await mergePayslips(payslip1.file, payslip2.file, payslip3.file, String(clientNRC));\r\n        \r\n        // Add the merged document\r\n        const mergedDoc = {\r\n          file: mergedFile,\r\n          type: 'combined-payslips' as UploadedDoc['type'],\r\n          status: 'verified' as const,\r\n          mimeType: 'application/pdf',\r\n          sizeBytes: mergedFile.size,\r\n          verificationNotes: 'Combined from 3 individual payslips',\r\n          progress: 100\r\n        };\r\n        \r\n        addOrReplaceDocument(mergedDoc);\r\n        \r\n        push('Payslips successfully merged into single document', 'success');\r\n        \r\n        // Upload merged document to API\r\n        setTimeout(() => uploadToAPI(mergedDoc), 500);\r\n      } catch (error) {\r\n        console.error('Failed to merge payslips:', error);\r\n        push('Failed to merge payslips - individual files preserved', 'error');\r\n      }\r\n    }\r\n  }, [documents, customer, addOrReplaceDocument, push, uploadToAPI]);\r\n  \r\n  // NRC merging function\r\n  const checkAndMergeNRC = useCallback(async () => {\r\n    const nrcFront = documents.find(d => d.type === 'nrc-front' && d.status === 'verified');\r\n    const nrcBack = documents.find(d => d.type === 'nrc-back' && d.status === 'verified');\r\n    \r\n    // Check if both NRC front and back are verified and not already merged\r\n    if (nrcFront && nrcBack && \r\n        nrcFront.file && nrcBack.file &&\r\n        !documents.find(d => d.type === 'combined-nrc')) {\r\n      \r\n      try {\r\n        push('Merging NRC front and back into single document...', 'info');\r\n        \r\n        const clientNRC = customer?.nrc || 'Unknown_NRC';\r\n        const mergedFile = await mergeNRCImages(nrcFront.file, nrcBack.file, String(clientNRC));\r\n        \r\n        // Add the merged document\r\n        const mergedDoc = {\r\n          file: mergedFile,\r\n          type: 'combined-nrc' as UploadedDoc['type'],\r\n          status: 'verified' as const,\r\n          mimeType: 'application/pdf',\r\n          sizeBytes: mergedFile.size,\r\n          verificationNotes: 'Combined NRC front and back',\r\n          progress: 100\r\n        };\r\n        \r\n        addOrReplaceDocument(mergedDoc);\r\n        \r\n        push('NRC documents successfully merged', 'success');\r\n        \r\n        // Upload merged document to API\r\n        setTimeout(() => uploadToAPI(mergedDoc), 500);\r\n      } catch (error) {\r\n        console.error('Failed to merge NRC documents:', error);\r\n        push('Failed to merge NRC documents - individual files preserved', 'error');\r\n      }\r\n    }\r\n  }, [documents, customer, addOrReplaceDocument, push, uploadToAPI]);\r\n  \r\n  // Check for payslip merge when documents change\r\n  useEffect(() => {\r\n    const payslipTypes = ['payslip-1', 'payslip-2', 'payslip-3'];\r\n    const verifiedPayslips = payslipTypes.filter(type => \r\n      documents.find(d => d.type === type && d.status === 'verified')\r\n    );\r\n    \r\n    // If all 3 payslips are verified and no merged document exists, trigger merge\r\n    if (verifiedPayslips.length === 3 && !documents.find(d => d.type === 'combined-payslips')) {\r\n      checkAndMergePayslips();\r\n    }\r\n  }, [documents, checkAndMergePayslips]);\r\n  \r\n  // Check for NRC merge when documents change\r\n  useEffect(() => {\r\n    const nrcFront = documents.find(d => d.type === 'nrc-front' && d.status === 'verified');\r\n    const nrcBack = documents.find(d => d.type === 'nrc-back' && d.status === 'verified');\r\n    \r\n    // If both NRC documents are verified and no merged document exists, trigger merge\r\n    if (nrcFront && nrcBack && !documents.find(d => d.type === 'combined-nrc')) {\r\n      checkAndMergeNRC();\r\n    }\r\n  }, [documents, checkAndMergeNRC]);\r\n  \r\n  const docsByType = useCallback((t: UploadedDoc['type']) => documents.find(d => d.type === t), [documents]);\r\n  const openPicker = (type: UploadedDoc['type']) => {\r\n    console.log('Debug: Opening file picker for type:', type);\r\n    const input = fileInputs.current[type];\r\n    console.log('Debug: File input element:', input);\r\n    if (input) {\r\n      input.click();\r\n      console.log('Debug: File picker clicked');\r\n    } else {\r\n      console.error('Debug: File input not found for type:', type);\r\n    }\r\n  };\r\n\r\n  (window as any).__documentsStepValidate = async () => {\r\n    const required: UploadedDoc['type'][] = ['nrc-front','payslip-1','payslip-2','payslip-3'];\r\n    const missing = required.filter(r => !docsByType(r));\r\n    if (missing.length) { push('Please upload all required documents: ' + missing.join(', '), 'error'); return false; }\r\n    \r\n    // Check if payslips are still verifying (informational only - don't block)\r\n    const payslipTypes = ['payslip-1','payslip-2','payslip-3'] as const;\r\n    const payslipsVerifying = payslipTypes.some(p => docsByType(p)?.status === 'verifying');\r\n    if (payslipsVerifying) { \r\n      push(' Payslips are being verified. You can proceed to Review - verification will continue in background.', 'info'); \r\n    }\r\n    \r\n    // Check for NRC mismatch (warning only - don't block)\r\n    const nrcDoc = docsByType('nrc-front');\r\n    const mism = nrcDoc?.verificationNotes?.includes('mismatch');\r\n    if (mism) push('Warning: NRC mismatch detected  please verify ID number.', 'warning');\r\n    \r\n    // Inform user about pending approval if applicable\r\n    if (!applicationNumberRef.current) {\r\n      push(' Documents saved. You can proceed to Review while waiting for loan approval.', 'info');\r\n    }\r\n    \r\n    return true;\r\n  };\r\n\r\n  // Retry uploading pending documents\r\n  const retryPendingUploads = useCallback(async () => {\r\n    if (!applicationNumberRef.current || pendingDocumentsRef.current.size === 0) {\r\n      push('No pending documents to retry', 'info');\r\n      return;\r\n    }\r\n\r\n    console.log(` Retrying ${pendingDocumentsRef.current.size} pending document(s)...`);\r\n    push(`Retrying ${pendingDocumentsRef.current.size} pending document(s)...`, 'info');\r\n\r\n    const pendingArray = Array.from(pendingDocumentsRef.current.entries());\r\n    \r\n    for (const [docType, { doc, typeCode }] of pendingArray) {\r\n      if (!doc.file) continue;\r\n      \r\n      try {\r\n        console.log(` Retrying upload for: ${docType}`);\r\n        addOrReplaceDocument({ ...doc, status: 'uploading', progress: 50 });\r\n        \r\n        const response = await uploadDocument(applicationNumberRef.current, typeCode, doc.file);\r\n        \r\n        // Success - remove from pending\r\n        pendingDocumentsRef.current.delete(docType);\r\n        \r\n        addOrReplaceDocument({ \r\n          ...doc, \r\n          id: response,\r\n          status: 'uploaded', \r\n          progress: 100 \r\n        });\r\n        \r\n        push(`${docType.replace('-', ' ')} uploaded successfully!`, 'success');\r\n      } catch (error: any) {\r\n        console.error(`Failed to retry ${docType}:`, error);\r\n        // Keep in pending queue for next retry\r\n        addOrReplaceDocument({ \r\n          ...doc, \r\n          status: 'uploaded', // Keep as \"uploaded\" (pending)\r\n          progress: 100 \r\n        });\r\n      }\r\n    }\r\n\r\n    if (pendingDocumentsRef.current.size === 0) {\r\n      push('All documents uploaded successfully!', 'success');\r\n      setPendingCount(0);\r\n    } else {\r\n      const remaining = pendingDocumentsRef.current.size;\r\n      setPendingCount(remaining);\r\n      push(`${remaining} document(s) still pending approval`, 'warning');\r\n    }\r\n  }, [uploadDocument, addOrReplaceDocument, push]);\r\n\r\n  // Derived progress & group metrics\r\n  const requiredArr: UploadedDoc['type'][] = ['nrc-front','payslip-1','payslip-2','payslip-3'];\r\n  const requiredVerified = requiredArr.filter(t => docsByType(t)?.status === 'verified').length;\r\n  const payslipDocs = useMemo(() => docTypes.filter(d => d.type.startsWith('payslip-')).map(cfg => ({ cfg, doc: docsByType(cfg.type) })), [docsByType]);\r\n  const payslipsVerified = payslipDocs.filter(p => p.doc?.status === 'verified').length;\r\n  const selfieDoc = docsByType('selfie');\r\n  const overallPct = useMemo(() => Math.round((requiredVerified / requiredArr.length) * 100), [requiredVerified, requiredArr.length]);\r\n  \r\n  // Track pending documents count (refresh when documents change)\r\n  const [pendingCount, setPendingCount] = React.useState(0);\r\n  React.useEffect(() => {\r\n    const count = pendingDocumentsRef.current.size;\r\n    setPendingCount(count);\r\n    console.log(` Pending documents count updated: ${count}`);\r\n  }, [documents]); // Re-check when documents array changes\r\n  \r\n  // Also update count after uploads complete\r\n  const updatePendingCount = useCallback(() => {\r\n    const count = pendingDocumentsRef.current.size;\r\n    setPendingCount(count);\r\n    console.log(` Pending documents count: ${count}`);\r\n  }, []);\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h6\" gutterBottom>Supporting Documents</Typography>\r\n      \r\n      {/* Pending Documents Warning Banner */}\r\n      {pendingCount > 0 && (\r\n        <Alert \r\n          severity=\"warning\" \r\n          sx={{ \r\n            mb: 2,\r\n            border: '2px solid',\r\n            borderColor: 'warning.main',\r\n            boxShadow: '0 4px 12px rgba(255, 152, 0, 0.2)'\r\n          }}\r\n          action={\r\n            <Button \r\n              color=\"inherit\" \r\n              size=\"small\" \r\n              onClick={retryPendingUploads}\r\n              sx={{ \r\n                whiteSpace: 'nowrap',\r\n                fontWeight: 700,\r\n                bgcolor: 'warning.dark',\r\n                color: 'white',\r\n                '&:hover': {\r\n                  bgcolor: 'warning.main'\r\n                }\r\n              }}\r\n            >\r\n               Retry Upload ({pendingCount})\r\n            </Button>\r\n          }\r\n        >\r\n          <Typography variant=\"body2\" sx={{ fontWeight: 700, fontSize: '1rem' }}>\r\n             {pendingCount} Document(s) Awaiting Backend Approval\r\n          </Typography>\r\n          <Typography variant=\"caption\" sx={{ display: 'block', mt: 0.5 }}>\r\n            <strong>Application Number: {applicationNumberRef.current}</strong>\r\n            <br />\r\n            Your loan application requires manual approval from the Altus system administrator before documents can be uploaded. \r\n            All documents are saved securely in your browser.\r\n            <br />\r\n            <strong>What happens next:</strong>\r\n            <ul style={{ margin: '8px 0', paddingLeft: '20px' }}>\r\n              <li>Administrator reviews your loan application ({applicationNumberRef.current})</li>\r\n              <li>Once approved, click \"Retry Upload\" to upload all pending documents</li>\r\n              <li>You can close this page and return later - your documents are saved locally</li>\r\n            </ul>\r\n            <em>Approval typically takes 5-15 minutes during business hours.</em>\r\n          </Typography>\r\n        </Alert>\r\n      )}\r\n      \r\n      {/* Loan Approval Status Alert */}\r\n      {applicationNumberRef.current && pendingCount === 0 && (\r\n        <Alert \r\n          severity=\"info\" \r\n          sx={{ mb: 2 }}\r\n        >\r\n          <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\r\n             Loan Application: {applicationNumberRef.current}\r\n          </Typography>\r\n          <Typography variant=\"caption\" sx={{ display: 'block', mt: 0.5 }}>\r\n            <strong>Status:</strong> Pending backend approval by Altus administrator.\r\n            <br />\r\n            Continue uploading documents - they will be stored locally and uploaded automatically after approval.\r\n          </Typography>\r\n        </Alert>\r\n      )}\r\n      \r\n      {/* Customer Notice */}\r\n      {!state.currentCustomer?.customerId && !customer?.customerId && (\r\n        <Alert severity=\"success\" sx={{ mb: 2 }}>\r\n          <Typography variant=\"body2\" sx={{ fontWeight: 600, mb: 0.5 }}>\r\n             Fast Track Mode Active\r\n          </Typography>\r\n          <Typography variant=\"caption\" sx={{ display: 'block' }}>\r\n            Skip creating a customer account - just fill the form in Step 1 and Step 2, then upload documents here. \r\n            Your loan application will be created automatically using your form data.\r\n          </Typography>\r\n        </Alert>\r\n      )}\r\n      \r\n      <Box sx={{ mb:2, p:2, border:'1px solid', borderColor:'divider', borderRadius:2, background: overallPct === 100 ? 'linear-gradient(90deg,#093B18,#2E7D32)' : 'linear-gradient(90deg,#132F52,#063970)', color:'#fff' }}>\r\n        <Stack direction={{ xs:'column', sm:'row' }} spacing={1.5} alignItems={{ xs:'flex-start', sm:'center' }}>\r\n          <Typography variant=\"subtitle2\" sx={{ fontWeight:600 }}>Required Docs: {requiredVerified}/{requiredArr.length} verified</Typography>\r\n          <Box sx={{ flex:1, width:'100%', maxWidth:260 }}>\r\n            <LinearProgress variant=\"determinate\" value={overallPct} sx={{ height:8, borderRadius:4, background:'rgba(255,255,255,0.2)', '& .MuiLinearProgress-bar':{ background:'#fff' } }} />\r\n          </Box>\r\n          <Typography variant=\"caption\" sx={{ opacity:0.9 }}>{overallPct}%</Typography>\r\n        </Stack>\r\n      </Box>\r\n      <Typography variant=\"body2\" sx={{ mb:2 }}>Upload the required documents. You can replace a file by selecting it again.</Typography>\r\n      <Stack spacing={3}>\r\n        {docTypes.filter(d => !d.type.startsWith('payslip-')).map(cfg => {\r\n          const existing = docsByType(cfg.type);\r\n            const isSelfie = cfg.type === 'selfie';\r\n            const mismatchWarning = cfg.type === 'nrc-front' && existing?.verificationNotes?.includes('mismatch');\r\n          return (\r\n            <Box key={cfg.type} sx={{ p:2, border:'1px dashed', borderColor: mismatchWarning ? 'error.light' : 'divider', borderRadius:2, position:'relative' }}>\r\n              {mismatchWarning && <Chip size=\"small\" color=\"error\" label=\"NRC Mismatch\" sx={{ position:'absolute', top:8, right:8 }} />}\r\n              <Stack direction=\"row\" alignItems=\"center\" spacing={2}>\r\n                <Box sx={{ flex:1 }}>\r\n                  <Typography variant=\"subtitle2\">{cfg.label}</Typography>\r\n                  {cfg.helper && <Typography variant=\"caption\" sx={{ display:'block', color:'text.secondary', mt:0.25 }}>{cfg.helper}</Typography>}\r\n                  {cfg.optional && !existing && <Typography variant=\"caption\" sx={{ color:'text.secondary' }}>Optional</Typography>}\r\n                  {existing ? (\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ mt:1, flexWrap:'wrap' }}>\r\n                      <Chip size=\"small\" color={existing.status === 'verified' ? 'success' : existing.status === 'error' ? 'error' : existing.status === 'verifying' ? 'warning' : 'default'} label={existing.file?.name || existing.checksumSha256?.slice(0,8) || 'Document'} />\r\n                      {existing.previewUrl && existing.file && (\r\n                        <img src={existing.previewUrl} alt={cfg.label + ' preview'} style={{ width: isSelfie ? 60 : 48, height: isSelfie ? 60 : 48, objectFit:'cover', borderRadius: isSelfie ? '50%' : 6, border: isSelfie ? '2px solid #1976d2' : '1px solid rgba(0,0,0,0.15)' }} />\r\n                      )}\r\n                      <StatusChip status={existing.status} />\r\n                      {existing.sizeBytes && <Tooltip title={`~${Math.round(existing.sizeBytes/1024)} KB`}><Chip size=\"small\" variant=\"outlined\" label={Math.round(existing.sizeBytes/1024)+' KB'} /></Tooltip>}\r\n                      {typeof existing.progress === 'number' && existing.status !== 'verified' && (\r\n                        <Box sx={{ width:140, ml:1 }}><LinearProgress variant=\"determinate\" value={existing.progress} sx={{ height:6, borderRadius:3 }} /></Box>\r\n                      )}\r\n                      {existing.verificationNotes && existing.status === 'verified' && cfg.type === 'nrc-front' && (\r\n                        <Tooltip title={existing.verificationNotes}><Chip size=\"small\" variant=\"outlined\" label={existing.verificationNotes.includes('mismatch') ? 'Mismatch' : 'Match'} color={existing.verificationNotes.includes('mismatch') ? 'error' : 'success'} /></Tooltip>\r\n                      )}\r\n                    </Stack>\r\n                  ) : <Typography variant=\"caption\" sx={{ color:'text.secondary' }}>No file selected</Typography>}\r\n                </Box>\r\n                <input type=\"file\" ref={el => fileInputs.current[cfg.type] = el} accept={cfg.accept} style={{ display:'none' }} onChange={(e) => onSelect(e, cfg.type)} />\r\n                <Button variant=\"outlined\" startIcon={<UploadFileIcon />} onClick={() => openPicker(cfg.type)}>{existing ? 'Replace' : 'Select'}</Button>\r\n                {existing && <IconButton color=\"error\" onClick={() => removeDocument(cfg.type)} aria-label={`Remove ${cfg.label}`}><DeleteIcon /></IconButton>}\r\n              </Stack>\r\n            </Box>\r\n          );\r\n        })}\r\n        <Box sx={{ p:2, border:'1px solid', borderColor:'divider', borderRadius:2 }}>\r\n          <Stack direction={{ xs:'column', sm:'row' }} alignItems={{ xs:'flex-start', sm:'center' }} spacing={2} sx={{ mb:1 }}>\r\n            <Typography variant=\"subtitle2\" sx={{ fontWeight:600 }}>Payslips (3)</Typography>\r\n            <Box sx={{ flex:1, width:'100%', maxWidth:240 }}><LinearProgress variant=\"determinate\" value={(payslipsVerified/3)*100} sx={{ height:6, borderRadius:3 }} /></Box>\r\n            <Typography variant=\"caption\" sx={{ color:'text.secondary' }}>{payslipsVerified}/3 verified</Typography>\r\n          </Stack>\r\n          <Divider sx={{ mb:1 }} />\r\n          <Stack spacing={2}>\r\n            {payslipDocs.map(({ cfg, doc }) => (\r\n              <Box key={cfg.type} sx={{ p:1.5, border:'1px dashed', borderColor:'divider', borderRadius:2 }}>\r\n                <Stack direction=\"row\" spacing={2} alignItems=\"center\">\r\n                  <Box sx={{ flex:1 }}>\r\n                    <Typography variant=\"body2\" sx={{ fontWeight:500 }}>{cfg.label}</Typography>\r\n                    {cfg.helper && <Typography variant=\"caption\" sx={{ color:'text.secondary' }}>{cfg.helper}</Typography>}\r\n                    {doc ? (\r\n                      <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ mt:0.75, flexWrap:'wrap' }}>\r\n                        <Chip size=\"small\" color={doc.status === 'verified' ? 'success' : doc.status === 'error' ? 'error' : doc.status === 'verifying' ? 'warning' : 'default'} label={doc.file?.name || doc.checksumSha256?.slice(0,8) || 'Payslip'} />\r\n                        {doc.previewUrl && doc.file && <img src={doc.previewUrl} alt={cfg.label + ' preview'} style={{ width:42, height:42, objectFit:'cover', borderRadius:4 }} />}\r\n                        <StatusChip status={doc.status} />\r\n                        {typeof doc.progress === 'number' && doc.status !== 'verified' && (<Box sx={{ width:120 }}><LinearProgress variant=\"determinate\" value={doc.progress} sx={{ height:5, borderRadius:3 }} /></Box>)}\r\n                      </Stack>\r\n                    ) : <Typography variant=\"caption\" sx={{ color:'text.secondary' }}>No file selected</Typography>}\r\n                  </Box>\r\n                  <input type=\"file\" ref={el => fileInputs.current[cfg.type] = el} accept={cfg.accept} style={{ display:'none' }} onChange={(e) => onSelect(e, cfg.type)} />\r\n                  <Button size=\"small\" variant=\"outlined\" startIcon={<UploadFileIcon />} onClick={() => openPicker(cfg.type)}>{doc ? 'Replace' : 'Select'}</Button>\r\n                  {doc && <IconButton size=\"small\" color=\"error\" onClick={() => removeDocument(cfg.type)} aria-label={`Remove ${cfg.label}`}><DeleteIcon fontSize=\"small\" /></IconButton>}\r\n                </Stack>\r\n              </Box>\r\n            ))}\r\n          </Stack>\r\n        </Box>\r\n        \r\n        {/* Combined NRC Display */}\r\n        {documents.find(d => d.type === 'combined-nrc') && (\r\n          <Box sx={{ p:2, border:'2px solid', borderColor:'primary.light', borderRadius:2, background:'linear-gradient(90deg,#0d47a1,#1976d2)', color:'#fff', mb:2 }}>\r\n            <Typography variant=\"subtitle2\" sx={{ fontWeight:600, mb:1 }}> Combined NRC Document</Typography>\r\n            {(() => {\r\n              const combinedDoc = documents.find(d => d.type === 'combined-nrc');\r\n              return combinedDoc ? (\r\n                <Stack direction=\"row\" spacing={2} alignItems=\"center\">\r\n                  <Box sx={{ flex:1 }}>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ flexWrap:'wrap' }}>\r\n                      <Chip \r\n                        size=\"small\" \r\n                        color=\"primary\" \r\n                        label={combinedDoc.file?.name || 'NRC_Combined.pdf'} \r\n                        sx={{ background:'rgba(255,255,255,0.9)', color:'#0d47a1' }}\r\n                      />\r\n                      <Chip \r\n                        size=\"small\" \r\n                        variant=\"outlined\" \r\n                        label=\"MERGED\" \r\n                        sx={{ borderColor:'rgba(255,255,255,0.5)', color:'#fff' }}\r\n                      />\r\n                      {combinedDoc.sizeBytes && (\r\n                        <Chip \r\n                          size=\"small\" \r\n                          variant=\"outlined\" \r\n                          label={`${Math.round(combinedDoc.sizeBytes/1024)} KB`}\r\n                          sx={{ borderColor:'rgba(255,255,255,0.5)', color:'#fff' }}\r\n                        />\r\n                      )}\r\n                    </Stack>\r\n                    <Typography variant=\"caption\" sx={{ display:'block', mt:0.5, opacity:0.9 }}>\r\n                      NRC front and back have been automatically combined into a single PDF document\r\n                    </Typography>\r\n                  </Box>\r\n                  <IconButton \r\n                    size=\"small\" \r\n                    sx={{ color:'#fff' }} \r\n                    onClick={() => removeDocument('combined-nrc')} \r\n                    aria-label=\"Remove combined NRC\"\r\n                  >\r\n                    <DeleteIcon fontSize=\"small\" />\r\n                  </IconButton>\r\n                </Stack>\r\n              ) : null;\r\n            })()}\r\n          </Box>\r\n        )}\r\n        \r\n        {/* Combined Payslips Display */}\r\n        {documents.find(d => d.type === 'combined-payslips') && (\r\n          <Box sx={{ p:2, border:'2px solid', borderColor:'success.light', borderRadius:2, background:'linear-gradient(90deg,#1b5e20,#2e7d32)', color:'#fff' }}>\r\n            <Typography variant=\"subtitle2\" sx={{ fontWeight:600, mb:1 }}> Combined Payslips Document</Typography>\r\n            {(() => {\r\n              const combinedDoc = documents.find(d => d.type === 'combined-payslips');\r\n              return combinedDoc ? (\r\n                <Stack direction=\"row\" spacing={2} alignItems=\"center\">\r\n                  <Box sx={{ flex:1 }}>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ flexWrap:'wrap' }}>\r\n                      <Chip \r\n                        size=\"small\" \r\n                        color=\"success\" \r\n                        label={combinedDoc.file?.name || 'Combined_Payslips.pdf'} \r\n                        sx={{ background:'rgba(255,255,255,0.9)', color:'#1b5e20' }}\r\n                      />\r\n                      <Chip \r\n                        size=\"small\" \r\n                        variant=\"outlined\" \r\n                        label=\"MERGED\" \r\n                        sx={{ borderColor:'rgba(255,255,255,0.5)', color:'#fff' }}\r\n                      />\r\n                      {combinedDoc.sizeBytes && (\r\n                        <Chip \r\n                          size=\"small\" \r\n                          variant=\"outlined\" \r\n                          label={`${Math.round(combinedDoc.sizeBytes/1024)} KB`}\r\n                          sx={{ borderColor:'rgba(255,255,255,0.5)', color:'#fff' }}\r\n                        />\r\n                      )}\r\n                    </Stack>\r\n                    <Typography variant=\"caption\" sx={{ display:'block', mt:0.5, opacity:0.9 }}>\r\n                      All three payslips have been automatically combined into a single PDF document\r\n                    </Typography>\r\n                  </Box>\r\n                  <IconButton \r\n                    size=\"small\" \r\n                    sx={{ color:'#fff' }} \r\n                    onClick={() => removeDocument('combined-payslips')} \r\n                    aria-label=\"Remove combined payslips\"\r\n                  >\r\n                    <DeleteIcon fontSize=\"small\" />\r\n                  </IconButton>\r\n                </Stack>\r\n              ) : null;\r\n            })()}\r\n          </Box>\r\n        )}\r\n      </Stack>\r\n      <Typography variant=\"caption\" sx={{ mt:3, display:'block', color:'text.secondary' }}>Files are stored locally until you submit. Verification here is preliminary.{selfieDoc ? '' : ' (Adding a selfie can speed up identity confirmation.)'}</Typography>\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst StatusChip: React.FC<{ status?: UploadedDoc['status'] }> = ({ status }) => {\r\n  if (!status) return null;\r\n  const map: Record<string, { color: 'default' | 'success' | 'warning' | 'error'; label: string; }> = {\r\n    pending: { color: 'default', label: 'PENDING' },\r\n    uploading: { color: 'warning', label: 'UPLOADING' },\r\n    uploaded: { color: 'default', label: 'UPLOADED' },\r\n    verifying: { color: 'warning', label: 'VERIFYING' },\r\n    verified: { color: 'success', label: 'VERIFIED' },\r\n    error: { color: 'error', label: 'ERROR' }\r\n  };\r\n  const meta = map[status];\r\n  return <Chip size=\"small\" variant=\"outlined\" color={meta.color} label={meta.label} />;\r\n};\r\n\r\nexport default DocumentsStep;\r\n","// Utility for merging NRC front and back images into a single PDF\r\nimport { jsPDF } from 'jspdf';\r\n\r\nexport const mergeNRCImages = async (nrcFront: File, nrcBack: File, clientNRC: string): Promise<File> => {\r\n  const pdf = new jsPDF();\r\n  let pageAdded = false;\r\n\r\n  const addImageToPDF = async (file: File, pageLabel: string) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      \r\n      reader.onload = async (e) => {\r\n        try {\r\n          const result = e.target?.result;\r\n          \r\n          if (file.type.startsWith('image/')) {\r\n            // For image files, add them directly to the PDF with compression\r\n            if (pageAdded) pdf.addPage();\r\n            \r\n            const img = new Image();\r\n            img.onload = () => {\r\n              try {\r\n                const canvas = document.createElement('canvas');\r\n                const ctx = canvas.getContext('2d');\r\n                if (!ctx) throw new Error('Canvas context not available');\r\n                \r\n                // Calculate dimensions to fit page\r\n                const pageWidth = 190; // A4 width minus margins\r\n                const pageHeight = 270; // A4 height minus margins\r\n                const imgRatio = img.width / img.height;\r\n                const pageRatio = pageWidth / pageHeight;\r\n                \r\n                let pdfWidth, pdfHeight;\r\n                if (imgRatio > pageRatio) {\r\n                  pdfWidth = pageWidth;\r\n                  pdfHeight = pageWidth / imgRatio;\r\n                } else {\r\n                  pdfHeight = pageHeight;\r\n                  pdfWidth = pageHeight * imgRatio;\r\n                }\r\n                \r\n                // Optimize canvas size - use max 1200px width for compression\r\n                const maxWidth = 1200;\r\n                const maxHeight = 1200;\r\n                let canvasWidth = img.width;\r\n                let canvasHeight = img.height;\r\n                \r\n                if (canvasWidth > maxWidth || canvasHeight > maxHeight) {\r\n                  const scale = Math.min(maxWidth / canvasWidth, maxHeight / canvasHeight);\r\n                  canvasWidth = Math.floor(canvasWidth * scale);\r\n                  canvasHeight = Math.floor(canvasHeight * scale);\r\n                }\r\n                \r\n                // Set canvas to optimized size\r\n                canvas.width = canvasWidth;\r\n                canvas.height = canvasHeight;\r\n                \r\n                // Draw scaled image\r\n                ctx.drawImage(img, 0, 0, canvasWidth, canvasHeight);\r\n                \r\n                // Convert to JPEG with compression (0.7 quality = good balance)\r\n                const imgData = canvas.toDataURL('image/jpeg', 0.7);\r\n                pdf.addImage(imgData, 'JPEG', 10, 10, pdfWidth, pdfHeight);\r\n                \r\n                // Add label\r\n                pdf.setFontSize(10);\r\n                pdf.setTextColor(100);\r\n                pdf.text(`${pageLabel}`, 10, pdfHeight + 20);\r\n                \r\n                pageAdded = true;\r\n                resolve();\r\n              } catch (err) {\r\n                reject(err);\r\n              }\r\n            };\r\n            \r\n            img.onerror = () => reject(new Error(`Failed to load image: ${file.name}`));\r\n            \r\n            if (typeof result === 'string') {\r\n              img.src = result;\r\n            } else {\r\n              reject(new Error('Invalid file data'));\r\n            }\r\n          } else if (file.type === 'application/pdf') {\r\n            // For PDF files, add a placeholder page\r\n            if (pageAdded) pdf.addPage();\r\n            pdf.setFontSize(16);\r\n            pdf.text(pageLabel, 20, 30);\r\n            pdf.setFontSize(10);\r\n            pdf.text(`Original file: ${file.name}`, 20, 50);\r\n            pdf.text(`File size: ${Math.round(file.size / 1024)} KB`, 20, 60);\r\n            pdf.text(`Note: PDF content preserved in original file`, 20, 70);\r\n            pageAdded = true;\r\n            resolve();\r\n          } else {\r\n            reject(new Error(`Unsupported file type: ${file.type}`));\r\n          }\r\n        } catch (err) {\r\n          reject(err);\r\n        }\r\n      };\r\n      \r\n      reader.onerror = () => reject(new Error('Failed to read file'));\r\n      reader.readAsDataURL(file);\r\n    });\r\n  };\r\n\r\n  try {\r\n    // Add NRC Front\r\n    await addImageToPDF(nrcFront, 'NRC Front');\r\n    \r\n    // Add NRC Back\r\n    await addImageToPDF(nrcBack, 'NRC Back');\r\n    \r\n    // Generate PDF blob\r\n    const pdfBlob = pdf.output('blob');\r\n    \r\n    // Create File object with descriptive name\r\n    const timestamp = Date.now();\r\n    const fileName = `NRC_Combined_${clientNRC}_${timestamp}.pdf`;\r\n    \r\n    return new File([pdfBlob], fileName, { type: 'application/pdf' });\r\n  } catch (error) {\r\n    console.error('Error merging NRC images:', error);\r\n    throw error;\r\n  }\r\n};\r\n"],"names":["getLinearProgressUtilityClass","slot","generateUtilityClass","generateUtilityClasses","_excluded","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","indeterminate1Keyframe","keyframes","_taggedTemplateLiteral","indeterminate1Animation","css","indeterminate2Keyframe","indeterminate2Animation","bufferKeyframe","bufferAnimation","getColorShade","theme","color","vars","palette","LinearProgress","concat","mode","lighten","main","darken","LinearProgressRoot","styled","name","overridesResolver","props","styles","ownerState","root","capitalize","variant","memoTheme","_ref","position","overflow","display","height","zIndex","colorAdjust","variants","Object","entries","filter","createSimplePaletteValueFilter","map","_ref2","style","backgroundColor","_ref3","content","left","top","right","bottom","opacity","transform","LinearProgressDashed","dashed","_ref4","marginTop","width","backgroundSize","backgroundPosition","backgroundImage","_ref5","animation","LinearProgressBar1","bar","bar1","bar1Indeterminate","bar1Determinate","bar1Buffer","_ref6","transition","transformOrigin","_ref7","_ref8","_ref9","LinearProgressBar2","bar2","bar2Indeterminate","bar2Buffer","_ref0","_ref1","_ref10","_ref11","_ref12","_ref13","_ref14","React","inProps","ref","useDefaultProps","className","value","valueBuffer","other","_objectWithoutProperties","_objectSpread","classes","slots","composeClasses","useUtilityClasses","isRtl","useRtl","rootProps","inlineStyles","undefined","Math","round","process","_jsxs","clsx","role","children","_jsx","createSvgIcon","d","useUATWorkflow","_state$currentCustome2","customer","loan","setCustomer","setLoan","useWizardData","state","useAltus","submitLoanApplication","useCallback","async","_state$currentCustome","_customer$reference","_customer$reference2","_customer$reference3","_customer$reference4","_customer$reference5","_customer$nextOfKin6","_customer$nextOfKin7","_customer$nextOfKin8","_customer$nextOfKin9","_customer$nextOfKin0","_customer$nextOfKin1","_loanResult$outParams","console","log","customerId","currentCustomer","_customer$nextOfKin","_customer$nextOfKin2","_customer$nextOfKin3","_customer$nextOfKin4","_customer$nextOfKin5","customerRequest","firstName","lastName","nrc","nrcIssueDate","phoneNumber","phone","emailAddress","email","dateOfBirth","title","gender","nationality","otherNationality","maritalStatus","address","street","city","province","postalCode","country","preferredBranch","employment","employerId","employerName","employerCode","payrollNumber","occupation","salary","employmentDate","employmentType","nextOfKin","relationship","bankDetails","bankName","accountNumber","accountType","branchCode","bankBranch","_createdCustomer$outP","createdCustomer","altusApi","outParams","CustomerID","Error","apiCustomerData","error","amount","loanRequestData","TypeOfCustomer","CustomerId","identityNo","contactNo","emailId","primaryAddress","provinceName","districtName","countryName","postalcode","employeeNumber","designation","tenure","tenureMonths","loanAmount","grossIncome","netIncome","deductions","financialInstitutionName","financialInstitutionBranchName","referrerName","reference","referrerNRC","referrerContactNo","referrerPhysicalAddress","referrerRelationType","kinName","trim","kinNRC","kinRelationship","kinMobileNo","kinAddress","kinProvinceName","kinDistrictName","kinCountryName","hasPersonalDetails","hasAddressDetails","hasBankDetails","hasNextOfKin","hasReference","loanResult","executionStatus","executionMessage","ApplicationNumber","applicationNumber","uploadDocument","documentType","file","_result$outParams","fileName","result","LRDocumentDetailsId","isCustomerReady","ALLOWED_MIME","preValidateFile","includes","type","ok","size","checksum","buf","arrayBuffer","digest","crypto","subtle","Array","from","Uint8Array","b","toString","padStart","join","computeSha256","meta","mimeType","sizeBytes","NRC_REGEX","docTypes","label","accept","helper","optional","DocumentsStep","documents","addOrReplaceDocument","removeDocument","push","useSnackbar","fileInputs","useRef","documentsRef","activeIntervalsRef","applicationNumberRef","pendingDocumentsRef","Map","useEffect","current","forEach","id","clearInterval","uploadToAPI","doc","status","progress","documentTypeCode","loanError","errorMessage","message","response","delete","replace","uploadError","_uploadError$message","_uploadError$details","_uploadError$details$","details","reader","FileReader","onloadend","base64","set","typeCode","newCount","setPendingCount","readAsDataURL","Date","now","onSelect","e","_e$target$files","_pre$meta3","_pre$meta4","_pre$meta5","target","files","clientNRC","sanitizedNRC","String","documentName","docType","docConfig","find","getDocumentDisplayName","fileExtension","filename","lastDot","lastIndexOf","substring","getFileExtension","newFileName","renamedFile","File","pre","_pre$meta2","_pre$meta","checksumSha256","previewUrl","startsWith","URL","createObjectURL","start","sizeFactor","min","max","interval","window","setInterval","elapsed","pct","_ocr","_pre$meta6","_pre$meta7","_pre$meta8","_ocr2","ocr","warn","worker","createWorker","url","img","Image","Promise","resolve","reject","onload","onerror","src","revokeObjectURL","data","race","recognize","_","setTimeout","fullText","text","snippet","slice","match","detectedNrc","terminate","terminateError","attemptOcr","ocrError","notes","customerNrc","length","normalizeNrc","toLowerCase","detectedNormalized","customerNormalized","isMatch","detected","verifiedDoc","extractedTextSnippet","verificationNotes","checkAndMergePayslips","payslip1","payslip2","payslip3","mergedFile","pdf","jsPDF","pageAdded","addFileToPDF","pageNumber","_e$target","addPage","setFontSize","canvas","document","createElement","ctx","getContext","pageWidth","pageHeight","imgRatio","pdfWidth","pdfHeight","maxWidth","maxHeight","canvasWidth","canvasHeight","scale","floor","drawImage","dataUrl","toDataURL","addImage","readAsArrayBuffer","toLocaleString","pdfBlob","output","mergePayslips","mergedDoc","checkAndMergeNRC","nrcFront","nrcBack","addImageToPDF","pageLabel","imgData","setTextColor","err","timestamp","mergeNRCImages","docsByType","t","openPicker","input","click","__documentsStepValidate","_nrcDoc$verificationN","missing","r","some","p","_docsByType","nrcDoc","retryPendingUploads","pendingArray","remaining","requiredArr","requiredVerified","_docsByType2","payslipDocs","useMemo","cfg","payslipsVerified","_p$doc","selfieDoc","overallPct","pendingCount","count","Box","Typography","gutterBottom","Alert","severity","sx","mb","border","borderColor","boxShadow","action","Button","onClick","whiteSpace","fontWeight","bgcolor","fontSize","mt","margin","paddingLeft","borderRadius","background","Stack","direction","xs","sm","spacing","alignItems","flex","_existing$verificatio","_existing$file","_existing$checksumSha","existing","isSelfie","mismatchWarning","Chip","flexWrap","alt","objectFit","StatusChip","Tooltip","ml","el","onChange","startIcon","UploadFileIcon","IconButton","DeleteIcon","Divider","_doc$file","_doc$checksumSha","_combinedDoc$file","combinedDoc","_combinedDoc$file2","pending","uploading","uploaded","verifying","verified"],"sourceRoot":""}